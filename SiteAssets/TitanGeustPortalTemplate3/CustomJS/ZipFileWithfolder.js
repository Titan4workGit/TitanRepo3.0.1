var a0_0x2f5312=a0_0x35b3;(function(_0x15756d,_0x2b202a){var _0x1e1958=a0_0x35b3,_0x418bfb=_0x15756d();while(!![]){try{var _0xdc4961=parseInt(_0x1e1958(0x17e))/0x1+-parseInt(_0x1e1958(0x170))/0x2+-parseInt(_0x1e1958(0x165))/0x3+parseInt(_0x1e1958(0x161))/0x4+parseInt(_0x1e1958(0x15a))/0x5*(-parseInt(_0x1e1958(0x178))/0x6)+-parseInt(_0x1e1958(0x16b))/0x7*(parseInt(_0x1e1958(0x186))/0x8)+parseInt(_0x1e1958(0x159))/0x9*(parseInt(_0x1e1958(0x141))/0xa);if(_0xdc4961===_0x2b202a)break;else _0x418bfb['push'](_0x418bfb['shift']());}catch(_0x1c8f58){_0x418bfb['push'](_0x418bfb['shift']());}}}(a0_0x1cc6,0xddd3b));const selectedFolders=[];var zip,listName=a0_0x2f5312(0x13a);const myTimeout='';var IsleftRestritcfile=![];async function downloadSelectedFilesAsZip(_0x503c36){var _0x2c316a=a0_0x2f5312;$[_0x2c316a(0x14c)]('https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js',function(){var _0x384b62=_0x2c316a;_0x503c36[0x0][_0x384b62(0x163)]==undefined?listName=_0x503c36[0x0][_0x384b62(0x185)]:listName=_0x503c36[0x0][_0x384b62(0x163)];var _0x1f6c21=[],_0x45538a=_0x503c36[_0x384b62(0x131)](function(_0xc96f1b){var _0x33d0d5=_0x384b62;_0xc96f1b[_0x33d0d5(0x134)]!=_0x33d0d5(0x135)?_0xc96f1b[_0x33d0d5(0x167)]==undefined?$[_0x33d0d5(0x166)](getFolderFilesAndSubFolders(_0xc96f1b['ServerURL'],_0x1f6c21))['done'](function(_0x119738){return _0x45538a=_0x119738;}):$[_0x33d0d5(0x166)](getFolderFilesAndSubFolders(_0xc96f1b[_0x33d0d5(0x167)],_0x1f6c21))['done'](function(_0xe504cc){return _0x45538a=_0xe504cc;}):(Ismessage=!![],messagetext=_0x33d0d5(0x133));}),_0x50a70b='';_0x1f6c21['length']>0x0?Promise[_0x384b62(0x153)](_0x45538a)[_0x384b62(0x13e)](function(){var _0x15f8b0=_0x384b62;zip=new JSZip();var _0x3f53ce=_0x1f6c21[_0x15f8b0(0x131)](function(_0x5920b0){var _0x3f120f=_0x15f8b0,_0x352219=_spPageContextInfo[_0x3f120f(0x14d)]+_0x5920b0;return fetch(_0x352219)[_0x3f120f(0x13e)](function(_0x3f9e15){var _0x26fb8d=_0x3f120f;if(!_0x3f9e15['ok'])throw new Error(_0x26fb8d(0x182));return _0x3f9e15[_0x26fb8d(0x169)]();})['then'](function(_0x53f243){var _0x3abf6a=_0x3f120f,_0xe9c8b3=_0x5920b0[_0x3abf6a(0x12e)](_0x5920b0['indexOf'](listName)+listName[_0x3abf6a(0x17d)]+0x1);zip[_0x3abf6a(0x154)](_0xe9c8b3,_0x53f243);})[_0x3f120f(0x180)](_0x47b909=>{var _0x5a026c=_0x3f120f;console[_0x5a026c(0x173)]('There\x20was\x20a\x20problem\x20with\x20the\x20fetch\x20operation:',_0x47b909);});});Promise['all'](_0x3f53ce)['then'](function(){dowloadZip();});}):(alert('No\x20Files\x20in\x20zip\x20download'),IsleftRestritcfile=![],waitingDialog[_0x384b62(0x17a)]());});}function dowloadZip(){var _0x41abb9=a0_0x2f5312;zip[_0x41abb9(0x146)]({'type':_0x41abb9(0x169)})[_0x41abb9(0x13e)](function(_0x1f7d54){var _0x49dc10=_0x41abb9,_0x136bd1=document[_0x49dc10(0x16a)]('a');_0x136bd1[_0x49dc10(0x171)]=URL[_0x49dc10(0x14e)](_0x1f7d54),_0x136bd1[_0x49dc10(0x14a)]=_0x49dc10(0x13c)+new Date()[_0x49dc10(0x13d)]()['slice'](0x0,0x14)+_0x49dc10(0x164),_0x136bd1[_0x49dc10(0x14f)](),waitingDialog[_0x49dc10(0x17a)](),IsleftRestritcfile&&(alert(_0x49dc10(0x157)),IsleftRestritcfile=![]),$(_0x49dc10(0x15d))[_0x49dc10(0x156)](_0x49dc10(0x130),![]),$(_0x49dc10(0x17c))[_0x49dc10(0x156)](_0x49dc10(0x130),![]),arrFileFolder=[];});}function getFilesFromLibrary(_0x102c88){var _0x151592=a0_0x2f5312,_0xf22386=_0x102c88+_0x151592(0x17f);$[_0x151592(0x139)]({'url':_0xf22386,'type':_0x151592(0x187),'headers':{'Accept':_0x151592(0x16f)},'beforeSend':function(){var _0xf76e76=_0x151592;$('#overlaysearch')[_0xf76e76(0x176)]();},'success':function(_0x255720){var _0x5f43a0=_0x151592,_0x28f569=_0x255720['d']['results'],_0x3e701a=[];_0x28f569[_0x5f43a0(0x172)](function(_0x1c2814){var _0x31f879=_0x5f43a0,_0x5abe34=_0x1c2814[_0x31f879(0x15e)][_0x31f879(0x12e)](_0x1c2814[_0x31f879(0x15e)][_0x31f879(0x132)]('/')+0x1),_0x5a2e89={'name':_0x5abe34,'url':_0x1c2814[_0x31f879(0x15e)],'checkbox':_0x31f879(0x152)+_0x1c2814['FileRef']+'\x27>'};_0x3e701a[_0x31f879(0x179)](_0x5a2e89);});var _0x620301='<table>';_0x620301+=_0x5f43a0(0x12d),_0x3e701a[_0x5f43a0(0x172)](function(_0x184199){var _0x108a72=_0x5f43a0;_0x620301+=_0x108a72(0x16c)+_0x184199[_0x108a72(0x175)]+'</td><td>'+_0x184199[_0x108a72(0x138)]+_0x108a72(0x13b);}),_0x620301+=_0x5f43a0(0x150),$(_0x5f43a0(0x144))[_0x5f43a0(0x145)](_0x620301);},'error':function(_0x3e1697){var _0x4e8c01=_0x151592;console[_0x4e8c01(0x181)](_0x3e1697);}});}function a0_0x35b3(_0xbe8d65,_0x95abbc){var _0x1cc6f0=a0_0x1cc6();return a0_0x35b3=function(_0x35b38b,_0x3a56e5){_0x35b38b=_0x35b38b-0x12b;var _0x126e4c=_0x1cc6f0[_0x35b38b];return _0x126e4c;},a0_0x35b3(_0xbe8d65,_0x95abbc);}function a0_0x1cc6(){var _0xeffdaa=['promise','7090092vLncGc','ServerRelativeUrl','SelectedLibrary','.zip','2556273shMHdf','when','fileserverrelativeurl','has','blob','createElement','1659gVbrpA','<tr><td>','\x27)?$expand=Folders,Files,\x20ListItemAllFields/EffectiveBasePermissions,\x20Files/ListItemAllFields/EffectiveBasePermissions','results','application/json;odata=verbose','1029934ejOfwf','href','forEach','error','resolve','checkbox','fadeIn','BasePermissions','548874WwqbON','push','hide','/_api/web/lists/getbytitle(\x27','.chkShareToMe','length','22207IyySgd','/_api/web/lists/getByTitle(\x27DemoLibrary\x27)/items?$select=FileRef&$orderby=FileLeafRef&$filter=FSObjType\x20eq\x201','catch','log','Network\x20response\x20was\x20not\x20ok','stringify','skiptoken=','LibraryName','60824cjcbjk','GET','apply','concat','<tr><th>Select</th><th>Name</th></tr>','substring','initPropertiesFromJson','checked','map','lastIndexOf','\x20Files/folders\x20with\x20restricted\x20view\x20permission\x20can\x27t\x20be\x20downloaded.','IsBlock','Yes','&$skiptoken=','ListItemAllFields','name','ajax','DemoLibrary','</td></tr>','files_','toJSON','then','webAbsoluteUrl','fail','680Rsmkez','reject','\x27)/items?$top=5000','#fileList','html','generateAsync','application/json;\x20odata=verbose','EffectiveBasePermissions','done','download','Deferred','getScript','portalUrl','createObjectURL','click','</table>','indexOf','<input\x20type=\x27checkbox\x27\x20name=\x27files\x27\x20value=\x27','all','file','PermissionKind','prop','Restricted\x20file(s)\x20are\x20skipped\x20to\x20download','&$filter=FileDirRef\x20eq\x20\x27','423216jOoKKc','50prBuMt','__next','\x27)/GetFolderByServerRelativeUrl(\x27','.chkFileFolder','FileRef','/_api/web/GetFolderByServerRelativePath(\x27'];a0_0x1cc6=function(){return _0xeffdaa;};return a0_0x1cc6();}function getFolderFilesAndSubFolders(_0x582e04,_0x15f666){var _0x1e0674=a0_0x2f5312,_0x427506=SiteUrl+'/_api/web/GetFolderByServerRelativeUrl(\x27'+_0x582e04+_0x1e0674(0x16d);return jQuery[_0x1e0674(0x139)]({'url':_0x427506,'type':_0x1e0674(0x187),'async':![],'headers':{'accept':_0x1e0674(0x16f)},'beforeSend':function(){},'success':function(_0x5b2559){var _0x862384=_0x1e0674,_0x8f885=parseBasePermissionss(_0x5b2559['d'][_0x862384(0x137)][_0x862384(0x148)]);if(_0x8f885!=![]){var _0x1570f9=_0x5b2559['d']['Files'][_0x862384(0x16e)];_0x1570f9[_0x862384(0x172)](function(_0x5e9635){var _0x42b5a2=_0x862384;parseBasePermissionss(_0x5e9635[_0x42b5a2(0x137)][_0x42b5a2(0x148)])!=![]?_0x15f666[_0x42b5a2(0x179)](_0x5e9635[_0x42b5a2(0x162)]):IsleftRestritcfile=!![];});var _0x5d32f1=_0x5b2559['d']['Folders'][_0x862384(0x16e)],_0xacc5ac=_0x5d32f1[_0x862384(0x131)](function(_0x4fb472){var _0x432791=_0x862384;getFolderFilesAndSubFolders(_0x4fb472[_0x432791(0x162)],_0x15f666);});}else IsleftRestritcfile=!![];},'error':function(_0x2c0f56){var _0x3d2a38=_0x1e0674;console[_0x3d2a38(0x181)](_0x2c0f56);}}),_0x15f666;}function parseBasePermissionss(_0x472252){var _0x1899b0=a0_0x2f5312,_0x250b18=new SP[(_0x1899b0(0x177))]();return _0x250b18[_0x1899b0(0x12f)](_0x472252),_0x250b18[_0x1899b0(0x168)](SP[_0x1899b0(0x155)]['openItems']);}var Isnotpermission=![];function checkFilePermission(_0x904578){var _0x327f82=a0_0x2f5312;Isnotpermission=![];var _0x111145=SiteUrl+_0x327f82(0x15f)+_0x904578+'\x27)?$select=ID,EncodedAbsUrl,File_x0020_Type&$expand=Folders,Folders/ListItemAllFields/HasUniqueRoleAssignments,Files/ModifiedBy/Title,Files/ListItemAllFields/HasUniqueRoleAssignments,Folders/ListItemAllFields,Files,Files/ListItemAllFields,Files/ListItemAllFields/FileSizeDisplay&$orderby=Modified\x20desc';return $[_0x327f82(0x139)]({'url':_0x111145,'type':'GET','async':![],'headers':{'accept':_0x327f82(0x16f)},'success':function(_0x291ab4){debugger;},'error':function(_0x90f35f){var _0xee2837=_0x327f82;console['log']('Error\x20checking\x20file\x20permissions:\x20'+JSON[_0xee2837(0x183)](_0x90f35f));}}),Isnotpermission;}function retrieveAllItemsFromFolder(_0x19687f,_0x478ed6){var _0x5f0f33=a0_0x2f5312,_0x2d2a09=$[_0x5f0f33(0x14b)](),_0x4a2251=[];_0x290646(_0x19687f,_0x478ed6,null,_0x4a2251);function _0x290646(_0x718f22,_0x48f75e,_0x4ba37f,_0x2e6ab3){var _0x209cf8=_0x5f0f33,_0x544ff0=_spPageContextInfo[_0x209cf8(0x13f)]+_0x209cf8(0x17b)+_0x718f22+_0x209cf8(0x143);_0x48f75e&&(_0x544ff0+=_0x209cf8(0x158)+_0x48f75e+'\x27'),_0x4ba37f&&(_0x544ff0+=_0x209cf8(0x136)+encodeURIComponent(_0x4ba37f)),$['ajax']({'url':_0x544ff0,'method':'GET','headers':{'Accept':_0x209cf8(0x147)},'success':function(_0x233deb){var _0x3b0d1d=_0x209cf8;_0x2e6ab3=_0x2e6ab3[_0x3b0d1d(0x12c)](_0x233deb['d']['results']);if(_0x233deb['d'][_0x3b0d1d(0x15b)]){var _0x406cf8=_0x233deb['d'][_0x3b0d1d(0x15b)],_0x5d1023=_0x406cf8[_0x3b0d1d(0x12e)](_0x406cf8[_0x3b0d1d(0x151)](_0x3b0d1d(0x184))+0xa);_0x290646(_0x718f22,_0x48f75e,_0x5d1023,_0x2e6ab3);}else _0x252e84(_0x718f22,_0x48f75e,_0x2e6ab3)[_0x3b0d1d(0x13e)](function(_0x5b12c4){_0x2d2a09['resolve'](_0x5b12c4);})[_0x3b0d1d(0x140)](function(_0x442ba3){var _0x90dcfb=_0x3b0d1d;_0x2d2a09[_0x90dcfb(0x142)](_0x442ba3);});},'error':function(_0x23a6e5){var _0x2f48fa=_0x209cf8;_0x2d2a09[_0x2f48fa(0x142)](_0x23a6e5);}});}function _0x252e84(_0x142289,_0x4a0428,_0x3b6557){var _0xea4295=_0x5f0f33,_0x50d226=$[_0xea4295(0x14b)](),_0x2b4197=_spPageContextInfo[_0xea4295(0x13f)]+_0xea4295(0x17b)+_0x142289+_0xea4295(0x15c)+_0x4a0428+'\x27)/folders';return $[_0xea4295(0x139)]({'url':_0x2b4197,'method':_0xea4295(0x187),'headers':{'Accept':_0xea4295(0x147)},'success':function(_0x45f003){var _0x16c61f=_0xea4295,_0x4930be=_0x45f003['d'][_0x16c61f(0x16e)],_0x348bdf=$[_0x16c61f(0x131)](_0x4930be,function(_0x1ecd59){var _0x178115=_0x16c61f,_0x34d41f=_0x1ecd59[_0x178115(0x162)];return _0x290646(_0x142289,_0x34d41f,null,_0x3b6557);});$[_0x16c61f(0x166)][_0x16c61f(0x12b)]($,_0x348bdf)[_0x16c61f(0x149)](function(){var _0x19bde2=_0x16c61f,_0xbe9189=[];for(var _0x35ae24=0x0;_0x35ae24<arguments[_0x19bde2(0x17d)];_0x35ae24++){_0xbe9189=_0xbe9189[_0x19bde2(0x12c)](arguments[_0x35ae24]);}var _0x331bba=_0x3b6557['concat'](_0xbe9189);_0x50d226[_0x19bde2(0x174)](_0x331bba);})[_0x16c61f(0x140)](function(_0x5e3ef1){var _0x2b2e29=_0x16c61f;_0x50d226[_0x2b2e29(0x142)](_0x5e3ef1);});},'error':function(_0x5d5c1c){_0x50d226['reject'](_0x5d5c1c);}}),_0x50d226[_0xea4295(0x160)]();}return _0x2d2a09[_0x5f0f33(0x160)]();}