var a0_0x392fc1=a0_0x2d3d;(function(_0x341cea,_0x5dc23f){var _0xac6048=a0_0x2d3d,_0x35b2a4=_0x341cea();while(!![]){try{var _0x75f0a1=parseInt(_0xac6048(0x18a))/0x1*(-parseInt(_0xac6048(0x16d))/0x2)+parseInt(_0xac6048(0x14a))/0x3+-parseInt(_0xac6048(0x144))/0x4+parseInt(_0xac6048(0x148))/0x5+-parseInt(_0xac6048(0x145))/0x6+parseInt(_0xac6048(0x150))/0x7*(-parseInt(_0xac6048(0x187))/0x8)+parseInt(_0xac6048(0x173))/0x9*(parseInt(_0xac6048(0x17f))/0xa);if(_0x75f0a1===_0x5dc23f)break;else _0x35b2a4['push'](_0x35b2a4['shift']());}catch(_0x40ec09){_0x35b2a4['push'](_0x35b2a4['shift']());}}}(a0_0x3b19,0x47e8a));var arrContributorIds=[],companyID='';$(document)[a0_0x392fc1(0x170)](function(){var _0x5553a2=a0_0x392fc1;companyID=titanForWork[_0x5553a2(0x14e)]('CompanyId'),getTech_HR_Admin(),userActivityNotificationEntry(_spPageContextInfo['userId'],window['location']),setInterval(function(){var _0x15397e=_0x5553a2;$(_0x15397e(0x17b))['contents']()[_0x15397e(0x161)](_0x15397e(0x167))['hide'](),$('#siteanalytics')[_0x15397e(0x154)]()['find']('.sp-PopularContent-Header')[_0x15397e(0x149)](),$(_0x15397e(0x17b))[_0x15397e(0x154)]()[_0x15397e(0x161)]('.sp-SiteHubList-listView')['hide'](),$(_0x15397e(0x16a))[_0x15397e(0x183)](_0x15397e(0x16b));},0xbb8);}),$(window)[a0_0x392fc1(0x153)](function(){var _0x51f803=a0_0x392fc1;$('#siteanalytics')[_0x51f803(0x154)]()[_0x51f803(0x161)]('.sp-PopularContent-List')[_0x51f803(0x149)](),$('#siteanalytics')[_0x51f803(0x154)]()[_0x51f803(0x161)](_0x51f803(0x16e))[_0x51f803(0x149)](),$(_0x51f803(0x17b))[_0x51f803(0x154)]()[_0x51f803(0x161)](_0x51f803(0x188))['hide'](),$(_0x51f803(0x157))[_0x51f803(0x16f)](),$(_0x51f803(0x157))[_0x51f803(0x15f)](_0x51f803(0x175)),$(_0x51f803(0x157))[_0x51f803(0x189)]({'font-size':_0x51f803(0x172),'font-weight':_0x51f803(0x14c),'float':_0x51f803(0x180)}),$(_0x51f803(0x157))['after'](_0x51f803(0x15c)),$('#btnRedirect')[_0x51f803(0x155)](function(){var _0x306df7=_0x51f803;location[_0x306df7(0x158)]=_0x306df7(0x142);});});function GraphAccessTokenTogetUserDetails(){var _0x19487e=a0_0x392fc1,_0xff2f18=new jQuery['Deferred'](),_0x322591={'X-RequestDigest':$(_0x19487e(0x15b))[_0x19487e(0x14d)](),'accept':_0x19487e(0x17c),'content-type':_0x19487e(0x17c)},_0x1fb470={'resource':_0x19487e(0x181)};return $[_0x19487e(0x178)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x19487e(0x15a),'headers':_0x322591,'type':'POST','data':JSON[_0x19487e(0x152)](_0x1fb470),'success':function(_0x21ca97){var _0x26f613=_0x19487e,_0x5ea3fd=_0x21ca97[_0x26f613(0x143)];WebAnalytics(_0x5ea3fd),_0xff2f18[_0x26f613(0x182)](_0x5ea3fd);},'error':function(_0xedf1f0,_0x48375b,_0x18a3ca){var _0x1ac3ca=_0x19487e;console[_0x1ac3ca(0x17e)](_0xedf1f0[_0x1ac3ca(0x171)]),_0xff2f18[_0x1ac3ca(0x17d)](_0xedf1f0[_0x1ac3ca(0x171)]);}}),_0xff2f18[_0x19487e(0x165)]();}GraphAccessTokenTogetUserDetails();function getTech_HR_Admin(){var _0x5112b6=a0_0x392fc1,_0x407799=$['Deferred'](),_0xef7936=_0x5112b6(0x151)+companyID+'\x27)';return $[_0x5112b6(0x178)]({'url':_spPageContextInfo[_0x5112b6(0x176)]+_0x5112b6(0x163)+_0xef7936,'type':_0x5112b6(0x174),'async':![],'headers':{'accept':_0x5112b6(0x147)},'success':function(_0x52dc19){var _0x1b3a1a=_0x5112b6;_0x407799[_0x1b3a1a(0x182)](_0x52dc19['d']['results']);if(_0x52dc19['d'][_0x1b3a1a(0x160)]['length']>0x0){for(var _0x1c13da=0x0;_0x1c13da<_0x52dc19['d'][_0x1b3a1a(0x160)][_0x1b3a1a(0x185)];_0x1c13da++){value=_0x52dc19['d']['results'][_0x1c13da][_0x1b3a1a(0x179)]['results'];for(var _0x986a10=0x0;_0x986a10<value[_0x1b3a1a(0x185)];_0x986a10++){arrContributorIds[_0x1b3a1a(0x16c)](value[_0x986a10]['ID']);}}arrContributorIds=arrContributorIds[_0x1b3a1a(0x156)](function(_0x488ea8,_0x241da3,_0xffa70c){return _0x241da3===_0xffa70c['indexOf'](_0x488ea8);});}IsUserTech_HR_Admin();},'error':function(_0x12a06f){var _0x4a5a4=_0x5112b6;_0x407799[_0x4a5a4(0x17d)](_0x12a06f),console[_0x4a5a4(0x17e)](_0x12a06f);}}),_0x407799[_0x5112b6(0x165)]();}function IsUserTech_HR_Admin(){var _0xb49203=a0_0x392fc1,_0x37e41d=_spPageContextInfo[_0xb49203(0x177)];arrContributorIds['indexOf'](_0x37e41d)==-0x1?($(_0xb49203(0x17b))[_0xb49203(0x149)](),$(_0xb49203(0x186))['show']()):($(_0xb49203(0x17b))['attr'](_0xb49203(0x17a),'../_layouts/15/siteanalytics.aspx'),$(_0xb49203(0x186))[_0xb49203(0x149)]());}function a0_0x2d3d(_0x7fe933,_0x4d2c8b){var _0x3b19ce=a0_0x3b19();return a0_0x2d3d=function(_0x2d3dde,_0x3712f8){_0x2d3dde=_0x2d3dde-0x142;var _0x21dbcd=_0x3b19ce[_0x2d3dde];return _0x21dbcd;},a0_0x2d3d(_0x7fe933,_0x4d2c8b);}function a0_0x3b19(){var _0x4a0690=['promise','json','.sp-PopularContent-List','statusCode','Site\x20Collection\x20count\x20:\x20','#s4-workspace','WebAnalytics_Adoption','push','510838NXzdXX','.sp-PopularContent-Header','show','ready','responseText','24px','190827AeVVNn','GET','Adoption','webAbsoluteUrl','userId','ajax','Contributors','src','#siteanalytics','application/json;odata=nometadata','reject','log','430GgSpGO','left','https://graph.microsoft.com','resolve','addClass','error','length','#DivNotAccess','226248MCYCVC','.sp-SiteHubList-listView','css','1DFOJFB','../Pages/Default.aspx','access_token','1692808ucCLim','2826306YTncbE','body','application/json;odata=verbose','1403340ryxdGC','hide','1009968hFdMoM','\x20in\x20csvToJSON\x20method...','600','val','getQueryStringParameter','../_api/site/usage','21ckqhms','?$select=ID,WebPartName,Contributors/ID,Contributors/Name,Company/Title&$expand=Contributors/Title,Contributors/Name,Company/Id&$filter=(WebPartName\x20eq\x20\x27Tech\x20Admin\x27\x20or\x20WebPartName\x20eq\x20\x27HR\x20Admin\x27)\x20and\x20(CompanyId\x20eq\x20\x27','stringify','load','contents','click','filter','#ctl00_PlaceHolderMain_ctl01_label','href','toString','/_api/SP.OAuth.Token/Acquire','#__REQUESTDIGEST','<button\x20type=\x27button\x27\x20id=\x27btnRedirect\x27\x20style=\x27float:right;\x27>Close</button>','split','application/json;\x20odata=verbose','text','results','find','https://graph.microsoft.com/beta/reports/getSharePointSiteUsageDetail(period=\x27D7\x27)','/_api/web/lists/getbytitle(\x27ProcessApprovers\x27)/items/','parse'];a0_0x3b19=function(){return _0x4a0690;};return a0_0x3b19();}var odurlGraphUserRestQuery=a0_0x392fc1(0x162),_NextToken;function WebAnalytics(_0x5d9ca3){var _0x252424=a0_0x392fc1,_0x47ee35=_0x252424(0x14f);_NextToken=_0x5d9ca3,$[_0x252424(0x178)]({'url':_0x47ee35,'dataType':_0x252424(0x166),'headers':{'Accept':_0x252424(0x15e)},'accept':'application/json;odata.metadata=none','async':![],'success':function(_0x410e2c){getsharePointUsageReportData(reqUrl);},'eror':function(_0x421015){var _0x2ab386=_0x252424;debugger;console[_0x2ab386(0x17e)](_0x2ab386(0x184));}});}var reqUrl='https://graph.microsoft.com/v1.0/reports/getSharePointSiteUsageDetail(period=\x27D30\x27)';function getsharePointUsageReportData(_0x296a05){var _0x1e92f0=a0_0x392fc1;console[_0x1e92f0(0x17e)]('Inside\x20get\x20user\x20last\x20logon\x20data\x20method!!!');var _0x372dd8=httpGet(encodeURI(_0x296a05),_NextToken);if(_0x372dd8[_0x1e92f0(0x168)]==0xc8){failIndex=0x0;var _0x604fc6=convertCSVToJSON(_0x372dd8[_0x1e92f0(0x146)][_0x1e92f0(0x159)]('utf-8')),_0x2397cf=JSON[_0x1e92f0(0x164)](_0x604fc6);if(_0x2397cf){siteCollectionCount=siteCollectionCount+_0x2397cf[_0x1e92f0(0x185)];for(var _0x54c830=0x0;_0x54c830<_0x2397cf[_0x1e92f0(0x185)];_0x54c830++){var _0x2f0fe0=_0x2397cf[_0x54c830];if(_0x2f0fe0){}}}console[_0x1e92f0(0x17e)](_0x1e92f0(0x169)+siteCollectionCount);}else console[_0x1e92f0(0x17e)]('API\x20received\x20the\x20failed\x20response,\x20Please\x20check\x20again');}function convertCSVToJSON(_0x267352){var _0x35a7ef=a0_0x392fc1;try{var _0x17c13=_0x267352[_0x35a7ef(0x15d)]('\x0a'),_0x418c46=[],_0x152f6b=_0x17c13[0x0][_0x35a7ef(0x15d)](',');for(var _0x3c8b94=0x1;_0x3c8b94<_0x17c13[_0x35a7ef(0x185)];_0x3c8b94++){var _0x50805e={};if(_0x17c13[_0x3c8b94]){var _0x48cd98=_0x17c13[_0x3c8b94][_0x35a7ef(0x15d)](',');for(var _0x3251d3=0x0;_0x3251d3<_0x152f6b[_0x35a7ef(0x185)];_0x3251d3++){_0x50805e[_0x152f6b[_0x3251d3]]=_0x48cd98[_0x3251d3];}_0x418c46[_0x35a7ef(0x16c)](_0x50805e);}}return JSON[_0x35a7ef(0x152)](_0x418c46);}catch(_0xef8f82){console['log'](_0xef8f82+_0x35a7ef(0x14b));}}