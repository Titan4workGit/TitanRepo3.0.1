var a0_0x5d04dd=a0_0x3a72;(function(_0x33ccaa,_0x389c8f){var _0xec71f8=a0_0x3a72,_0x420280=_0x33ccaa();while(!![]){try{var _0x4c8bea=parseInt(_0xec71f8(0x198))/0x1+parseInt(_0xec71f8(0x1e3))/0x2*(parseInt(_0xec71f8(0x1f6))/0x3)+-parseInt(_0xec71f8(0x1d4))/0x4*(-parseInt(_0xec71f8(0x1ac))/0x5)+parseInt(_0xec71f8(0x1aa))/0x6*(parseInt(_0xec71f8(0x173))/0x7)+parseInt(_0xec71f8(0x1a0))/0x8*(-parseInt(_0xec71f8(0x200))/0x9)+-parseInt(_0xec71f8(0x1d7))/0xa+-parseInt(_0xec71f8(0x17b))/0xb;if(_0x4c8bea===_0x389c8f)break;else _0x420280['push'](_0x420280['shift']());}catch(_0x30fa52){_0x420280['push'](_0x420280['shift']());}}}(a0_0x3d21,0xe0421));var GCompanyId='',GOfficeDays='';$(document)[a0_0x5d04dd(0x16c)](function(){var _0x360a4a=a0_0x5d04dd;userActivityNotificationEntry(_spPageContextInfo[_0x360a4a(0x233)],window['location']),authentication(),GCompanyId=titanForWork[_0x360a4a(0x221)]('CompanyId'),$(_0x360a4a(0x205))[_0x360a4a(0x1df)]({'dateFormat':'dd/mm/yy','maxDate':new Date()})[_0x360a4a(0x1df)](_0x360a4a(0x175),new Date()),$(_0x360a4a(0x1f7))[_0x360a4a(0x1df)]({'dateFormat':_0x360a4a(0x1c3)})['datepicker'](_0x360a4a(0x175),_0x360a4a(0x1d8)),$(_0x360a4a(0x237))[_0x360a4a(0x1ea)](formatDateReport(ConvertDateTimeFormat($(_0x360a4a(0x1f7))['val'](),'/'))),$(_0x360a4a(0x1b1))[_0x360a4a(0x1ea)](formatDateReport(ConvertDateTimeFormat($(_0x360a4a(0x205))[_0x360a4a(0x1ff)](),'/')));var _0x57dd93=$(_0x360a4a(0x1f7))[_0x360a4a(0x1df)](_0x360a4a(0x214)),_0x210b8b=$(_0x360a4a(0x205))[_0x360a4a(0x1df)](_0x360a4a(0x214));days=(_0x210b8b-_0x57dd93)/(0x3e8*0x3c*0x3c*0x18);var _0x5b38dd=Math[_0x360a4a(0x195)](days);GOfficeDays=Math[_0x360a4a(0x195)](days),LoadAllOfficeLocation(),LoadAllDepartment(),LoadAllHolidays(),$(_0x360a4a(0x18a))[_0x360a4a(0x1ea)]($(_0x360a4a(0x1d0))[_0x360a4a(0x1ea)]()),initializePeoplePicker(_0x360a4a(0x1a9)),initializePeoplePicker(_0x360a4a(0x188)),$(_0x360a4a(0x1c1))[_0x360a4a(0x21e)]('show');});function initializePeoplePicker(_0x2a9742){var _0x20fee9=a0_0x5d04dd,_0x2986b9={};_0x2986b9['PrincipalAccountType']=_0x20fee9(0x208),_0x2986b9['SearchPrincipalSource']=0xf,_0x2986b9[_0x20fee9(0x1af)]=0xf,_0x2986b9['AllowMultipleValues']=![],_0x2986b9[_0x20fee9(0x19a)]=0x32,_0x2986b9[_0x20fee9(0x19e)]=_0x20fee9(0x19d),this['SPClientPeoplePicker_InitStandaloneControlWrapper'](_0x2a9742,null,_0x2986b9);}function ensureUser(_0x4bd92f){var _0x33056f=a0_0x5d04dd,_0x1b3e5c=0x0,_0x4d0440=_0x4bd92f,_0x5a97eb=this[_0x33056f(0x16f)][_0x33056f(0x222)][_0x4d0440],_0x370919=_0x5a97eb[_0x33056f(0x1fc)](),_0x20189d=_0x370919[0x0];if(_0x20189d){var _0x5136ab={'logonName':_0x20189d[_0x33056f(0x1cd)]};$[_0x33056f(0x201)]({'url':_spPageContextInfo[_0x33056f(0x211)]+_0x33056f(0x22b),'type':_0x33056f(0x1ed),'async':![],'contentType':'application/json;odata=verbose','data':JSON[_0x33056f(0x215)](_0x5136ab),'headers':{'X-RequestDigest':$(_0x33056f(0x218))['val'](),'accept':_0x33056f(0x223)},'success':function(_0x16357c,_0xfdfaf5,_0x5dbaa9){_0x1b3e5c=_0x16357c['d']['Id'];},'error':function(_0x379156,_0x1536a2,_0x5c1374){}});}else _0x1b3e5c=0x0;return _0x1b3e5c;}function GetUserTitle(_0x2b445d){var _0x1d33f4=a0_0x5d04dd,_0x2ccb97=0x0,_0x489713=_0x2b445d,_0x33a4b7=this[_0x1d33f4(0x16f)][_0x1d33f4(0x222)][_0x489713],_0x5a0f0b=_0x33a4b7[_0x1d33f4(0x1fc)](),_0x1c3ec8=_0x5a0f0b[0x0];if(_0x1c3ec8){var _0x48bcdb={'logonName':_0x1c3ec8[_0x1d33f4(0x1cd)]};$['ajax']({'url':_spPageContextInfo[_0x1d33f4(0x211)]+_0x1d33f4(0x22b),'type':_0x1d33f4(0x1ed),'async':![],'contentType':'application/json;odata=verbose','data':JSON[_0x1d33f4(0x215)](_0x48bcdb),'headers':{'X-RequestDigest':$('#__REQUESTDIGEST')[_0x1d33f4(0x1ff)](),'accept':_0x1d33f4(0x223)},'success':function(_0x514909,_0x421116,_0x405b16){var _0x5f55b3=_0x1d33f4;_0x2ccb97=_0x514909['d'][_0x5f55b3(0x180)];},'error':function(_0x2383bb,_0xb156bc,_0x528330){}});}else _0x2ccb97=0x0;return _0x2ccb97;}function a0_0x3d21(){var _0x120b9f=['fadeIn','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','<option\x20value=\x22All\x22>All</option>','Aug','3XMTINW','#attendance-reportFrom','floor','<div\x20class=\x27upload-chip\x27>','Holiday','value','GetAllUserInfo','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','#officeLocTH','val','225zWWdPs','ajax','Jul','promise','fadeOut','#attendance-reportTo','\x27\x20and\x20Employee\x20eq\x20\x27','DD/MM/YYYY','User,DL,SecGroup,SPGroup','LogonName','This\x20feature\x20has\x20been\x20deactivated\x20!','#DepartmentDDL','EmpWorkHours','YYYY-MM-DD','\x27\x20and\x20AttendanceDate\x20le\x20\x27','<option\x20value=\x22','\x27\x20class=\x27custom-edit-btn\x27><i\x20class=\x27fa\x20fa-chevron-right\x27></i></a></div></td>','webAbsoluteUrl','error','#totalemp','getDate','stringify','/Pages/EmployeeReport.aspx?EID=','application/json;\x20odata=verbose','#__REQUESTDIGEST','ModalDialog','empty','Deferred','</div>','&start=','modal','pagedropdown','href','getQueryStringParameter','SPClientPeoplePickerDict','application/json;odata=verbose','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>0</div></td>','responseJSON','ManagerLoginName','getElementById','selectedrow','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','checked','/_api/web/ensureuser','Rependrecord','formatDate','All','sorter','close','tablenav','getFullYear','userId','Feb','blue','and\x20Department\x20eq\x20\x27','#FromDate','/_api/web/lists/getbytitle(\x27EnvironmentalSettings\x27)/items?$select=Title,Active,ListOfUsers/Title&$filter=Title\x20eq\x20\x27Attendance\x20Entry\x27\x20&$expand=ListOfUsers/Id','\x27\x20and\x20Holiday_start\x20le\x20\x27','ready','filter','<tr\x20class=\x27text-center\x27>','SPClientPeoplePicker','/_api/web/lists/getbytitle(\x27Departments\x27)/items?select=ID,Title&$filter=CompanyID\x20eq\x20\x27','/_api/web/lists/GetByTitle(\x27OfficeLocation\x27)/items?$select=ID,OfficeName,CompanyID/ID&$expand=CompanyID&$top=5000&$filter=CompanyID/ID\x20eq\x20\x27','indexOf','127876uCttIp','#FdateTH','setDate','&end=','data:application/vnd.ms-excel;base64,','includes','and\x20ManagerLoginName\x20eq\x20\x27','MM/DD/YYYY','272899FIXJVQ','grep','it\x20exceeds\x20the\x20list\x20view\x20threshold','LeavesDay','.NoRecordFound','Title','On\x20Leave','log','OfficeLocation','nodeType','show','D,\x20dd','attr','Employee','&sourcelocation=../Pages/Report.aspx#','#SelectedLocation','userDisplayName','00:00\x20(H:M)','AttendanceItemId','desc','</option>','Apr','when','</tr>','Designation','Reptotalrecords','round','/Pages/Myworkplace.aspx?WebAppId=232SHDFGHJF22B2526DFG','CompanyId','942977ANZvKR','join','MaximumEntitySuggestions','Mar','\x27\x20and\x20Holiday_start\x20ge\x20\x27','280px','Width','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>00:00</div></td>','26064DWgzVw','message','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','Nov','#TotalWorkdayTH','Department','Sept','getTime','oddrow','Manager','24KThqOu','concat','5JDmDrk','evenselected','Repcurrentpage','ResolvePrincipalSource','WorkHours','#ToDate','format','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,ManagerLoginName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,ManagerLoginName,OfficeLocation,Company,Department&$filter=Status\x20eq\x20\x27Active\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','AttendanceType','replace','Reptotalpages','__next','\x27&$orderby=OfficeName\x20asc','location','UserId','#ReportTable','May','#Manager','#monthhyear','children','oddselected','#attendance-report-filter','length','dd/mm/yy','appendTo','AttendanceDate','</div></td>','&WebAppId=','and\x20LogonName/ID\x20eq\x20\x27','btoa','Full\x20Day','OfficeName','#chips','Key','split','#HolidaysTH','#OfficeLoc\x20option:selected','#OfficeLoc','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27','#overlaysearch','5456600tGkgNv','ReportTableData','Active','15144480KYydBO','-7d','Jun','Worksheet','<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>','#Employee','columns','and\x20OfficeLocation\x20eq\x20\x27','datepicker','HrAction','Dec','append','318138qlwBBy','GET','results','Error\x20in\x20getFileData.','evenrow','hide','asc','text','push','getMonth','POST','map','\x27\x20and\x20CompanyID\x20eq\x20\x27','red','showWaitScreenWithNoClose'];a0_0x3d21=function(){return _0x120b9f;};return a0_0x3d21();}function a0_0x3a72(_0x4e6939,_0x977ff2){var _0x3d210a=a0_0x3d21();return a0_0x3a72=function(_0x3a72cd,_0x244df3){_0x3a72cd=_0x3a72cd-0x16b;var _0x2e1229=_0x3d210a[_0x3a72cd];return _0x2e1229;},a0_0x3a72(_0x4e6939,_0x977ff2);}function ConvertDateTimeFormat(_0x5c10a6,_0x5cdce2){var _0x116d81=a0_0x5d04dd;return _0x5c10a6[_0x116d81(0x1ce)](_0x5cdce2)[0x1]+''+_0x5cdce2+''+_0x5c10a6[_0x116d81(0x1ce)](_0x5cdce2)[0x0]+''+_0x5cdce2+''+_0x5c10a6[_0x116d81(0x1ce)](_0x5cdce2)[0x2];}function formatDateReport(_0x34eb38){var _0xad362b=a0_0x5d04dd,_0x109ded=new Date(_0x34eb38);if(isNaN(_0x109ded[_0xad362b(0x1a7)]()))return _0x34eb38;else{var _0x30791b=new Array();return _0x30791b[0x0]='Jan',_0x30791b[0x1]=_0xad362b(0x234),_0x30791b[0x2]=_0xad362b(0x19b),_0x30791b[0x3]=_0xad362b(0x190),_0x30791b[0x4]=_0xad362b(0x1bc),_0x30791b[0x5]=_0xad362b(0x1d9),_0x30791b[0x6]=_0xad362b(0x202),_0x30791b[0x7]=_0xad362b(0x1f5),_0x30791b[0x8]=_0xad362b(0x1a6),_0x30791b[0x9]='Oct',_0x30791b[0xa]=_0xad362b(0x1a3),_0x30791b[0xb]=_0xad362b(0x1e1),day=_0x109ded[_0xad362b(0x214)](),day<0xa&&(day='0'+day),day+'\x20'+_0x30791b[_0x109ded[_0xad362b(0x1ec)]()]+'\x20'+_0x109ded[_0xad362b(0x232)]();}}function LoadAllOfficeLocation(){var _0x14a69d=a0_0x5d04dd;$(_0x14a69d(0x1d1))[_0x14a69d(0x21a)]();var _0x458e9e=_spPageContextInfo[_0x14a69d(0x211)]+_0x14a69d(0x171)+GCompanyId+_0x14a69d(0x1b8);$[_0x14a69d(0x201)]({'url':_0x458e9e,'headers':{'Accept':_0x14a69d(0x223)},'async':![],'success':function(_0x3f9009){var _0x500b41=_0x14a69d;for(var _0x301b85=0x0;_0x301b85<_0x3f9009['d'][_0x500b41(0x1e5)][_0x500b41(0x1c2)];_0x301b85++){$('#OfficeLoc')['append'](_0x500b41(0x20f)+_0x3f9009['d']['results'][_0x301b85]['ID']+'\x22>'+_0x3f9009['d'][_0x500b41(0x1e5)][_0x301b85][_0x500b41(0x1cb)]+_0x500b41(0x18f));}},'myError':function(_0x38cf89){}});}function LoadAllDepartment(){var _0x3cd21c=a0_0x5d04dd;$(_0x3cd21c(0x20b))['empty']();var _0x5daeed=_spPageContextInfo[_0x3cd21c(0x211)]+_0x3cd21c(0x170)+GCompanyId+'\x27&$orderby=Title\x20asc&$top=5000';$[_0x3cd21c(0x201)]({'url':_0x5daeed,'headers':{'Accept':_0x3cd21c(0x223)},'async':!![],'success':function(_0x431ada){var _0x394e58=_0x3cd21c;$(_0x394e58(0x1f4))[_0x394e58(0x1c4)](_0x394e58(0x20b));for(var _0x52504a=0x0;_0x52504a<_0x431ada['d'][_0x394e58(0x1e5)][_0x394e58(0x1c2)];_0x52504a++){$(_0x394e58(0x20b))['append'](_0x394e58(0x20f)+_0x431ada['d']['results'][_0x52504a]['ID']+'\x22>'+_0x431ada['d'][_0x394e58(0x1e5)][_0x52504a][_0x394e58(0x180)]+_0x394e58(0x18f));}},'myError':function(_0x3a88ec){}});}var TotalOfficeDays=0x0,GtotalHolidays=0x0;function LoadAllHolidays(){var _0x2d9b34=a0_0x5d04dd,_0x58d91b=$(_0x2d9b34(0x1d1))[_0x2d9b34(0x1ff)]();TotalOfficeDays=0x0,GtotalHolidays=0x0;var _0x2c348a=new Date(ConvertDateTimeFormat($('#attendance-reportFrom')[_0x2d9b34(0x1ff)](),'/')),_0x1be11f=_0x2c348a[_0x2d9b34(0x232)]()+'-'+(_0x2c348a['getMonth']()+0x1)+'-'+_0x2c348a['getDate'](),_0x323243=new Date(ConvertDateTimeFormat($(_0x2d9b34(0x205))[_0x2d9b34(0x1ff)](),'/')),_0x2e04ed=_0x323243[_0x2d9b34(0x232)]()+'-'+(_0x323243[_0x2d9b34(0x1ec)]()+0x1)+'-'+_0x323243['getDate'](),_0xdc46c6=_spPageContextInfo[_0x2d9b34(0x211)]+_0x2d9b34(0x229)+_0x58d91b+_0x2d9b34(0x1ef)+GCompanyId+_0x2d9b34(0x19c)+_0x1be11f+_0x2d9b34(0x16b)+_0x2e04ed+'\x27';$[_0x2d9b34(0x201)]({'url':_0xdc46c6,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x5550a5){var _0x82131d=_0x2d9b34,_0x2f6ee4=_0x5550a5['d']['results'][_0x82131d(0x1c2)];GtotalHolidays=_0x2f6ee4,$('#TotalHolidays')['text'](_0x2f6ee4),$('#TotalOfficeDays')[_0x82131d(0x1ea)](parseInt(GOfficeDays)-parseInt(_0x2f6ee4)),TotalOfficeDays=parseInt(GOfficeDays)-parseInt(_0x2f6ee4);},'myError':function(_0x59a9c6){}});}function Applyfilter(){var _0x2f89f2=a0_0x5d04dd;$(_0x2f89f2(0x237))['text'](formatDateReport(ConvertDateTimeFormat($(_0x2f89f2(0x1f7))[_0x2f89f2(0x1ff)](),'/'))),$('#ToDate')[_0x2f89f2(0x1ea)](formatDateReport(ConvertDateTimeFormat($(_0x2f89f2(0x205))[_0x2f89f2(0x1ff)](),'/'))),$(_0x2f89f2(0x18a))[_0x2f89f2(0x1ea)]($('#OfficeLoc\x20option:selected')[_0x2f89f2(0x1ea)]()),$(_0x2f89f2(0x174))[_0x2f89f2(0x1ea)](formatDateReport(ConvertDateTimeFormat($('#attendance-reportFrom')[_0x2f89f2(0x1ff)](),'/'))),$('#EdateTH')[_0x2f89f2(0x1ea)](formatDateReport(ConvertDateTimeFormat($('#attendance-reportTo')[_0x2f89f2(0x1ff)](),'/'))),$(_0x2f89f2(0x1fe))[_0x2f89f2(0x1ea)]($(_0x2f89f2(0x1d0))[_0x2f89f2(0x1ea)]()),$(_0x2f89f2(0x1a4))[_0x2f89f2(0x1ea)](TotalOfficeDays),$(_0x2f89f2(0x1cf))[_0x2f89f2(0x1ea)](GtotalHolidays);var _0x54956c=$(_0x2f89f2(0x1f7))[_0x2f89f2(0x1df)]('getDate'),_0x5af68e=$(_0x2f89f2(0x205))[_0x2f89f2(0x1df)](_0x2f89f2(0x214));days=(_0x5af68e-_0x54956c)/(0x3e8*0x3c*0x3c*0x18),GOfficeDays=Math['round'](days)+0x1,LoadAllHolidays(),$('#attendencedateValue')[_0x2f89f2(0x1ff)]('');var _0x2faa60=$(_0x2f89f2(0x1f7))[_0x2f89f2(0x1ff)](),_0x56b755=moment($('#attendance-reportFrom')[_0x2f89f2(0x1ff)](),'DD/MM/YYYY')[_0x2f89f2(0x1b2)](_0x2f89f2(0x20d)),_0x2da61e=moment($('#attendance-reportTo')[_0x2f89f2(0x1ff)](),_0x2f89f2(0x207))['format']('YYYY-MM-DD');$('#daydate')[_0x2f89f2(0x1ea)]($['datepicker'][_0x2f89f2(0x22d)](_0x2f89f2(0x186),new Date(_0x56b755))),$(_0x2f89f2(0x1be))[_0x2f89f2(0x1ea)]($['datepicker']['formatDate']('M\x20\x20yy',new Date(_0x56b755)));var _0x4f6962='',_0x1e3731='';$(_0x2f89f2(0x1d1))[_0x2f89f2(0x1ff)]()!='All'&&(_0x4f6962+=_0x2f89f2(0x1de)+$('#OfficeLoc')[_0x2f89f2(0x1ff)]()+'\x27\x20',_0x1e3731+=_0x2f89f2(0x1f9)+$(_0x2f89f2(0x1d0))[_0x2f89f2(0x1ea)]()+'</div>');$(_0x2f89f2(0x20b))[_0x2f89f2(0x1ff)]()!=_0x2f89f2(0x22e)&&(_0x4f6962+=_0x2f89f2(0x236)+$('#DepartmentDDL')[_0x2f89f2(0x1ff)]()+'\x27\x20',_0x1e3731+=_0x2f89f2(0x1f9)+$('#DepartmentDDL\x20option:selected')[_0x2f89f2(0x1ea)]()+_0x2f89f2(0x21c));var _0x556510=ensureUser($(_0x2f89f2(0x1bd))[_0x2f89f2(0x1bf)]()[_0x2f89f2(0x1bf)]()[_0x2f89f2(0x187)]('id')),_0x55ea11=ensureUser($('#Employee')['children']()[_0x2f89f2(0x1bf)]()[_0x2f89f2(0x187)]('id'));_0x556510!=0x0&&(_0x4f6962+=_0x2f89f2(0x179)+_0x556510+'\x27\x20',_0x1e3731+=_0x2f89f2(0x1f9)+GetUserTitle($('#Manager')[_0x2f89f2(0x1bf)]()[_0x2f89f2(0x1bf)]()[_0x2f89f2(0x187)]('id'))+_0x2f89f2(0x21c)),_0x55ea11!=0x0&&(_0x4f6962+=_0x2f89f2(0x1c8)+_0x55ea11+'\x27\x20',_0x1e3731+=_0x2f89f2(0x1f9)+GetUserTitle($(_0x2f89f2(0x1dc))['children']()[_0x2f89f2(0x1bf)]()['attr']('id'))+'</div>'),$(_0x2f89f2(0x1cc))[_0x2f89f2(0x21a)](),$(_0x2f89f2(0x1cc))[_0x2f89f2(0x1e2)](_0x1e3731),$('#overlaysearch')[_0x2f89f2(0x1f2)](),setTimeout(function(){var _0x5c3ed3=_0x2f89f2,_0x2fc46c=_spPageContextInfo[_0x5c3ed3(0x211)]+_0x5c3ed3(0x1f3)+_0x56b755+_0x5c3ed3(0x20e)+_0x2da61e+'\x27\x20';$[_0x5c3ed3(0x191)](getFileData(_0x2fc46c))['done'](function(_0x1ae746){var _0x33dc16=_0x5c3ed3,_0x281555=_spPageContextInfo['webAbsoluteUrl']+_0x33dc16(0x1b3)+GCompanyId+'\x27'+_0x4f6962;EmployeeListDat(_0x281555),$(_0x33dc16(0x1d3))[_0x33dc16(0x204)]();});},0x5dc);}var TempStore=[],unique='';function getFileData(_0x53c476){var _0x23e34f=a0_0x5d04dd;jQuery[_0x23e34f(0x201)]({'url':_0x53c476,'headers':{'Accept':_0x23e34f(0x223)},'async':![],'success':function(_0x1a4570){var _0x447117=_0x23e34f;EmpAttendanceData=[];var _0x3c112e=_0x1a4570['d'][_0x447117(0x1e5)];if(_0x3c112e[_0x447117(0x1c2)]>0x0){TempStore=[];for(var _0x15de46=0x0;_0x15de46<_0x3c112e['length'];_0x15de46++){TempStore[_0x447117(0x1eb)](_0x3c112e[_0x15de46]['Employee']['ID']);}unique=TempStore[_0x447117(0x16d)](function(_0x1ee671,_0x59e752,_0x56f019){var _0x375b87=_0x447117;return _0x59e752==_0x56f019[_0x375b87(0x172)](_0x1ee671);});if(unique[_0x447117(0x1c2)]>0x0){EmpAttendanceData=[];for(var _0x450be9=0x0;_0x450be9<unique[_0x447117(0x1c2)];_0x450be9++){var _0x374b85=0x0,_0x140282=[],_0x391496=[],_0x2a0169=moment($(_0x447117(0x1f7))[_0x447117(0x1ff)](),_0x447117(0x207))[_0x447117(0x1b2)](_0x447117(0x20d)),_0x15c69e=moment($(_0x447117(0x205))[_0x447117(0x1ff)](),'DD/MM/YYYY')[_0x447117(0x1b2)](_0x447117(0x20d)),_0x3150b4=unique[_0x450be9],_0x2c2b93=_spPageContextInfo[_0x447117(0x211)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x2a0169+_0x447117(0x20e)+_0x15c69e+_0x447117(0x206)+_0x3150b4+'\x27\x20';jQuery['ajax']({'url':_0x2c2b93,'headers':{'Accept':_0x447117(0x223)},'async':![],'success':function(_0xe09983){var _0x1d0811=_0x447117,_0x5cf5d7=_0xe09983['d'][_0x1d0811(0x1e5)];if(_0x5cf5d7[_0x1d0811(0x1c2)]>0x0){for(var _0x7c118c=0x0;_0x7c118c<_0x5cf5d7[_0x1d0811(0x1c2)];_0x7c118c++){var _0x527b4b=_0x5cf5d7[_0x7c118c]['ID'],_0x2cd170=_0x5cf5d7[_0x7c118c][_0x1d0811(0x188)]['Title'],_0x29f963=_0x5cf5d7[_0x7c118c][_0x1d0811(0x188)]['ID'],_0x307749=_0x5cf5d7[_0x7c118c][_0x1d0811(0x1c5)],_0x10bbea=_0x5cf5d7[_0x7c118c][_0x1d0811(0x1b4)];if(_0x10bbea==_0x1d0811(0x1ca)||_0x10bbea=='1st\x20Half'||_0x10bbea=='2nd\x20Half')_0x140282['push'](_0x10bbea);else _0x10bbea=='On\x20Leave'&&_0x391496[_0x1d0811(0x1eb)](_0x10bbea);_0x5cf5d7[_0x7c118c][_0x1d0811(0x1b0)]!=null&&(_0x374b85=parseInt(_0x374b85)+parseInt(_0x5cf5d7[_0x7c118c][_0x1d0811(0x1b0)]));var _0x11ff0f=_0x5cf5d7[_0x7c118c][_0x1d0811(0x1e0)],_0x28baec=parseInt(_0x140282[_0x1d0811(0x1c2)])+parseInt(_0x391496['length']),_0x206893=parseInt(TotalOfficeDays)-parseInt(_0x28baec);_0x206893<0x0&&(_0x206893=0x0);}var _0x567fc9=Math[_0x1d0811(0x195)](parseInt(_0x28baec)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x567fc9='-'),EmpAttendanceData[_0x1d0811(0x1eb)]({'UserId':_0x29f963,'EmpName':_0x2cd170,'AttendanceDate':_0x307749,'AttendanceType':_0x10bbea,'AttendanceItemId':_0x527b4b,'EmpWorkHours':_0x374b85,'HrAction':_0x11ff0f,'AttendancDays':_0x140282[_0x1d0811(0x1c2)],'LeavesDay':_0x391496[_0x1d0811(0x1c2)],'NotActionDays':_0x206893,'percentage':_0x567fc9});}},'error':function(_0x1df823,_0x49e9ec){var _0x18a163=_0x447117;console[_0x18a163(0x182)](JSON['stringify'](_0x1df823));}});}}}},'error':function(_0x2be966,_0x5be5bc,_0x2b78a7){var _0x43150a=_0x23e34f;console['log'](_0x43150a(0x1e6)),console[_0x43150a(0x182)](_0x2be966[_0x43150a(0x225)]['error'][_0x43150a(0x1a1)]['value']);var _0x41162d=_0x2be966[_0x43150a(0x225)][_0x43150a(0x212)][_0x43150a(0x1a1)][_0x43150a(0x1fb)],_0x5b3a5b=_0x41162d[_0x43150a(0x178)](_0x43150a(0x17d));_0x5b3a5b==!![]&&(AttendanceReportUsageData=[],AttendanceReportUsageUrl=_spPageContextInfo[_0x43150a(0x211)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000',ReadEmpReportUsageData());}});}var AttendanceReportUsageData=AttendanceReportUsageData||[],AttendanceReportUsageUrl='';function ReadEmpReportUsageData(){var _0x42b2e0=a0_0x5d04dd;return dfds=$[_0x42b2e0(0x21b)](),$[_0x42b2e0(0x201)]({'url':AttendanceReportUsageUrl,'headers':{'Accept':_0x42b2e0(0x223)},'async':![],'success':function(_0x45047a){var _0x583871=_0x42b2e0;FilterState=0x0,AttendanceReportUsageData=AttendanceReportUsageData[_0x583871(0x1ab)](_0x45047a['d'][_0x583871(0x1e5)]);if(_0x45047a['d'][_0x583871(0x1b7)])AttendanceReportUsageUrl=_0x45047a['d'][_0x583871(0x1b7)],ReadEmpReportUsageData();else{if(AttendanceReportUsageData['length']>0x0){var _0x257e72=moment(ConvertDateTimeFormat($('#attendance-reportFrom')[_0x583871(0x1ff)](),'/'))[_0x583871(0x1b2)](_0x583871(0x17a)),_0x2e18d0=moment(ConvertDateTimeFormat($(_0x583871(0x205))[_0x583871(0x1ff)](),'/'))['format'](_0x583871(0x17a)),_0x1698ac=AttendanceReportUsageData[_0x583871(0x16d)](function(_0x53182c){var _0x41a6c4=_0x583871;return Created=moment(_0x53182c[_0x41a6c4(0x1c5)])['format'](_0x41a6c4(0x17a)),(_0x257e72==''?Created!='':Created>=_0x257e72)&&(_0x2e18d0==''?Created!='':Created<=_0x2e18d0);});AttendanceReportUsageData=_0x1698ac;var _0x42a887=[...new Map(AttendanceReportUsageData[_0x583871(0x1ee)](_0x5b7962=>[_0x5b7962['AuthorId'],_0x5b7962]))['values']()];TempStore=[];for(var _0x534f12=0x0;_0x534f12<AttendanceReportUsageData['length'];_0x534f12++){TempStore['push'](AttendanceReportUsageData[_0x534f12][_0x583871(0x188)]['ID']);}unique=TempStore[_0x583871(0x16d)](function(_0x165e06,_0x30f086,_0x4fd641){var _0x2cda31=_0x583871;return _0x30f086==_0x4fd641[_0x2cda31(0x172)](_0x165e06);});if(unique[_0x583871(0x1c2)]>0x0){EmpAttendanceData=[];for(var _0x17193c=0x0;_0x17193c<unique[_0x583871(0x1c2)];_0x17193c++){var _0x2ac364=0x0,_0x1f8bcd=[],_0x27f583=[],_0x371f25=moment($(_0x583871(0x1f7))[_0x583871(0x1ff)](),_0x583871(0x207))[_0x583871(0x1b2)](_0x583871(0x20d)),_0x11bd4d=moment($(_0x583871(0x205))[_0x583871(0x1ff)](),_0x583871(0x207))[_0x583871(0x1b2)](_0x583871(0x20d)),_0x2fb162=unique[_0x17193c],_0x4223ce=$[_0x583871(0x17c)](AttendanceReportUsageData,function(_0x4b10b2){return _0x4b10b2['Employee']['ID']==_0x2fb162;}),_0x998112=_0x4223ce;if(_0x998112['length']>0x0){for(var _0x10662e=0x0;_0x10662e<_0x998112[_0x583871(0x1c2)];_0x10662e++){var _0x1ccf11=_0x998112[_0x10662e]['ID'],_0x466f48=_0x998112[_0x10662e][_0x583871(0x188)]['Title'],_0x177d0a=_0x998112[_0x10662e][_0x583871(0x188)]['ID'],_0x2c1743=_0x998112[_0x10662e][_0x583871(0x1c5)],_0x402364=_0x998112[_0x10662e][_0x583871(0x1b4)];if(_0x402364==_0x583871(0x1ca)||_0x402364=='1st\x20Half'||_0x402364=='2nd\x20Half')_0x1f8bcd['push'](_0x402364);else _0x402364==_0x583871(0x181)&&_0x27f583['push'](_0x402364);_0x998112[_0x10662e]['WorkHours']!=null&&(_0x2ac364=parseInt(_0x2ac364)+parseInt(_0x998112[_0x10662e][_0x583871(0x1b0)]));var _0x3fb612=_0x998112[_0x10662e][_0x583871(0x1e0)],_0x5add80=parseInt(_0x1f8bcd['length'])+parseInt(_0x27f583[_0x583871(0x1c2)]),_0x55edb6=parseInt(TotalOfficeDays)-parseInt(_0x5add80);_0x55edb6<0x0&&(_0x55edb6=0x0);}var _0x394c57=Math[_0x583871(0x195)](parseInt(_0x5add80)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x394c57='-'),EmpAttendanceData[_0x583871(0x1eb)]({'UserId':_0x177d0a,'EmpName':_0x466f48,'AttendanceDate':_0x2c1743,'AttendanceType':_0x402364,'AttendanceItemId':_0x1ccf11,'EmpWorkHours':_0x2ac364,'HrAction':_0x3fb612,'AttendancDays':_0x1f8bcd['length'],'LeavesDay':_0x27f583['length'],'NotActionDays':_0x55edb6,'percentage':_0x394c57});}}}}}},'error':function(_0x31f15f,_0x23136e,_0x5c0283){}}),dfds[_0x42b2e0(0x203)]();}function OpenMyCustomLoader(){var _0x4290db=a0_0x5d04dd,_0x4cb079='Loading...',_0x3a4af8='<br\x20/>Please\x20wait!!',_0x2fd29f=0xc8,_0x238b18=0x190;currentDlg=SP['UI'][_0x4290db(0x219)][_0x4290db(0x1f1)](_0x4cb079,_0x3a4af8,_0x2fd29f,_0x238b18);}function CloseMyCustomLoader(){var _0x520f35=a0_0x5d04dd;currentDlg[_0x520f35(0x230)]();}function EmployeeListDat(_0x236611){var _0x561d3e=a0_0x5d04dd;$[_0x561d3e(0x201)]({'url':_0x236611,'headers':{'Accept':_0x561d3e(0x223)},'async':![],'success':function(_0x48e564){var _0x332827=_0x561d3e,_0x1c37d0=_0x48e564['d'][_0x332827(0x1e5)];$(_0x332827(0x1bb))['empty']();var _0x30b410='';if(_0x1c37d0[_0x332827(0x1c2)]>0x0){var _0x2386df=0x0,_0x49624f=0x0,_0x28bb7c=0x0;for(var _0x415a8f=0x0;_0x415a8f<_0x1c37d0['length'];_0x415a8f++){var _0x1feecd=_0x1c37d0[_0x415a8f]['ID'],_0x2b0490=_0x1c37d0[_0x415a8f][_0x332827(0x209)]['ID'],_0x17fb86=_0x1c37d0[_0x415a8f][_0x332827(0x209)][_0x332827(0x180)],_0x10a9ae=_0x1c37d0[_0x415a8f][_0x332827(0x193)],_0x55bef4=_0x1c37d0[_0x415a8f][_0x332827(0x1a5)]['DepartmentName'],_0x43a97b=_0x1c37d0[_0x415a8f][_0x332827(0x226)][_0x332827(0x180)];_0x43a97b==undefined&&(_0x43a97b='');var _0xedf220=_0x332827(0x18c),_0x3d4569='',_0x562090='black';_0x10a9ae==null&&(_0x10a9ae='');var _0x469e36=_0x1c37d0[_0x415a8f][_0x332827(0x183)]['OfficeName'];_0x469e36==null&&(_0x469e36='');EmployeeId=_0x1c37d0[_0x415a8f][_0x332827(0x209)]['ID'];var _0x499112=moment($(_0x332827(0x1f7))[_0x332827(0x1ff)](),_0x332827(0x207))[_0x332827(0x1b2)](_0x332827(0x20d)),_0x1e708a=moment($(_0x332827(0x205))[_0x332827(0x1ff)](),'DD/MM/YYYY')['format'](_0x332827(0x20d)),_0x499112=_0x499112[_0x332827(0x1ce)]('-')[_0x332827(0x199)](''),_0x1e708a=_0x1e708a[_0x332827(0x1ce)]('-')[_0x332827(0x199)](''),_0x3469c8=_spPageContextInfo['webServerRelativeUrl']+_0x332827(0x216)+_0x2b0490+_0x332827(0x21d)+_0x499112+_0x332827(0x176)+_0x1e708a+_0x332827(0x1c7)+titanForWork['getQueryStringParameter'](_0x332827(0x197))+_0x332827(0x189),_0x1e00f2=EmpAttendanceData[_0x332827(0x1ee)](function(_0x3b015e){var _0x2e56aa=_0x332827;return _0x3b015e[_0x2e56aa(0x1ba)];})[_0x332827(0x172)](EmployeeId);if(_0x1e00f2!=-0x1){var _0x4d5851=EmpAttendanceData[_0x1e00f2][_0x332827(0x1ba)],_0x291699=EmpAttendanceData[_0x1e00f2][_0x332827(0x1b4)],_0x531372=EmpAttendanceData[_0x1e00f2]['AttendanceItemId'];_0xedf220=EmpAttendanceData[_0x1e00f2][_0x332827(0x20c)];var _0x5c51d5=EmpAttendanceData[_0x1e00f2][_0x332827(0x20c)];_0x3d4569=EmpAttendanceData[_0x1e00f2][_0x332827(0x18d)];var _0x3671ed=EmpAttendanceData[_0x1e00f2]['AttendancDays'],_0x413ee4=EmpAttendanceData[_0x1e00f2][_0x332827(0x17e)],_0x3fa94e=EmpAttendanceData[_0x1e00f2]['NotActionDays'],_0x32ca42=EmpAttendanceData[_0x1e00f2]['percentage'],_0x1c3030='';EmpAttendanceData[_0x1e00f2][_0x332827(0x1e0)]==!![]?_0x1c3030=_0x332827(0x22a):_0x1c3030='',_0xedf220==null&&(_0xedf220=_0x332827(0x18c)),_0x291699=='On\x20Leave'&&(_0x562090=_0x332827(0x1f0),_0x28bb7c++),_0x291699==_0x332827(0x1fa)&&(_0x562090=_0x332827(0x235)),_0x30b410+=_0x332827(0x16e),_0x30b410+=_0x332827(0x1a2)+_0x17fb86+_0x332827(0x1c6),_0x30b410+=_0x332827(0x1a2)+_0x10a9ae+'</div></td>',_0x30b410+=_0x332827(0x1fd)+_0x55bef4+_0x332827(0x1c6),_0x30b410+=_0x332827(0x1a2)+_0x43a97b+_0x332827(0x1c6),_0x30b410+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x3671ed+_0x332827(0x1c6),_0x30b410+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x3fa94e+'</div></td>',_0x30b410+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x413ee4+'</div></td>',_0x30b410+=_0x332827(0x1fd)+ConvertHHMM(_0xedf220)+'</div></td>',_0x30b410+=_0x332827(0x1fd)+_0x32ca42+_0x332827(0x1c6),_0x30b410+=_0x332827(0x1d2)+_0x3469c8+_0x332827(0x210),_0x30b410+=_0x332827(0x192);}else _0x30b410+='<tr\x20class=\x27text-center\x27>',_0x30b410+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x17fb86+_0x332827(0x1c6),_0x30b410+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x10a9ae+_0x332827(0x1c6),_0x30b410+=_0x332827(0x1fd)+_0x55bef4+_0x332827(0x1c6),_0x30b410+=_0x332827(0x1a2)+_0x43a97b+'</div></td>',_0x30b410+=_0x332827(0x224),_0x30b410+=_0x332827(0x1fd)+TotalOfficeDays+'</div></td>',_0x30b410+=_0x332827(0x224),_0x30b410+=_0x332827(0x19f),_0x30b410+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>-</div></td>',_0x30b410+=_0x332827(0x1d2)+_0x3469c8+_0x332827(0x210),_0x30b410+=_0x332827(0x192);}}else{}_0x1c37d0[_0x332827(0x1c2)]==0x0?$(_0x332827(0x17f))[_0x332827(0x185)]():$(_0x332827(0x17f))[_0x332827(0x1e8)]();$(_0x332827(0x1bb))[_0x332827(0x1e2)](_0x30b410);var _0x476a42=$('#ReportTableData>tbody\x20>tr')[_0x332827(0x1c2)];$('#TotalItemscount')[_0x332827(0x1ea)](_0x476a42),$(_0x332827(0x213))[_0x332827(0x1ea)](_0x476a42),_0x476a42>0x0&&ReportTableConfiguration();},'error':function(_0x39607d){var _0x56501c=_0x561d3e;console[_0x56501c(0x182)](_0x39607d);}});}function ReportTableConfiguration(){var _0x43df6f=a0_0x5d04dd;sorter=new TINY['table'][(_0x43df6f(0x22f))](_0x43df6f(0x22f),_0x43df6f(0x1d5),{'ascclass':_0x43df6f(0x1e9),'descclass':_0x43df6f(0x18e),'evenclass':_0x43df6f(0x1e7),'oddclass':_0x43df6f(0x1a8),'evenselclass':_0x43df6f(0x1ad),'oddselclass':_0x43df6f(0x1c0),'paginate':!![],'size':0xa,'colddid':_0x43df6f(0x1dd),'currentid':_0x43df6f(0x1ae),'totalid':_0x43df6f(0x1b6),'startingrecid':'Repstartrecord','endingrecid':_0x43df6f(0x22c),'totalrecid':_0x43df6f(0x194),'hoverid':_0x43df6f(0x228),'pageddid':_0x43df6f(0x21f),'navid':_0x43df6f(0x231),'sortdir':0x1,'init':!![]});}function ConvertHHMM(_0x5eedcd){var _0x5b0f47=a0_0x5d04dd,_0xbd9d3=Math[_0x5b0f47(0x1f8)](_0x5eedcd/0x3c),_0x301a8a=_0x5eedcd%0x3c;_0xbd9d3<0xa&&(_0xbd9d3='0'+_0xbd9d3);_0x301a8a<0xa&&(_0x301a8a='0'+_0x301a8a);var _0x4df05a=_0xbd9d3+':'+_0x301a8a;return _0x4df05a;}function CloseModel(){initializePeoplePicker('Manager'),initializePeoplePicker('Employee');}var tableToExcel=(function(){var _0x510136=a0_0x5d04dd,_0x3bbe63=_0x510136(0x177),_0x19119f=_0x510136(0x1db),_0x338380=function(_0x1147b3){var _0x45371f=_0x510136;return window[_0x45371f(0x1c9)](unescape(encodeURIComponent(_0x1147b3)));},_0x41eece=function(_0x5d982c,_0x302ead){var _0xc2207=_0x510136;return _0x5d982c[_0xc2207(0x1b5)](/{(\w+)}/g,function(_0x7f8315,_0x559fc3){return _0x302ead[_0x559fc3];});};return function(_0x5159d0,_0x478e63){var _0x164d17=_0x510136;if(!_0x5159d0[_0x164d17(0x184)])_0x5159d0=document[_0x164d17(0x227)](_0x5159d0);var _0x14b54f={'worksheet':_0x478e63||_0x164d17(0x1da),'table':_0x5159d0['innerHTML']};window[_0x164d17(0x1b9)][_0x164d17(0x220)]=_0x3bbe63+_0x338380(_0x41eece(_0x19119f,_0x14b54f));};}()),authentication=function(){var _0x484445=a0_0x5d04dd,_0x47b79d=_spPageContextInfo[_0x484445(0x18b)],_0x39ed76=_spPageContextInfo[_0x484445(0x211)]+_0x484445(0x238);$[_0x484445(0x201)]({'url':_0x39ed76,'async':![],'type':_0x484445(0x1e4),'headers':{'accept':_0x484445(0x217)},'success':function(_0x4b450f){var _0x1f1ce1=_0x484445;debugger;var _0x61f081=_0x4b450f['d'][_0x1f1ce1(0x1e5)];if(_0x61f081[_0x1f1ce1(0x1c2)]>0x0)for(var _0x4627fd=0x0;_0x4627fd<_0x61f081['length'];_0x4627fd++){if(_0x61f081[_0x4627fd][_0x1f1ce1(0x180)]=='Attendance\x20Entry'){if(_0x61f081[_0x4627fd][_0x1f1ce1(0x1d6)]==![])return alert(_0x1f1ce1(0x20a)),window[_0x1f1ce1(0x1b9)]=_spPageContextInfo[_0x1f1ce1(0x211)]+_0x1f1ce1(0x196),![];}}},'error':function(_0x46cc31){alert(JSON['stringify'](_0x46cc31));}});};