var a0_0x51edfa=a0_0x2406;(function(_0x2c9ea7,_0x177bcb){var _0x5e5f7c=a0_0x2406,_0x5936f8=_0x2c9ea7();while(!![]){try{var _0x509f58=-parseInt(_0x5e5f7c(0x1e4))/0x1*(parseInt(_0x5e5f7c(0x23d))/0x2)+-parseInt(_0x5e5f7c(0x1bd))/0x3+parseInt(_0x5e5f7c(0x1dd))/0x4+-parseInt(_0x5e5f7c(0x17d))/0x5*(parseInt(_0x5e5f7c(0x1c4))/0x6)+parseInt(_0x5e5f7c(0x1ae))/0x7+parseInt(_0x5e5f7c(0x1bc))/0x8+parseInt(_0x5e5f7c(0x180))/0x9;if(_0x509f58===_0x177bcb)break;else _0x5936f8['push'](_0x5936f8['shift']());}catch(_0x3f9442){_0x5936f8['push'](_0x5936f8['shift']());}}}(a0_0x2ffd,0x8a64e));var Totaldays=0x0,CompanyID='',GstartDate='',GEmpID=0x0;$(document)[a0_0x51edfa(0x225)](function(){var _0x1500e5=a0_0x51edfa;ValidateHrAdmin(),CompanyID=titanForWork[_0x1500e5(0x238)](_0x1500e5(0x1f1));var _0x50f7e8=$[_0x1500e5(0x21d)](_0x1500e5(0x231)),_0x3dfaab=$['urlParam'](_0x1500e5(0x1fc)),_0x74bd58=$[_0x1500e5(0x21d)](_0x1500e5(0x187));if(_0x50f7e8!=null){GEmpID=_0x50f7e8;var _0x286028=_0x3dfaab['slice'](0x0,0x4)+'-'+_0x3dfaab[_0x1500e5(0x20d)](0x4,0x6)+'-'+_0x3dfaab[_0x1500e5(0x20d)](0x6,0x8),_0x5ca075=_0x74bd58[_0x1500e5(0x20d)](0x0,0x4)+'-'+_0x74bd58[_0x1500e5(0x20d)](0x4,0x6)+'-'+_0x74bd58[_0x1500e5(0x20d)](0x6,0x8),_0xafa658=new Date(_0x5ca075),_0x588732=_0xafa658['toISOString'](),_0x2f71a4=_0x588732[_0x1500e5(0x19a)]('T');GstartDate=_0x286028,$(_0x1500e5(0x1b9))['datepicker']({'dateFormat':'MM\x20dd,\x20yy'})[_0x1500e5(0x1a9)](_0x1500e5(0x174),new Date(_0x286028)),$(_0x1500e5(0x21b))['datepicker']({'dateFormat':_0x1500e5(0x17b)})[_0x1500e5(0x1a9)](_0x1500e5(0x174),new Date(_0x5ca075));var _0x5e1f9d=$('#EmpreportFrom')[_0x1500e5(0x1a9)]('getDate'),_0x8fe406=$(_0x1500e5(0x21b))[_0x1500e5(0x1a9)](_0x1500e5(0x178));days=(_0x8fe406-_0x5e1f9d)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x1500e5(0x22e)](days)+0x1,$(_0x1500e5(0x1f6))[_0x1500e5(0x19e)](formatDateReportEmp($(_0x1500e5(0x1b9))[_0x1500e5(0x1e2)]())),$(_0x1500e5(0x1ba))[_0x1500e5(0x19e)](formatDateReportEmp($(_0x1500e5(0x21b))[_0x1500e5(0x1e2)]()));var _0x55a3de=_spPageContextInfo[_0x1500e5(0x206)]+_0x1500e5(0x1f2)+_0x50f7e8+_0x1500e5(0x227)+CompanyID+'\x27';EmployeeListDat(_0x55a3de),LoadAllHolidays();var _0x5a8950=_spPageContextInfo[_0x1500e5(0x206)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x286028+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x2f71a4[0x0]+_0x1500e5(0x1e7)+_0x50f7e8+'\x27\x20';getFileData(_0x5a8950);var _0x55a3de=_spPageContextInfo[_0x1500e5(0x206)]+_0x1500e5(0x1f2)+_0x50f7e8+_0x1500e5(0x227)+CompanyID+'\x27';EmployeeListDat(_0x55a3de),LoadAllHolidays(),initializePeoplePicker(_0x1500e5(0x175));}});var EmployeeID='',ItemID='',SelectedDate='',TDID='';function attendanceEditModal(_0x54ad39,_0x3681bc,_0x706d70){var _0x598cee=a0_0x51edfa;EmployeeID=0x0,ItemID=0x0,SelectedDate='',TDID=_0x706d70,EmployeeID=_0x54ad39,ItemID=_0x3681bc;var _0x3cc3c2=_0x706d70['toString'](),_0x391c2a=_0x3cc3c2[_0x598cee(0x20d)](0x0,0x4)+'-'+_0x3cc3c2[_0x598cee(0x20d)](0x4,0x6)+'-'+_0x3cc3c2[_0x598cee(0x20d)](0x6,0x8),_0x2200f3=new Date(_0x391c2a);SelectedDate=_0x2200f3[_0x598cee(0x1d1)]()[_0x598cee(0x19a)]('T')[0x0];var _0x496a=formatDateReportEmp(_0x2200f3);$(_0x598cee(0x1ed))[_0x598cee(0x19e)](_0x496a),GetHolidays(_0x391c2a);}function UpdateAttendance(){var _0x5dce75=a0_0x51edfa;ItemID==0x0?(G_Validateholiday==!![]?confirm(_0x5dce75(0x1a4))&&PushNewAttendance():PushNewAttendance(),Applyfilter(),LoadAllHolidays()):(G_Validateholiday==!![]?confirm(_0x5dce75(0x1a4))&&ModifyAttendance():ModifyAttendance(),Applyfilter(),LoadAllHolidays());}function PushNewAttendance(){var _0x4e4073=a0_0x51edfa;$(_0x4e4073(0x1ec))[_0x4e4073(0x1e2)]()!=_0x4e4073(0x19c)||G_Validateholiday==!![]?$[_0x4e4073(0x17f)]({'url':_spPageContextInfo[_0x4e4073(0x206)]+_0x4e4073(0x1fd),'type':_0x4e4073(0x1ab),'async':![],'data':JSON[_0x4e4073(0x203)]({'__metadata':{'type':_0x4e4073(0x1a0)},'AttendanceDate':SelectedDate,'EmployeeId':EmployeeID,'AttendanceType':$(_0x4e4073(0x1ec))[_0x4e4073(0x1e2)]()}),'headers':{'Accept':_0x4e4073(0x191),'Content-Type':_0x4e4073(0x191),'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'X-HTTP-Method':_0x4e4073(0x1ab)},'success':function(_0x3cf84f,_0x174435,_0x391b9a){var _0x330e51=_0x4e4073;$(_0x330e51(0x21f)+TDID)[_0x330e51(0x19e)]($(_0x330e51(0x1ec))[_0x330e51(0x1e2)]()),alert(_0x330e51(0x224)),$('#attendance-reportEdit')[_0x330e51(0x188)](_0x330e51(0x200)),GetAttendanceorLeaves();},'error':function(_0x15212e,_0x1ae158,_0x4d1e7c){var _0x295a4e=_0x4e4073;alert(_0x295a4e(0x18e));}}):alert(_0x4e4073(0x207));}function ModifyAttendance(){var _0x76c394=a0_0x51edfa;$(_0x76c394(0x1ec))[_0x76c394(0x1e2)]()!=_0x76c394(0x19c)||G_Validateholiday==!![]?$[_0x76c394(0x17f)]({'url':_spPageContextInfo[_0x76c394(0x206)]+_0x76c394(0x1cc)+ItemID+')','type':_0x76c394(0x1ab),'async':![],'data':JSON[_0x76c394(0x203)]({'__metadata':{'type':_0x76c394(0x1a0)},'AttendanceType':$(_0x76c394(0x1ec))['val']()}),'headers':{'Accept':_0x76c394(0x191),'Content-Type':_0x76c394(0x191),'X-RequestDigest':$(_0x76c394(0x23c))[_0x76c394(0x1e2)](),'IF-MATCH':'*','X-HTTP-Method':_0x76c394(0x1b0)},'success':function(_0x611025,_0x1fabf0,_0x56c546){var _0x556ace=_0x76c394;$('#Att'+TDID)[_0x556ace(0x19e)]($(_0x556ace(0x1ec))['val']()),$(_0x556ace(0x1f5)+TDID)[_0x556ace(0x19e)]('00:00'),alert(_0x556ace(0x224)),$(_0x556ace(0x1a1))[_0x556ace(0x188)](_0x556ace(0x200)),GetAttendanceorLeaves();},'error':function(_0x188676,_0x48a02b,_0x372880){var _0x520844=_0x76c394;alert(_0x520844(0x18e));}}):alert(_0x76c394(0x207));}function initializePeoplePicker(_0x915777){var _0x235b3a=a0_0x51edfa,_0x4982b1={};_0x4982b1[_0x235b3a(0x1fe)]='User,DL,SecGroup,SPGroup',_0x4982b1['SearchPrincipalSource']=0xf,_0x4982b1['ResolvePrincipalSource']=0xf,_0x4982b1[_0x235b3a(0x20a)]=![],_0x4982b1[_0x235b3a(0x23e)]=0x32,_0x4982b1[_0x235b3a(0x1ad)]=_0x235b3a(0x184),this[_0x235b3a(0x1d3)](_0x915777,null,_0x4982b1);}function Applyfilter(){var _0xfc10ef=a0_0x51edfa,_0x419245=moment($(_0xfc10ef(0x1b9))[_0xfc10ef(0x1e2)](),'LL')[_0xfc10ef(0x239)]('DD\x20MMM\x20YYYY'),_0x235e42=moment($(_0xfc10ef(0x21b))[_0xfc10ef(0x1e2)](),'LL')[_0xfc10ef(0x239)](_0xfc10ef(0x1ff));if(Date['parse'](_0x419245)>Date[_0xfc10ef(0x221)](_0x235e42))alert('Invalid\x20date\x20range.\x0aFrom\x20Date\x20should\x20not\x20be\x20bigger\x20than\x20To\x20Date');else{$(_0xfc10ef(0x1e8))[_0xfc10ef(0x188)](_0xfc10ef(0x200));var _0x12ce94=$['urlParam'](_0xfc10ef(0x231)),_0x48f6d6=$(_0xfc10ef(0x1b9))[_0xfc10ef(0x1a9)](_0xfc10ef(0x178)),_0x182197=$(_0xfc10ef(0x21b))[_0xfc10ef(0x1a9)](_0xfc10ef(0x178));days=(_0x182197-_0x48f6d6)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0xfc10ef(0x22e)](days)+0x1,$('#StartDate')[_0xfc10ef(0x19e)](formatDateReportEmp($(_0xfc10ef(0x1b9))['val']())),$(_0xfc10ef(0x1ba))[_0xfc10ef(0x19e)](formatDateReportEmp($(_0xfc10ef(0x21b))[_0xfc10ef(0x1e2)]()));var _0x419245=moment($(_0xfc10ef(0x1b9))['val'](),'LL')[_0xfc10ef(0x239)](_0xfc10ef(0x1ee)),_0x235e42=moment($('#EmpreportTo')[_0xfc10ef(0x1e2)](),'LL')[_0xfc10ef(0x239)](_0xfc10ef(0x1ee)),_0x5bf265=new Date(_0x235e42),_0x4eb5af=_0x5bf265[_0xfc10ef(0x1d1)](),_0x2c3484=_0x4eb5af['split']('T');GstartDate=_0x419245;var _0x3dbe93=ensureUser($(_0xfc10ef(0x1d7))[_0xfc10ef(0x1b8)]()[_0xfc10ef(0x1b8)]()[_0xfc10ef(0x1ef)]('id'));if(_0x3dbe93==0x0){_0x12ce94=_0x12ce94,GEmpID=_0x12ce94;var _0x4f3467=_spPageContextInfo['webAbsoluteUrl']+_0xfc10ef(0x17c)+_0x419245+_0xfc10ef(0x1c1)+_0x2c3484[0x0]+_0xfc10ef(0x1e7)+_0x12ce94+'\x27\x20';getFileData(_0x4f3467);var _0xf32d19=_spPageContextInfo['webAbsoluteUrl']+_0xfc10ef(0x1f2)+_0x12ce94+_0xfc10ef(0x227)+CompanyID+'\x27';EmployeeListDat(_0xf32d19);}else{if(ISHRADMIN==!![]){_0x12ce94=_0x3dbe93,GEmpID=_0x3dbe93;var _0x4f3467=_spPageContextInfo[_0xfc10ef(0x206)]+_0xfc10ef(0x17c)+_0x419245+_0xfc10ef(0x1c1)+_0x2c3484[0x0]+_0xfc10ef(0x1e7)+_0x12ce94+'\x27\x20';getFileData(_0x4f3467);var _0xf32d19=_spPageContextInfo[_0xfc10ef(0x206)]+_0xfc10ef(0x1f2)+_0x12ce94+_0xfc10ef(0x227)+CompanyID+'\x27';EmployeeListDat(_0xf32d19);}else alert(_0xfc10ef(0x1e0));}LoadAllHolidays();}}var DataIdList=[],EmpAttendanceData=[],TotalLeavesorAbsent=[];function getFileData(_0x474951){var _0xc7f5d=a0_0x51edfa;jQuery[_0xc7f5d(0x17f)]({'url':_0x474951,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x363ee2){var _0x1fb17a=_0xc7f5d;EmpAttendanceData=[];var _0x3e4610=_0x363ee2['d']['results'];DataIdList=[];var _0x5ec173=[];TotalLeavesorAbsent=[];for(var _0x13365c=0x0;_0x13365c<_0x3e4610['length'];_0x13365c++){if(_0x3e4610[_0x13365c]['AttendanceType']!='On-Leave'&&_0x3e4610[_0x13365c][_0x1fb17a(0x194)]!='Holiday')_0x5ec173['push'](_0x3e4610[_0x13365c]['AttendanceType']);else{if(_0x3e4610[_0x13365c][_0x1fb17a(0x194)]==_0x1fb17a(0x19d))TotalLeavesorAbsent[_0x1fb17a(0x1a8)](_0x3e4610[_0x13365c]['AttendanceType']);else _0x3e4610[_0x13365c]['AttendanceType']=='Holiday'&&TotalLeavesorAbsent[_0x1fb17a(0x1a8)](_0x3e4610[_0x13365c][_0x1fb17a(0x194)]);}var _0x359e15=_0x3e4610[_0x13365c]['ID'],_0x3ee05d=_0x3e4610[_0x13365c][_0x1fb17a(0x22f)][_0x1fb17a(0x217)],_0x35921d=_0x3e4610[_0x13365c][_0x1fb17a(0x22f)]['ID'],_0x4317ed=formatDateReportEmp(_0x3e4610[_0x13365c][_0x1fb17a(0x1d6)]),_0x453046=_0x3e4610[_0x13365c][_0x1fb17a(0x194)],_0xab2e36=_0x3e4610[_0x13365c][_0x1fb17a(0x1ca)],_0x4e42db=_0x3e4610[_0x13365c][_0x1fb17a(0x192)];EmpAttendanceData[_0x1fb17a(0x1a8)]({'UserId':_0x35921d,'EmpName':_0x3ee05d,'AttendanceDate':_0x4317ed,'AttendanceType':_0x453046,'AttendanceItemId':_0x359e15,'EmpWorkHours':_0xab2e36,'HrAction':_0x4e42db});}var _0x1787a8='';$(_0x1fb17a(0x218))[_0x1fb17a(0x183)]();var _0x5539a9=0x0,_0x341940=0x0;for(var _0x2df526=0x0;_0x2df526<Totaldays;_0x2df526++){var _0x108239=new Date(GstartDate);_0x108239[_0x1fb17a(0x174)](_0x108239[_0x1fb17a(0x178)]()+_0x2df526);var _0x334f5d=moment(_0x108239,_0x1fb17a(0x205))[_0x1fb17a(0x239)]('YYYY-MM-DD'),_0x334f5d=_0x334f5d['split']('-')[_0x1fb17a(0x1cb)]('');DataIdList[_0x1fb17a(0x1a8)](_0x334f5d);var _0x4b56d3=formatDateReportEmp(_0x108239),_0x2a0b06=EmpAttendanceData[_0x1fb17a(0x1a3)](function(_0x106ba4){return _0x106ba4['AttendanceDate'];})['indexOf'](_0x4b56d3);if(_0x2a0b06!=-0x1){var _0xcb88d1=EmpAttendanceData[_0x2a0b06][_0x1fb17a(0x194)],_0x15fb61=EmpAttendanceData[_0x2a0b06][_0x1fb17a(0x1d0)],_0x4e42db=EmpAttendanceData[_0x2a0b06]['HrAction'],_0x4bcafe=EmpAttendanceData[_0x2a0b06][_0x1fb17a(0x17a)],_0x139660=EmpAttendanceData[_0x2a0b06][_0x1fb17a(0x1e9)],_0x3aaeb4=EmpAttendanceData[_0x2a0b06][_0x1fb17a(0x1d6)],_0x1a7a02=_0x1fb17a(0x1bf),_0x59b931=_0x1fb17a(0x204);_0x4e42db==!![]&&(_0x1a7a02=_0x1fb17a(0x204),_0x59b931=_0x1fb17a(0x1bf));if(_0xcb88d1!='On-Leave'&&_0xcb88d1!=_0x1fb17a(0x19c)){if(_0x15fb61==null)var _0x15732e=_0x1fb17a(0x20f)+_spPageContextInfo[_0x1fb17a(0x206)]+_0x1fb17a(0x222)+_0x334f5d+_0x1fb17a(0x1f0)+window[_0x1fb17a(0x1e5)](_0x1fb17a(0x1c2))+_0x1fb17a(0x201)+_0x334f5d+'\x27>Fill</span></a>';else var _0x15732e=_0x1fb17a(0x235)+_spPageContextInfo[_0x1fb17a(0x206)]+_0x1fb17a(0x222)+_0x334f5d+'&Mode='+window[_0x1fb17a(0x1e5)](_0x1fb17a(0x1c2))+'&sourcelocation=../Pages/Myworkplace.aspx\x27>'+ConvertHHMM(_0x15fb61)+_0x1fb17a(0x190);}else var _0x15732e='';var _0x2c8ec2=![],_0x5d9b24=Date['parse'](_0x3aaeb4['split'](',')[0x0]),_0x6b54a6=new Date(),_0x464da5=Date[_0x1fb17a(0x221)](moment(_0x6b54a6)['format'](_0x1fb17a(0x1ff)));_0x5d9b24>_0x464da5&&(_0x2c8ec2=!![]),_0x341940=_0x341940+0x1,_0x2c8ec2!=!![]?(_0x1787a8+='<tr\x20class=\x27text-center\x27\x20>',_0x1787a8+=_0x1fb17a(0x22a)+_0x334f5d+_0x1fb17a(0x236)+formatDateReportEmp(_0x108239)+_0x1fb17a(0x1de)+_0x334f5d+_0x1fb17a(0x1be),_0x1787a8+=_0x1fb17a(0x1e1)+_0x334f5d+'>'+_0xcb88d1+_0x1fb17a(0x229),_0x1787a8+=_0x1fb17a(0x212)+_0x334f5d+'>'+_0x15732e+_0x1fb17a(0x229),_0x1787a8+='<td><div\x20class=\x27checkbox\x20m-0\x27\x20style=\x27display:\x20'+_0x1a7a02+_0x1fb17a(0x232),_0x1787a8+='<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20'+_0x59b931+'\x20\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal('+GEmpID+','+_0x139660+','+_0x334f5d+_0x1fb17a(0x177),_0x1787a8+=_0x1fb17a(0x21e)):(_0x1787a8+='<tr\x20class=\x27text-center\x27\x20>',_0x1787a8+=_0x1fb17a(0x22a)+_0x334f5d+'><span>'+formatDateReportEmp(_0x108239)+_0x1fb17a(0x1de)+_0x334f5d+'\x27\x20class=\x27employee-report-holiday\x27></span></div></td>',_0x1787a8+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att'+_0x334f5d+'>'+_0xcb88d1+_0x1fb17a(0x1d4)+_0x139660+','+_0x334f5d+_0x1fb17a(0x242),_0x1787a8+=_0x1fb17a(0x212)+_0x334f5d+'>'+_0x15732e+_0x1fb17a(0x229),_0x1787a8+=_0x1fb17a(0x213)+_0x1a7a02+_0x1fb17a(0x232),_0x1787a8+=_0x1fb17a(0x210)+_0x59b931+_0x1fb17a(0x216),_0x1787a8+='</tr>');}else{var _0x24c46f=formatDateReportEmp(_0x108239),_0x2c8ec2=![],_0x5d9b24=Date[_0x1fb17a(0x221)](_0x24c46f['split'](',')[0x0]),_0x6b54a6=new Date(),_0x464da5=Date[_0x1fb17a(0x221)](moment(_0x6b54a6)[_0x1fb17a(0x239)](_0x1fb17a(0x1ff)));_0x5d9b24>_0x464da5&&(_0x2c8ec2=!![]);_0x5539a9=_0x5539a9+0x1;if(_0x2c8ec2!=!![]){var _0x53be54=_0x1fb17a(0x20f)+_spPageContextInfo['webAbsoluteUrl']+_0x1fb17a(0x222)+_0x334f5d+_0x1fb17a(0x1f0)+window['btoa'](_0x1fb17a(0x1c2))+_0x1fb17a(0x201)+_0x334f5d+_0x1fb17a(0x1e6);_0x1787a8+=_0x1fb17a(0x179),_0x1787a8+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id='+_0x334f5d+_0x1fb17a(0x236)+formatDateReportEmp(_0x108239)+_0x1fb17a(0x1de)+_0x334f5d+'\x27\x20class=\x27employee-report-holiday\x27></span></div></td>',_0x1787a8+=_0x1fb17a(0x1e1)+_0x334f5d+'></div></td>',_0x1787a8+=_0x1fb17a(0x212)+_0x334f5d+_0x1fb17a(0x241),_0x1787a8+=_0x1fb17a(0x23a),_0x1787a8+='<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal('+GEmpID+_0x1fb17a(0x223)+_0x334f5d+_0x1fb17a(0x177),_0x1787a8+=_0x1fb17a(0x21e);}else{var _0x53be54='<a\x20class=\x27LinkBtn\x27\x20href=\x27'+_spPageContextInfo[_0x1fb17a(0x206)]+_0x1fb17a(0x222)+_0x334f5d+'&Mode='+window[_0x1fb17a(0x1e5)](_0x1fb17a(0x1c2))+_0x1fb17a(0x201)+_0x334f5d+_0x1fb17a(0x1e6);_0x1787a8+='<tr\x20class=\x27text-center\x27\x20>',_0x1787a8+=_0x1fb17a(0x22a)+_0x334f5d+_0x1fb17a(0x236)+formatDateReportEmp(_0x108239)+_0x1fb17a(0x1de)+_0x334f5d+'\x27\x20class=\x27employee-report-holiday\x27></span></div></td>',_0x1787a8+=_0x1fb17a(0x1e1)+_0x334f5d+'></div></td>',_0x1787a8+=_0x1fb17a(0x212)+_0x334f5d+_0x1fb17a(0x241),_0x1787a8+=_0x1fb17a(0x23a),_0x1787a8+=_0x1fb17a(0x182),_0x1787a8+='</tr>';}}}var _0xc93964=$[_0x1fb17a(0x18a)](_0x3e4610,function(_0x252fc1){var _0x34d2c4=_0x1fb17a;return _0x252fc1[_0x34d2c4(0x194)]!=_0x34d2c4(0x19d)&&_0x252fc1[_0x34d2c4(0x194)]!=_0x34d2c4(0x19c);}),_0x51b4b3=parseInt(TotalLeavesorAbsent[_0x1fb17a(0x197)])+parseInt(_0x5539a9)-parseInt($(_0x1fb17a(0x176))[_0x1fb17a(0x19e)]());_0x51b4b3<0x0&&(_0x51b4b3=0x0);$(_0x1fb17a(0x228))['hide'](),$('#EmpTotalItemscount')[_0x1fb17a(0x19e)](Totaldays);var _0x1e544e=parseInt(_0x341940)-parseInt(TotalLeavesorAbsent[_0x1fb17a(0x197)]);$(_0x1fb17a(0x1f9))[_0x1fb17a(0x19e)](_0xc93964[_0x1fb17a(0x197)]),$('#EmpReportTable')[_0x1fb17a(0x1dc)](_0x1787a8),EmpTableConfiguration();},'error':function(_0x4ab4e1,_0x3b5b3c){var _0x4350fa=_0xc7f5d;console[_0x4350fa(0x1d9)](JSON[_0x4350fa(0x203)](_0x4ab4e1));}});}function WithdrawLeave(_0x245235,_0x413d13){var _0x49d9d3=a0_0x51edfa;confirm(_0x49d9d3(0x1e3))&&$[_0x49d9d3(0x17f)]({'url':_spPageContextInfo[_0x49d9d3(0x206)]+_0x49d9d3(0x1cc)+_0x245235+')','type':_0x49d9d3(0x1ab),'headers':{'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'IF-MATCH':'*','X-HTTP-Method':_0x49d9d3(0x1af)},'success':function(_0xcef0cb,_0x54696e,_0x53cc70){var _0x3c5d62=_0x49d9d3;$(_0x3c5d62(0x21f)+_0x413d13)['css'](_0x3c5d62(0x20b),_0x3c5d62(0x1bf)),alert(_0x3c5d62(0x1cf));},'error':function(_0x360e2f,_0x1baa37,_0x45248a){var _0x4c24fd=_0x49d9d3;$(_0x4c24fd(0x1b1))[_0x4c24fd(0x183)]()[_0x4c24fd(0x19e)](data['responseJSON'][_0x4c24fd(0x220)]);}});}function ConvertDateTimeFormat(_0x361fa6,_0x253cc7){var _0x5c50ca=a0_0x51edfa;return _0x361fa6[_0x5c50ca(0x19a)](_0x253cc7)[0x1]+''+_0x253cc7+''+_0x361fa6[_0x5c50ca(0x19a)](_0x253cc7)[0x0]+''+_0x253cc7+''+_0x361fa6[_0x5c50ca(0x19a)](_0x253cc7)[0x2];}var GEmployeeID=0x0,LocID=0x0;function EmployeeListDat(_0x4ec4f0){var _0x14f2a9=a0_0x51edfa;GEmployeeID=0x0,$[_0x14f2a9(0x17f)]({'url':_0x4ec4f0,'headers':{'Accept':_0x14f2a9(0x191)},'async':![],'success':function(_0x1480c9){var _0x38b6fa=_0x14f2a9,_0x140b6d=_0x1480c9['d'][_0x38b6fa(0x1c5)];_0x140b6d[_0x38b6fa(0x197)]>0x0?($(_0x38b6fa(0x1ea))['text'](_0x140b6d[0x0][_0x38b6fa(0x1ce)][_0x38b6fa(0x217)]),GEmployeeID=_0x140b6d[0x0][_0x38b6fa(0x1ce)]['ID'],$(_0x38b6fa(0x21c))[_0x38b6fa(0x19e)](_0x140b6d[0x0][_0x38b6fa(0x1ce)]['Title']),$(_0x38b6fa(0x19b))[_0x38b6fa(0x19e)](_0x140b6d[0x0]['OfficeLocation']['OfficeName']),$(_0x38b6fa(0x202))[_0x38b6fa(0x19e)](_0x140b6d[0x0][_0x38b6fa(0x1f3)]['OfficeName']),LocID=_0x140b6d[0x0][_0x38b6fa(0x1f3)]['ID']):($(_0x38b6fa(0x1ea))['text'](''),$(_0x38b6fa(0x19b))['text'](''),LocID=0x0);},'error':function(_0x2ce903){console['log'](_0x2ce903);}});}function EmpTableConfiguration(){var _0x54a31c=a0_0x51edfa;sorter=new TINY[(_0x54a31c(0x1df))]['sorter'](_0x54a31c(0x1b7),_0x54a31c(0x1c3),{'ascclass':_0x54a31c(0x1fa),'descclass':'desc','evenclass':_0x54a31c(0x1b6),'oddclass':_0x54a31c(0x219),'evenselclass':_0x54a31c(0x21a),'oddselclass':_0x54a31c(0x1a7),'paginate':!![],'size':0xa,'colddid':_0x54a31c(0x18f),'currentid':_0x54a31c(0x18d),'totalid':_0x54a31c(0x1f8),'startingrecid':_0x54a31c(0x1ac),'endingrecid':_0x54a31c(0x1a6),'totalrecid':'Emptotalrecords','hoverid':'selectedrow','pageddid':_0x54a31c(0x1c8),'navid':_0x54a31c(0x23f),'sortdir':0x1,'init':!![]});}$[a0_0x51edfa(0x21d)]=function(_0x2ee4a4){var _0x5dad08=a0_0x51edfa,_0x12c234=new RegExp('[?&]'+_0x2ee4a4+_0x5dad08(0x230))['exec'](window['location'][_0x5dad08(0x17e)]);if(_0x12c234==null)return null;return decodeURI(_0x12c234[0x1])||0x0;};function formatDateReportEmp(_0x436b6f){var _0x1a975f=a0_0x51edfa,_0xad16f=['Sunday',_0x1a975f(0x1f7),_0x1a975f(0x1d8),_0x1a975f(0x1b3),'Thursday',_0x1a975f(0x1c9),'Saturday'],_0x5ed536=new Date(_0x436b6f);if(isNaN(_0x5ed536[_0x1a975f(0x1c7)]()))return _0x436b6f;else{var _0x51b663=new Array();return _0x51b663[0x0]='Jan',_0x51b663[0x1]=_0x1a975f(0x1a2),_0x51b663[0x2]=_0x1a975f(0x1b5),_0x51b663[0x3]=_0x1a975f(0x196),_0x51b663[0x4]=_0x1a975f(0x1d2),_0x51b663[0x5]='Jun',_0x51b663[0x6]=_0x1a975f(0x215),_0x51b663[0x7]=_0x1a975f(0x199),_0x51b663[0x8]=_0x1a975f(0x240),_0x51b663[0x9]=_0x1a975f(0x233),_0x51b663[0xa]='Nov',_0x51b663[0xb]=_0x1a975f(0x1a5),day=_0x5ed536[_0x1a975f(0x178)](),day<0xa&&(day='0'+day),day+'\x20'+_0x51b663[_0x5ed536['getMonth']()]+'\x20'+_0x5ed536[_0x1a975f(0x234)]()+',\x20'+_0xad16f[_0x5ed536[_0x1a975f(0x209)]()];}}function ConvertHHMM(_0x4307c2){if(_0x4307c2!=null){var _0x449fc4=Math['floor'](_0x4307c2/0x3c),_0x34f777=_0x4307c2%0x3c;_0x449fc4<0xa&&(_0x449fc4='0'+_0x449fc4);_0x34f777<0xa&&(_0x34f777='0'+_0x34f777);var _0x21df1c=_0x449fc4+':'+_0x34f777;}else var _0x21df1c='';return _0x21df1c;}function a0_0x2ffd(){var _0xcc28e8=['btoa','\x27>Fill</span></a>','\x27\x20and\x20Employee\x20eq\x20\x27','#attendance-report-filter','AttendanceItemId','#EmpName','\x27&$top=200&$orderby=Holiday_start\x20asc','#AttendanceDDL','#SelDate','YYYY-MM-DD','attr','&Mode=','CompanyId','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27','OfficeLocation','#FdateTH','#Timeview','#StartDate','Monday','Emptotalpages','#Total-Attendance','asc','\x27\x20and\x20ContributorsId\x20eq\x20\x27','start','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items','PrincipalAccountType','DD\x20MMM\x20YYYY','hide','&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview','#officeLocTH','stringify','block','DD/MM/YYYY','webAbsoluteUrl','Plese\x20select\x20proper\x20attandence.','Key','getDay','AllowMultipleValues','display','/_api/web/lists/getbytitle(\x27','slice','<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>','<a\x20class=\x27LinkBtn\x27\x20href=\x27','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20','\x27\x20and\x20CompanyID\x20eq\x20\x27','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time','<td><div\x20class=\x27checkbox\x20m-0\x27\x20style=\x27display:\x20','\x27\x20and\x20Holiday_start\x20le\x20\x27','Jul','\x20\x27></div></td>','Title','#EmpReportTable','oddrow','evenselected','#EmpreportTo','#EmpTitle','urlParam','</tr>','#Att','error','parse','/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall=',',0,','Data\x20has\x20been\x20saved.','ready','color','\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','.NoRecordFound','</div></td>','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=','#Workingdays','#Total-Leave-Absent','\x20,\x20','round','Employee','=([^&#]*)','EID','\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>','Oct','getFullYear','<a\x20href=\x27','><span>','nodeType','getQueryStringParameter','format','<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>','#HolidayMessage','#__REQUESTDIGEST','206HupGKh','MaximumEntitySuggestions','tablenav','Sept','></div></td>',')\x27>Withdraw</a></div></td>','setDate','EmployeeName','#HoliaysTotal',')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>','getDate','<tr\x20class=\x27text-center\x27\x20>','UserId','MM\x20dd,\x20yy','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','3741820vAqjcP','href','ajax','10262502YPHTjk','SPClientPeoplePickerDict','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27></div></td>','empty','280px','#EmpRow','#HolidaysTH','end','modal','getElementById','grep','#HolidayMessagediv','\x27\x20and\x20Holiday_start\x20ge\x20\x27','Empcurrentpage','Error!\x20Something\x20went\x20wrong.','columns','</a>','application/json;odata=verbose','HrAction','getMonth','AttendanceType','/_api/web/ensureuser','Apr','length','data:application/vnd.ms-excel;base64,','Aug','split','#OfficeLoc','Holiday','On-Leave','text','On-LeaveWithdraw','SP.Data.EmpAttendanceListItem','#attendance-reportEdit','Feb','map','This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.','Dec','Empendrecord','oddselected','push','datepicker','replace','POST','Empstartrecord','Width','1975288xcoiFL','DELETE','MERGE','#ResultDiv','\x27)and\x20Holiday_start\x20eq\x20\x27','Wednesday','An\x20error\x20occurred.\x20Please\x20try\x20again.','Mar','evenrow','sorter','children','#EmpreportFrom','#EndDate','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','1590096VsHEGm','778089krrMnc','\x27\x20class=\x27employee-report-holiday\x27></span></div></td>','none','innerHTML','\x27\x20and\x20AttendanceDate\x20le\x20\x27','View','EmpReportTableData','6OqRomm','results','responseJSON','getTime','Emppagedropdown','Friday','WorkHours','join','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items(','SPClientPeoplePicker','LogonName','Leave\x20withdrawal\x20Successfully\x20Completed.','EmpWorkHours','toISOString','May','SPClientPeoplePicker_InitStandaloneControlWrapper','<a\x20href=\x27#\x27\x20class=\x27Withdraw-Leave-link\x27\x20onclick=\x27WithdrawLeave(','#EdateTH','AttendanceDate','#EmployeeName','Tuesday','log','css','Holiday_start','append','797316CcwnbU','</span><span\x20id=\x27H','table','Unauthorized\x20access!','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att','val','Are\x20you\x20sure\x20to\x20withdraw\x20the\x20Leave?','2388ZUCWXP'];a0_0x2ffd=function(){return _0xcc28e8;};return a0_0x2ffd();}var AttandenceOnHolidays=0x0,HolidaysListDTL=[];function LoadAllHolidays(){var _0x27269a=a0_0x51edfa;TotalOfficeDays=0x0,HolidaysListDTL=[];var _0x113360=new Date($(_0x27269a(0x1b9))[_0x27269a(0x1e2)]()),_0x287d25=_0x113360['getFullYear']()+'-'+(_0x113360[_0x27269a(0x193)]()+0x1)+'-'+_0x113360[_0x27269a(0x178)](),_0x21f7d5=new Date($(_0x27269a(0x21b))['val']()),_0x497e70=_0x21f7d5[_0x27269a(0x234)]()+'-'+(_0x21f7d5['getMonth']()+0x1)+'-'+_0x21f7d5[_0x27269a(0x178)](),_0x197434=_spPageContextInfo[_0x27269a(0x206)]+_0x27269a(0x1bb)+LocID+'\x27\x20and\x20CompanyID\x20eq\x20\x27'+CompanyID+_0x27269a(0x18c)+_0x287d25+_0x27269a(0x214)+_0x497e70+'\x27';$[_0x27269a(0x17f)]({'url':_0x197434,'headers':{'Accept':_0x27269a(0x191)},'async':![],'success':function(_0x1746a1){var _0x2fe6ea=_0x27269a,_0x5333c0=_0x1746a1['d']['results'][_0x2fe6ea(0x197)],_0x18c1e2=0x0;for(var _0x787277=0x0;_0x787277<_0x5333c0;_0x787277++){var _0x3b354b=new Date(_0x1746a1['d'][_0x2fe6ea(0x1c5)][_0x787277][_0x2fe6ea(0x1db)]),_0x23f0cf=moment(_0x3b354b,_0x2fe6ea(0x205))[_0x2fe6ea(0x239)](_0x2fe6ea(0x1ee)),_0x23f0cf=_0x23f0cf['split']('-')[_0x2fe6ea(0x1cb)](''),_0x4d886d=_0x1746a1['d'][_0x2fe6ea(0x1c5)][_0x787277]['Title'];HolidaysListDTL[_0x2fe6ea(0x1a8)]({'Hdate':_0x23f0cf,'Title':_0x4d886d}),$('#'+_0x23f0cf)[_0x2fe6ea(0x1da)](_0x2fe6ea(0x226),'red'),$('#H'+_0x23f0cf)[_0x2fe6ea(0x19e)](_0x2fe6ea(0x22d)+_0x4d886d),$(_0x2fe6ea(0x21f)+_0x23f0cf)[_0x2fe6ea(0x19e)]()!=''&&(_0x18c1e2=_0x18c1e2+0x1);}AttandenceOnHolidays=0x0;for(var _0x5114bb=0x0;_0x5114bb<HolidaysListDTL[_0x2fe6ea(0x197)];_0x5114bb++){var _0x50bffb=$('#Att'+HolidaysListDTL[_0x5114bb]['Hdate'])[_0x2fe6ea(0x19e)]();_0x50bffb!=''&&_0x50bffb!=_0x2fe6ea(0x19d)&&_0x50bffb!=_0x2fe6ea(0x19c)&&(AttandenceOnHolidays=AttandenceOnHolidays+0x1);}var _0x35bf07=0x0,_0x42021f=0x0,_0x584535=0x0;for(var _0x2c5de9=0x0;_0x2c5de9<DataIdList[_0x2fe6ea(0x197)];_0x2c5de9++){var _0x2fa906=$(_0x2fe6ea(0x21f)+DataIdList[_0x2c5de9])[_0x2fe6ea(0x19e)]();_0x2fa906==_0x2fe6ea(0x19f)&&(_0x2fa906=_0x2fa906[_0x2fe6ea(0x19a)]('Withdraw')[0x0]),(_0x2fa906==''||_0x2fa906==_0x2fe6ea(0x19d))&&(_0x42021f=_0x42021f+0x1),_0x2fa906==_0x2fe6ea(0x19d)&&(_0x584535=_0x584535+0x1),_0x2fa906=='Holiday'&&(_0x35bf07=_0x35bf07+0x1);}var _0x42bf9f=_0x42021f+AttandenceOnHolidays-(_0x5333c0-_0x35bf07);_0x42bf9f<0x0&&(_0x42bf9f=0x0),_0x42bf9f!='0'?$(_0x2fe6ea(0x22c))[_0x2fe6ea(0x19e)](_0x42bf9f):_0x584535>0x0&&$(_0x2fe6ea(0x22c))[_0x2fe6ea(0x19e)](_0x584535),$('#HoliaysTotal')[_0x2fe6ea(0x19e)](_0x5333c0),$(_0x2fe6ea(0x22b))['text'](parseInt(Totaldays)-parseInt(_0x5333c0)),$(_0x2fe6ea(0x1f4))[_0x2fe6ea(0x19e)](formatDateReportEmp(ConvertDateTimeFormat($(_0x2fe6ea(0x1b9))[_0x2fe6ea(0x1e2)](),'/'))),$(_0x2fe6ea(0x1d5))[_0x2fe6ea(0x19e)](formatDateReportEmp(ConvertDateTimeFormat($(_0x2fe6ea(0x21b))['val'](),'/'))),$('#TotalWorkdayTH')['text'](parseInt(Totaldays)-parseInt(_0x5333c0)),$(_0x2fe6ea(0x186))[_0x2fe6ea(0x19e)](_0x5333c0);},'myError':function(_0x408f23){}});}function ensureUser(_0x2b7a4b){var _0x1af969=a0_0x51edfa,_0x3bbd4b=0x0,_0x2491ab=_0x2b7a4b,_0x5ea8a7=this[_0x1af969(0x1cd)][_0x1af969(0x181)][_0x2491ab],_0x4d51c8=_0x5ea8a7['GetAllUserInfo'](),_0x19d102=_0x4d51c8[0x0];if(_0x19d102){var _0x5885a3={'logonName':_0x19d102[_0x1af969(0x208)]};$['ajax']({'url':_spPageContextInfo[_0x1af969(0x206)]+_0x1af969(0x195),'type':_0x1af969(0x1ab),'async':![],'contentType':'application/json;odata=verbose','data':JSON[_0x1af969(0x203)](_0x5885a3),'headers':{'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'accept':'application/json;odata=verbose'},'success':function(_0x6659de,_0x3d1c57,_0x52e0f3){_0x3bbd4b=_0x6659de['d']['Id'];},'error':function(_0x277023,_0x32f8d3,_0x3d3e21){}});}else _0x3bbd4b=0x0;return _0x3bbd4b;}var tableToExcel=(function(){var _0x509e7e=a0_0x51edfa,_0x22156e=_0x509e7e(0x198),_0x43e51e=_0x509e7e(0x20e),_0x34cf2d=function(_0x265f44){var _0x41cef7=_0x509e7e;return window[_0x41cef7(0x1e5)](unescape(encodeURIComponent(_0x265f44)));},_0x16a88a=function(_0x1854dd,_0xa987b5){var _0x1dea95=_0x509e7e;return _0x1854dd[_0x1dea95(0x1aa)](/{(\w+)}/g,function(_0x3273fe,_0xcd5a10){return _0xa987b5[_0xcd5a10];});};return function(_0x26aea0,_0x4472aa){var _0x59e488=_0x509e7e;if(!_0x26aea0[_0x59e488(0x237)])_0x26aea0=document[_0x59e488(0x189)](_0x26aea0);var _0x27f9e0={'worksheet':_0x4472aa||'Worksheet','table':_0x26aea0[_0x59e488(0x1c0)]};window['location']['href']=_0x22156e+_0x34cf2d(_0x16a88a(_0x43e51e,_0x27f9e0));};}()),ISHRADMIN=![];function a0_0x2406(_0xd4df73,_0x4950ea){var _0x2ffd5e=a0_0x2ffd();return a0_0x2406=function(_0x2406b6,_0x2e294a){_0x2406b6=_0x2406b6-0x174;var _0x59358b=_0x2ffd5e[_0x2406b6];return _0x59358b;},a0_0x2406(_0xd4df73,_0x4950ea);}function ValidateHrAdmin(){var _0x4de9cf=a0_0x51edfa,_0x2c4562='ProcessApprovers',_0x263170=_spPageContextInfo['webAbsoluteUrl']+_0x4de9cf(0x20c)+_0x2c4562+'\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27'+titanForWork[_0x4de9cf(0x238)]('CompanyId')+_0x4de9cf(0x1fb)+_spPageContextInfo['userId']+'\x27\x20and\x20(WebPartName\x20eq\x20\x27HR\x20Admin\x27)';$[_0x4de9cf(0x17f)]({'url':_0x263170,'async':![],'type':'get','headers':{'Accept':_0x4de9cf(0x191)},'success':function(_0x4bb6b5){var _0x161d7f=_0x4de9cf,_0x133286=_0x4bb6b5['d'][_0x161d7f(0x1c5)];_0x133286[_0x161d7f(0x197)]>0x0?($(_0x161d7f(0x185))[_0x161d7f(0x1da)](_0x161d7f(0x20b),_0x161d7f(0x204)),ISHRADMIN=!![]):(ISHRADMIN=![],$(_0x161d7f(0x185))[_0x161d7f(0x200)]());},'error':function(_0x16aa64){var _0x3a1959=_0x4de9cf;console[_0x3a1959(0x1d9)](_0x16aa64[_0x3a1959(0x1c6)][_0x3a1959(0x220)]);}});}function GetAttendanceorLeaves(){var _0x489923=a0_0x51edfa,_0x3665db=$['urlParam'](_0x489923(0x231)),_0x5767eb=$(_0x489923(0x1b9))[_0x489923(0x1a9)]('getDate'),_0x12176c=$(_0x489923(0x21b))[_0x489923(0x1a9)](_0x489923(0x178));days=(_0x12176c-_0x5767eb)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x489923(0x22e)](days)+0x1,$('#StartDate')[_0x489923(0x19e)](formatDateReportEmp($(_0x489923(0x1b9))[_0x489923(0x1e2)]())),$(_0x489923(0x1ba))[_0x489923(0x19e)](formatDateReportEmp($(_0x489923(0x21b))[_0x489923(0x1e2)]()));var _0x13b60b=moment($('#EmpreportFrom')['val'](),'LL')[_0x489923(0x239)](_0x489923(0x1ee)),_0x30d036=moment($(_0x489923(0x21b))[_0x489923(0x1e2)](),'LL')[_0x489923(0x239)](_0x489923(0x1ee)),_0x2015f0=new Date(_0x30d036),_0x2ef6fd=_0x2015f0[_0x489923(0x1d1)](),_0x298b64=_0x2ef6fd[_0x489923(0x19a)]('T');GstartDate=_0x13b60b;var _0x2df09c=ensureUser($(_0x489923(0x1d7))[_0x489923(0x1b8)]()['children']()[_0x489923(0x1ef)]('id'));if(_0x2df09c==0x0){var _0x2d78c4=_spPageContextInfo[_0x489923(0x206)]+_0x489923(0x1f2)+_0x3665db+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x2d78c4),LoadAllHolidays(),_0x3665db=_0x3665db,GEmpID=_0x3665db;var _0x19093e=_spPageContextInfo['webAbsoluteUrl']+_0x489923(0x17c)+_0x13b60b+_0x489923(0x1c1)+_0x298b64+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x3665db+'\x27\x20';UpdateHeaderfields(_0x19093e);}else{if(ISHRADMIN==!![]){_0x3665db=_0x2df09c,GEmpID=_0x2df09c;var _0x2d78c4=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x3665db+_0x489923(0x227)+CompanyID+'\x27';EmployeeListDat(_0x2d78c4),LoadAllHolidays();var _0x19093e=_spPageContextInfo[_0x489923(0x206)]+_0x489923(0x17c)+_0x13b60b+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x298b64+_0x489923(0x1e7)+_0x3665db+'\x27\x20';UpdateHeaderfields(_0x19093e);var _0x2d78c4=_spPageContextInfo['webAbsoluteUrl']+_0x489923(0x1f2)+_0x3665db+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';}else alert(_0x489923(0x1e0));}LoadAllHolidays();}function GetFilterData(_0x3e1ee7){var _0x310367=a0_0x51edfa;jQuery['ajax']({'url':_0x3e1ee7,'headers':{'Accept':_0x310367(0x191)},'async':![],'success':function(_0x1f9802){var _0x5dba2d=_0x310367,_0x304120=_0x1f9802['d']['results'],_0x2d47b0=[];TotalLeavesorAbsent=[];for(var _0x24c2f2=0x0;_0x24c2f2<_0x304120[_0x5dba2d(0x197)];_0x24c2f2++){if(_0x304120[_0x24c2f2][_0x5dba2d(0x194)]!=_0x5dba2d(0x19d)&&_0x304120[_0x24c2f2][_0x5dba2d(0x194)]!=_0x5dba2d(0x19c))_0x2d47b0[_0x5dba2d(0x1a8)](_0x304120[_0x24c2f2]['AttendanceType']);else _0x304120[_0x24c2f2][_0x5dba2d(0x194)]=='On-Leave'&&TotalLeavesorAbsent[_0x5dba2d(0x1a8)](_0x304120[_0x24c2f2][_0x5dba2d(0x194)]);}var _0x4bf408=$[_0x5dba2d(0x18a)](_0x304120,function(_0x58f0f1){var _0x44e71e=_0x5dba2d;return _0x58f0f1['AttendanceType']!=_0x44e71e(0x19d)&&_0x58f0f1['AttendanceType']!='Holiday';});$(_0x5dba2d(0x1f9))[_0x5dba2d(0x19e)](_0x4bf408[_0x5dba2d(0x197)]);},'error':function(_0x5c56f8,_0x4ccaaf){var _0x4f153e=_0x310367;console[_0x4f153e(0x1d9)](JSON[_0x4f153e(0x203)](_0x5c56f8));}});}var G_Validateholiday=![];function GetHolidays(_0x5a3536){var _0x43f6bc=a0_0x51edfa,_0x250db5=_spPageContextInfo[_0x43f6bc(0x206)]+'/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?$filter=OfficeLocationID\x20eq\x20(\x27'+LocID+_0x43f6bc(0x1b2)+_0x5a3536+_0x43f6bc(0x211)+titanForWork[_0x43f6bc(0x238)](_0x43f6bc(0x1f1))+_0x43f6bc(0x1eb);$[_0x43f6bc(0x17f)]({'url':_0x250db5,'headers':{'Accept':_0x43f6bc(0x191)},'async':![],'success':function(_0x2d600a){var _0x10bfb2=_0x43f6bc,_0x35c78a=_0x2d600a['d'][_0x10bfb2(0x1c5)];_0x35c78a[_0x10bfb2(0x197)]>0x0?($(_0x10bfb2(0x18b))[_0x10bfb2(0x19e)](_0x35c78a[0x0][_0x10bfb2(0x217)]),$(_0x10bfb2(0x23b))[_0x10bfb2(0x1da)]('display',_0x10bfb2(0x204)),G_Validateholiday=!![]):($(_0x10bfb2(0x18b))['text'](''),$(_0x10bfb2(0x23b))['css']('display',_0x10bfb2(0x1bf)),G_Validateholiday=![]);},'error':function(_0x4caeae){var _0x7a44=_0x43f6bc;alert(_0x7a44(0x1b4));}});}var EmpAttendanceData=[],TotalLeavesorAbsent=[];function UpdateHeaderfields(_0x24c2e3){var _0x4ac98e=a0_0x51edfa;jQuery[_0x4ac98e(0x17f)]({'url':_0x24c2e3,'headers':{'Accept':_0x4ac98e(0x191)},'async':!![],'success':function(_0x148c30){var _0x465404=_0x4ac98e;EmpAttendanceData=[];var _0x34d949=_0x148c30['d'][_0x465404(0x1c5)],_0xf7728a=[];TotalLeavesorAbsent=[];for(var _0x69cf9=0x0;_0x69cf9<_0x34d949[_0x465404(0x197)];_0x69cf9++){if(_0x34d949[_0x69cf9][_0x465404(0x194)]!=_0x465404(0x19d)&&_0x34d949[_0x69cf9][_0x465404(0x194)]!=_0x465404(0x19c))_0xf7728a[_0x465404(0x1a8)](_0x34d949[_0x69cf9][_0x465404(0x194)]);else{if(_0x34d949[_0x69cf9][_0x465404(0x194)]==_0x465404(0x19d))TotalLeavesorAbsent[_0x465404(0x1a8)](_0x34d949[_0x69cf9]['AttendanceType']);else _0x34d949[_0x69cf9][_0x465404(0x194)]=='Holiday'&&TotalLeavesorAbsent[_0x465404(0x1a8)](_0x34d949[_0x69cf9][_0x465404(0x194)]);}var _0x155085=_0x34d949[_0x69cf9]['ID'],_0xc758f=_0x34d949[_0x69cf9][_0x465404(0x22f)][_0x465404(0x217)],_0x5c9d2e=_0x34d949[_0x69cf9]['Employee']['ID'],_0x50bbb3=formatDateReportEmp(_0x34d949[_0x69cf9][_0x465404(0x1d6)]),_0x1b929f=_0x34d949[_0x69cf9][_0x465404(0x194)],_0x38d68b=_0x34d949[_0x69cf9][_0x465404(0x1ca)],_0x5d8e9f=_0x34d949[_0x69cf9][_0x465404(0x192)];EmpAttendanceData[_0x465404(0x1a8)]({'UserId':_0x5c9d2e,'EmpName':_0xc758f,'AttendanceDate':_0x50bbb3,'AttendanceType':_0x1b929f,'AttendanceItemId':_0x155085,'EmpWorkHours':_0x38d68b,'HrAction':_0x5d8e9f});}var _0x2ed97d='',_0x1dfd80=0x0,_0x3a9758=0x0;for(var _0x29d944=0x0;_0x29d944<Totaldays;_0x29d944++){var _0x1d440b=new Date(GstartDate);_0x1d440b[_0x465404(0x174)](_0x1d440b['getDate']()+_0x29d944);var _0x488e5c=moment(_0x1d440b,_0x465404(0x205))['format'](_0x465404(0x1ee)),_0x488e5c=_0x488e5c[_0x465404(0x19a)]('-')[_0x465404(0x1cb)](''),_0x405dcd=formatDateReportEmp(_0x1d440b),_0x356198=EmpAttendanceData[_0x465404(0x1a3)](function(_0x27e0fc){var _0x8bcc2d=_0x465404;return _0x27e0fc[_0x8bcc2d(0x1d6)];})['indexOf'](_0x405dcd);if(_0x356198!=-0x1){var _0x5d6108=EmpAttendanceData[_0x356198][_0x465404(0x194)],_0x543098=EmpAttendanceData[_0x356198][_0x465404(0x1d0)],_0x5d8e9f=EmpAttendanceData[_0x356198]['HrAction'],_0xf32a53=EmpAttendanceData[_0x356198][_0x465404(0x17a)],_0x4989a8=EmpAttendanceData[_0x356198]['AttendanceItemId'];_0x3a9758=_0x3a9758+0x1;}else _0x1dfd80=_0x1dfd80+0x1;}var _0x4c05ba=parseInt(TotalLeavesorAbsent['length'])+parseInt(_0x1dfd80)-parseInt($('#HoliaysTotal')['text']());_0x4c05ba<0x0&&(_0x4c05ba=0x0);$('#EmpTotalItemscount')['text'](Totaldays);var _0x33519f=parseInt(_0x3a9758)-parseInt(TotalLeavesorAbsent[_0x465404(0x197)]),_0x1915a8=$[_0x465404(0x18a)](_0x34d949,function(_0x2d50cc){var _0xefaa0=_0x465404;return _0x2d50cc['AttendanceType']!='On-Leave'&&_0x2d50cc[_0xefaa0(0x194)]!='Holiday';});$(_0x465404(0x1f9))[_0x465404(0x19e)](_0x1915a8[_0x465404(0x197)]);},'error':function(_0x2eefc0,_0x3e7522){var _0x417963=_0x4ac98e;console[_0x417963(0x1d9)](JSON['stringify'](_0x2eefc0));}});}