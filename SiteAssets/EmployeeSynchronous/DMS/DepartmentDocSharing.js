var a0_0xee81c7=a0_0x5039;(function(_0x23188f,_0x2b1531){var _0x11bbce=a0_0x5039,_0x4a6e81=_0x23188f();while(!![]){try{var _0x3b2e8d=parseInt(_0x11bbce(0x1f4))/0x1*(-parseInt(_0x11bbce(0x1a7))/0x2)+parseInt(_0x11bbce(0x1db))/0x3*(parseInt(_0x11bbce(0x19f))/0x4)+parseInt(_0x11bbce(0x1b4))/0x5*(-parseInt(_0x11bbce(0x18c))/0x6)+-parseInt(_0x11bbce(0x23b))/0x7+-parseInt(_0x11bbce(0x233))/0x8*(parseInt(_0x11bbce(0x19a))/0x9)+-parseInt(_0x11bbce(0x1ee))/0xa+parseInt(_0x11bbce(0x1df))/0xb;if(_0x3b2e8d===_0x2b1531)break;else _0x4a6e81['push'](_0x4a6e81['shift']());}catch(_0x5de42e){_0x4a6e81['push'](_0x4a6e81['shift']());}}}(a0_0x3d0a,0x5739c));var currentFileSiteURL='',mydeptSiteUrl='',currentDlgShare='';$(document)[a0_0xee81c7(0x1d8)](function(){var _0x242a1e=a0_0xee81c7;getDeptSiteUrl(),$(_0x242a1e(0x194))[_0x242a1e(0x1da)](function(){OpenSharePopup();}),$('#Deptmutiplesharefile')[_0x242a1e(0x1da)](function(){var _0x1cced3=_0x242a1e,_0x4a54d2=_0x1cced3(0x1ae),_0x1538bc=_0x1cced3(0x1f2),_0x5aa485=0xc8,_0x53763d=0x190;SP[_0x1cced3(0x1b8)][_0x1cced3(0x220)]([_0x1cced3(0x1c5),_0x1cced3(0x1d2)],function(){var _0x5cb6d0=_0x1cced3;currentDlgShare=SP['UI'][_0x5cb6d0(0x1b7)][_0x5cb6d0(0x19c)](_0x4a54d2,_0x1538bc,_0x5aa485,_0x53763d);}),setTimeout(function(){DeptSharemutiplefile();},0x64);}),$('#sharingTypeDeptFolderPermissionLvl')[_0x242a1e(0x1c8)](function(){var _0x33eda7=_0x242a1e;clearPeoplePickerControl('customSharingDeptFolderPplPickr'),$(_0x33eda7(0x241))['show']();if($(this)[_0x33eda7(0x1e9)]()==_0x33eda7(0x214))$('.orgDropdowndivDeptFolder')[_0x33eda7(0x1c0)](),$(_0x33eda7(0x241))[_0x33eda7(0x1e4)](),$(_0x33eda7(0x1fc))[_0x33eda7(0x1e9)]()==null?getGuestClients(_0x33eda7(0x234)):($(_0x33eda7(0x1fe))[_0x33eda7(0x195)](_0x33eda7(0x1d7),![]),$(_0x33eda7(0x18d))['text']('Select'));else{if($(this)['val']()=='0'||$(this)[_0x33eda7(0x1e9)]()==_0x33eda7(0x21a))$('.orgDropdowndivDeptFolder')[_0x33eda7(0x1e4)](),$(_0x33eda7(0x241))[_0x33eda7(0x1e4)]();else $(this)[_0x33eda7(0x1e9)]()!=_0x33eda7(0x235)&&$(this)[_0x33eda7(0x1e9)]()!='0'?($(_0x33eda7(0x20e))[_0x33eda7(0x1e4)](),GetDeptSharingGpUsers($(this)[_0x33eda7(0x1e9)](),_0x33eda7(0x1f8))):$(_0x33eda7(0x20e))[_0x33eda7(0x1e4)]();}}),$('#ddlOrgNameDeptFolder')[_0x242a1e(0x1c8)](function(){var _0x1f01d7=_0x242a1e;getOrgEmps($(_0x1f01d7(0x22e))[_0x1f01d7(0x227)]());}),$('#btnDeptShareFolder')[_0x242a1e(0x1da)](function(){var _0x19414e=_0x242a1e,_0x29f9b9=_0x19414e(0x22c),_0x1c6fd0=_0x19414e(0x1f2),_0x789aac=0xc8,_0xa8125a=0x190;SP['SOD'][_0x19414e(0x220)]([_0x19414e(0x1c5),_0x19414e(0x1d2)],function(){var _0xdc53c3=_0x19414e;currentDlgShare=SP['UI'][_0xdc53c3(0x1b7)][_0xdc53c3(0x19c)](_0x29f9b9,_0x1c6fd0,_0x789aac,_0xa8125a);}),setTimeout(function(){deptDocFolderSharing();},0x64);}),$(_0x242a1e(0x18b))['click'](function(){var _0x4d553b=_0x242a1e;$('#myDeptFolderSharing')[_0x4d553b(0x240)](_0x4d553b(0x1e4)),$(_0x4d553b(0x241))['hide'](),$('.orgDropdowndivDeptFolder')[_0x4d553b(0x1e4)](),$(_0x4d553b(0x1eb))[_0x4d553b(0x23c)](''),$('.mulinput')[_0x4d553b(0x195)](_0x4d553b(0x1d7),![]),$(_0x4d553b(0x18d))[_0x4d553b(0x227)](_0x4d553b(0x222));});});function a0_0x3d0a(){var _0x3ee7d2=['\x27)/ListItemAllFields/breakroleinheritance(true)','val','/_api/SP.Sharing.DocumentSharingManager.UpdateDocumentSharingInfo','#deptSharedFolderUsersLists','Revoked','<div><a\x20href=','3226240AyqUZb','stringify','replace','_api/web/getfilebyserverrelativeurl(\x27','<br\x20/>Please\x20wait!!','#sharefilename','651WXBYss','#shareWithDeptFolderPermission\x20:selected','#chkDeptFolderSendEmail','GetMyDocumentsWithFilesFolder','Folder','Kindly\x20select\x20sharing\x20type.','\x27\x20and\x20LogonUser/ID\x20eq\x20\x27','--select--','#ddlOrgNameDeptFolder','#filedocumentname','.mulinput','\x27)/ListItemAllFields/roleassignments/getbyprincipalid(','Please\x20select\x20one\x20or\x20more\x20file','origin','resolve','permission\x20deleted\x20sucessfully.','webServerRelativeUrl','.context-menu','/DocumentManagementSystem/Forms/template.','null','Kindly\x20select\x20any\x20organization.','#chekedSendEmail','application/json;odata=verbose','error:\x20','{{fileype}}','SharedUsers','.orgDropdowndivDeptFolder','SharedDocument','<option\x20value=\x220\x22>-Select\x20Sharing-</option>','dotx','SiteURL','Please\x20select\x20sharing\x20type.','Organization','close','RoleAssignments','json','#myModalShareHistory','#lblFileName','Private','PrincipalId','Deferred','Error\x20while\x20checking\x20out:\x20','#myModalDocumentSharing','Type','loadMultiple','Name','Select','/_api/web/lists/getbytitle(\x27DocumentSharedGroups\x27)/items?$select=ID,SharingLevel,SharedUsers/Title,SharedUsers/UserName,SharedUsers/ID,LogonUser/ID,LogonUser/UserName&$expand=SharedUsers,LogonUser&$filter=LogonUser/ID\x20eq\x20\x27','ServerRedirectedEmbedUri','charAt','/DepartmentalDMS','text','File','value','serverUrl','done','Sharing\x20folder...','MyDepartmentDocumentCurrentFolder','#ddlOrgNameDeptFolder\x20:selected','This\x20is\x20an\x20auto\x20generated\x20email.\x20Please\x20don\x27t\x20reply.','ItemId','/_api/web/GetFileByServerRelativeUrl(\x27','GET','1247600sbQQpM','ddlOrgNameDeptFolder','Selective','webAbsoluteUrl',')?$select=ServerRedirectedEmbedUri,File/Name,File/ServerRelativeUrl,Folder/Name,Folder/ServerRelativeUrl,Shared/Title,SharedId&$expand=File,Folder,SharedId','POST','#shareingTypePermissionLevel','filter','2396884nKtTiC','html','ajax','Please\x20enter\x20sharing\x20users.','attr','modal','.folderpeoplepickerdivshowhide','parse','SharePoint.OpenDocuments','\x27)/checkout','{{details}}','/_api/web/lists/getbytitle(\x27DocumentSharedGroups\x27)/items?$select=ID,SharingLevel,SharedUsers/Title,SharedUsers/UserName,SharedUsers/ID,LogonUser/ID,LogonUser/UserName&$expand=SharedUsers,LogonUser&$filter=SharingLevel\x20eq\x20\x27','customSharingDeptFolderPplPickr','length','#__REQUESTDIGEST','_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/getItemById(','#sharedWithPermission','Restricted\x20View','#btnDeptCancelShareFolder,\x20#btnCloseDeptShare','128868NCIYnR','.multiBox','Reference','indexOf','ServerRelativeUrl','#currentSubFolderMyDepartment','{{Permission}}','push','#deptDocShare','prop','Kindly\x20enter\x20sharing\x20users.','{{filename}}','<div><strong>Permission:</strong>\x20','log','18cWvzcl',',\x20shared\x20the\x20following\x20document\x20with\x20you.<br/><br/>','showWaitScreenWithNoClose','/DepartmentalDMS/Forms/template.','_api/web/Lists/GetByTitle(\x27DepartmentalDMS\x27)/getItemById(','363984Sehbob','<div><strong>Reference\x20No\x20:</strong>\x20','userDisplayName','promise','#lblDocNumber','/_layouts/CreateNewDocument.aspx?id=','SharingLevel','Title','1682HcoKFZ','Sharing\x20Dept_Doc\x20Folder\x20','#shareWithDeptFolderPermission','results','toUpperCase','slice','#myDeptFolderSharing','Sharing\x20files...','#Deptmutiplesharefile','{{doclink}}','join','application/json;\x20odata=verbose','split','165kvIULH','SP.Utilities.EmailProperties','Department\x20site\x20URL\x20is\x20not\x20found!','ModalDialog','SOD','/DepartmentalDMS/','#lblFolderDeptTiltle','<div><strong>Title:</strong>\x20','Guest\x20users\x20are\x20not\x20available\x20in\x20selected\x20organization(s).','\x20Successfully\x20removed\x20Permission\x20!','Error:\x20','customShareingPoplePicker','show','</div>','Kindly\x20select\x20permission\x20type.','?$select=ID,SiteURL&$top=5000&$filter=ID\x20eq\x20\x27','#sharingTypeDeptFolderPermissionLvl','strings.js','{{sharedby}}','#sharedWithPermission\x20:selected','change',')?$expand=RoleAssignments/Member/Users','UserName','file\x20chekin','/_api/web/lists/getbytitle(\x27Departments\x27)/items/','_api/Web/Lists/getByTitle(\x27DepartmentalDMS\x27)/Items(','<div><strong>File\x20Name\x20:</strong>','location','userId','whatever','sp.ui.dialog.js','xlsx','/_api/web/GetFolderByServerRelativeUrl(\x27','when','<br/><br/>','checked','ready','#lblSelectedCurrentEmail','click','18LQRohs','\x27)/checkin','Department','Dear\x20User,<br/><br/>','22489511egsHSB','DepartmentalDMS','<option></option>','DELETE','append','hide','SharedId','reject','#txtSharedDocumetnOnDemandId'];a0_0x3d0a=function(){return _0x3ee7d2;};return a0_0x3d0a();}function CreatDeptDocfromTemplateWordFile(){var _0x340717=a0_0xee81c7;CommonDeptFileCreate(_0x340717(0x211),0x1);}function CreatDeptDocfromTemplateExcelFile(){var _0x14706f=a0_0xee81c7;CommonDeptFileCreate(_0x14706f(0x1d3),0x2);}function CreatDeptDocfromTemplatePPTFile(){CommonDeptFileCreate('pptx',0x3);}function CommonDeptFileCreate(_0x3c7c7d,_0x6f8def){var _0x49a184=a0_0xee81c7,_0x48ce42='',_0x8c08c0=$(_0x49a184(0x191))[_0x49a184(0x1e9)]();_0x8c08c0=_0x8c08c0[_0x49a184(0x1ac)](0x10,-0x1);if(mydeptSiteUrl==_0x49a184(0x207))return alert(_0x49a184(0x1b6)),![];_0x8c08c0==''?createNewDocumentWithRedirect2(_0x48ce42,mydeptSiteUrl+_0x49a184(0x19d)+_0x3c7c7d,mydeptSiteUrl+_0x49a184(0x226),_0x49a184(0x243),![],mydeptSiteUrl+_0x49a184(0x1a4)+myCompanyUrl+_0x49a184(0x206)+_0x3c7c7d,!![],_0x6f8def):createNewDocumentWithRedirect2(_0x48ce42,mydeptSiteUrl+'/DepartmentalDMS/Forms/template.'+_0x3c7c7d,mydeptSiteUrl+_0x49a184(0x1b9)+_0x8c08c0,_0x49a184(0x243),![],mydeptSiteUrl+_0x49a184(0x1a4)+myCompanyUrl+_0x49a184(0x206)+_0x3c7c7d,!![],_0x6f8def);}function getDeptSiteUrl(){var _0x4e68f5=a0_0xee81c7,_0x2c9fe8=_0x4e68f5(0x1c3)+Logged_DepartmentId+'\x27\x20';dfds=$[_0x4e68f5(0x21c)](),url=_spPageContextInfo[_0x4e68f5(0x236)]+_0x4e68f5(0x1cc)+_0x2c9fe8,$[_0x4e68f5(0x1d5)](getItems(url,dfds))[_0x4e68f5(0x22b)](function(_0x485365){var _0x2c87af=_0x4e68f5;response=[],_0x485365[_0x2c87af(0x186)]>0x0?mydeptSiteUrl=_0x485365[0x0][_0x2c87af(0x212)]:mydeptSiteUrl=_0x2c87af(0x207);});}function OpenSharePopup(){var _0x526e57=a0_0xee81c7;$('.orgDropdowndiv')[_0x526e57(0x1e4)]();if(selectedDepartmentDoc[_0x526e57(0x186)]>0x0)globalsharingDocumentDetails='',globalSharingDocumentDocumentType='',$('#chekedSendEmail')['attr'](_0x526e57(0x1d7),!![]),$(_0x526e57(0x1e7))[_0x526e57(0x1e9)](''),$(_0x526e57(0x219))[_0x526e57(0x23c)](''),$(_0x526e57(0x1a3))[_0x526e57(0x23c)](''),$('#lblDocTiltle')[_0x526e57(0x23c)](''),$(_0x526e57(0x189))[_0x526e57(0x1e9)](_0x526e57(0x1fb)),$(_0x526e57(0x239))[_0x526e57(0x1e9)]('0'),$(_0x526e57(0x1f3))[_0x526e57(0x1e4)](),$('#sharefiletilte')[_0x526e57(0x1e4)](),$(_0x526e57(0x1fd))[_0x526e57(0x1e4)](),sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[],clearPeoplePickerControl(_0x526e57(0x1bf)),$(_0x526e57(0x21e))['modal'](_0x526e57(0x1c0)),$('.MyDocsShare')[_0x526e57(0x1e4)](),$(_0x526e57(0x1af))[_0x526e57(0x1c0)](),BindMySharingGroups(),$(_0x526e57(0x239))['trigger'](_0x526e57(0x1c8));else return alert('Please\x20select\x20one\x20or\x20more\x20file'),![];}function DeptSharemutiplefile(){var _0xca9f14=a0_0xee81c7;if(selectedDepartmentDoc[_0xca9f14(0x186)]>0x0){var _0x5af120=$('#shareingTypePermissionLevel')[_0xca9f14(0x1e9)](),_0x11420f=$(_0xca9f14(0x189))['val']();if(_0x5af120=='0'||_0x5af120==null||_0x5af120=='')return currentDlgShare!=''&&currentDlgShare[_0xca9f14(0x215)](),alert(_0xca9f14(0x1f9)),![];else{if(_0x11420f==null||_0x11420f==''||_0x11420f==_0xca9f14(0x1fb))return currentDlgShare!=''&&currentDlgShare[_0xca9f14(0x215)](),alert(_0xca9f14(0x1c2)),![];}if(_0x5af120==_0xca9f14(0x21a))$('#chekedSendEmail')[_0xca9f14(0x23f)](_0xca9f14(0x1d7),![]);else{if(_0x5af120==_0xca9f14(0x214)){sharedHistoryUser=sharedUsersIdArrayListItemCollection;if($(_0xca9f14(0x18d))[_0xca9f14(0x227)]()[_0xca9f14(0x18f)](_0xca9f14(0x222))==0x0)return currentDlgShare!=''&&currentDlgShare['close'](),alert(_0xca9f14(0x208)),![];if(sharedUsersIdArrayListItemCollection[_0xca9f14(0x186)]==0x0)return currentDlgShare!=''&&currentDlgShare[_0xca9f14(0x215)](),alert(_0xca9f14(0x1bc)),![];}else{sharedHistoryUser=[],sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[];if(getUserInfoFromPeoplePicker('customShareingPoplePicker')){if(sharedUsersIdArrayListItemCollection!=null){sharedHistoryUser=sharedUsersIdArrayListItemCollection;if(sharedUsersIdArrayListItemCollection[_0xca9f14(0x186)]==0x0)return currentDlgShare!=''&&currentDlgShare['close'](),alert('Kindly\x20enter\x20sharing\x20users.'),![];}else return currentDlgShare!=''&&currentDlgShare['close'](),alert(_0xca9f14(0x196)),![];}else return currentDlgShare!=''&&currentDlgShare[_0xca9f14(0x215)](),alert(_0xca9f14(0x196)),![];}}for(var _0xaec303=0x0;_0xaec303<selectedDepartmentDoc[_0xca9f14(0x186)];_0xaec303++){currentFileSiteURL=window[_0xca9f14(0x1cf)]['origin']+selectedDepartmentDocrelativeurl[_0xaec303][_0xca9f14(0x1b3)](_0xca9f14(0x1e0))[0x0];var _0x2068eb=selectedDepartmentDoc[_0xaec303],_0x36d010=GetDeptFileServerRelativeUrl(_0x2068eb,'File');arrSharedUserIds=[];var _0xe63089=-0x1;while(++_0xe63089<sharedUsersIdArrayListItemCollection['length']){arrSharedUserIds[_0xe63089]=sharedUsersIdArrayListItemCollection[_0xe63089];}sharedUsersIdArrayListItemCollection=sharedUsersIdArrayListItemCollection['concat'](sharefileuser);if(_0x5af120==_0xca9f14(0x21a))sharedUsersIdArrayListItemCollection=[],$['when'](BreakInheritePermissionOnItemSharing(myCompanyUrl,_0x36d010,_0x2068eb,_spPageContextInfo[_0xca9f14(0x1d0)],sharedUsersIdArrayListItemCollection))['done'](function(_0x55d682){DeleteSharedLink(_0x2068eb);});else{var _0x2d2e4b=$(_0xca9f14(0x239))['val'](),_0x367c74=$(_0xca9f14(0x189))[_0xca9f14(0x1e9)]();ShareFilesFolder(_0x36d010,_0xca9f14(0x228));if(sharedUsersIdArrayListItemCollection[_0xca9f14(0x186)]>0x0){var _0x408aec=$(_0xca9f14(0x239))['val']();updateDeptDocPropertiesOnItemSharing(_0x2068eb,_0x36d010,_0x408aec,sharedUsersIdArrayListItemCollection,currentFileSiteURL,![]),GetDocumentsRevoke(sharedHistoryUser,_0x2068eb),_0x5af120==_0xca9f14(0x214)?AddSharedLinkToListOrg(shredLinkFileName,_0x36d010,arrUserClientWise,_0x2068eb,_0xca9f14(0x228),_0x2d2e4b,_0x367c74,_0xca9f14(0x1dd)):AddSharedLinkToList22(shredLinkFileName,_0x36d010,sharedHistoryUser,_0x2068eb,_0xca9f14(0x228),_0x2d2e4b,_0x367c74,_0xca9f14(0x1dd));}sharedUsersIdArrayListItemCollection=sharedHistoryUser;}sharefileuser=[];}selectedDocumentserverrelativeurl=[],selectedDepartmentDoc=[];if($(_0xca9f14(0x209))[_0xca9f14(0x195)](_0xca9f14(0x1d7))==!![]){if(arrDepartmntEmail['length']>0x0){var _0x2f5428='',_0x226485=$(_0xca9f14(0x1c7))[_0xca9f14(0x227)]();_0x226485==_0xca9f14(0x1fb)&&(_0x226485='');_0x2f5428=_0xca9f14(0x1de)+_spPageContextInfo[_0xca9f14(0x1a1)]+_0xca9f14(0x19b);for(i=0x0;i<arrDepartmntEmail['length'];i++){_0x2f5428=_0x2f5428+_0xca9f14(0x1ce)+arrDepartmntEmail[i][_0xca9f14(0x228)]+'</div>'+_0xca9f14(0x1a0)+arrDepartmntEmail[i][_0xca9f14(0x18e)]+_0xca9f14(0x1c1)+_0xca9f14(0x1bb)+arrDepartmntEmail[i][_0xca9f14(0x1a6)]+_0xca9f14(0x1c1)+'<div><strong>Type:</strong>\x20'+arrDepartmntEmail[i][_0xca9f14(0x21f)]+_0xca9f14(0x1c1)+_0xca9f14(0x198)+_0x226485+_0xca9f14(0x1c1)+_0xca9f14(0x1ed)+arrDepartmntEmail[i][_0xca9f14(0x22a)]+'>Click\x20here</a>\x20to\x20open\x20the\x20document.</div>'+_0xca9f14(0x1d6);}_0x2f5428+=_0xca9f14(0x22f);}arrDepartmntEmail=[];var _0x25008d=[];_0x25008d[_0xca9f14(0x193)]($(_0xca9f14(0x1d9))['html']());var _0x31f7d0=$(_0xca9f14(0x239))['val'](),_0x1177ea=$(_0xca9f14(0x1d9))[_0xca9f14(0x23c)](),_0xe0fca3;_0xe0fca3={'properties':{'__metadata':{'type':_0xca9f14(0x1b5)},'From':_0x1177ea,'To':{'results':sharedUsersEmailIDsArrayListItemCollection},'CC':{'results':_0x25008d},'Body':_0x2f5428,'Subject':sharedEmailSubject}},SendEmailSharedNotification(_0xe0fca3);}}else alert(_0xca9f14(0x200)),currentDlgShare!=''&&currentDlgShare[_0xca9f14(0x215)]();currentDlgShare!=''&&currentDlgShare[_0xca9f14(0x215)]();}function GetDeptFileServerRelativeUrl(_0x449b33,_0xce47ab){var _0x5b8407=a0_0xee81c7,_0x27a85d='',_0x4f529d=currentFileSiteURL+'_api/web/Lists/GetByTitle(\x27DepartmentalDMS\x27)/getItemById('+_0x449b33+')?$select=ServerRedirectedEmbedUri,File/Name,File/ServerRelativeUrl,Folder/Name,Folder/ServerRelativeUrl,Shared/Title,SharedId&$expand=File,Folder,SharedId';return $['ajax']({'url':_0x4f529d,'headers':{'accept':_0x5b8407(0x20a),'content-type':_0x5b8407(0x20a),'X-RequestDigest':$('#__REQUESTDIGEST')['val']()},'async':![],'success':function(_0x466468){var _0x1de40d=_0x5b8407;if(_0xce47ab==_0x1de40d(0x228)){_0x27a85d=_0x466468['d'][_0x1de40d(0x228)][_0x1de40d(0x190)],shredLinkFileName=_0x466468['d']['File'][_0x1de40d(0x221)],commonserverRedirectedEmbedUri=_0x466468['d'][_0x1de40d(0x224)];if(_0x466468['d'][_0x1de40d(0x1e5)]!=null)for(var _0x26909f=0x0;_0x26909f<_0x466468['d']['SharedId'][_0x1de40d(0x1aa)][_0x1de40d(0x186)];_0x26909f++){var _0x18dc99=_0x466468['d']['SharedId'][_0x1de40d(0x1aa)][_0x26909f];sharefileuser['push'](_0x18dc99);}(commonserverRedirectedEmbedUri==null||commonserverRedirectedEmbedUri=='')&&(commonserverRedirectedEmbedUri='');}else _0x27a85d=_0x466468['d']['Folder'][_0x1de40d(0x190)],shredLinkFolderName=_0x466468['d'][_0x1de40d(0x1f8)]['Name'],commonserverRedirectedEmbedUri='';},'eror':function(_0x5db682){var _0x4eed9c=_0x5b8407;console[_0x4eed9c(0x199)]('error:\x20'+JSON[_0x4eed9c(0x1ef)](_0x5db682)),currentDlgShare!=''&&currentDlgShare['close']();}}),_0x27a85d;}function updateDeptDocPropertiesOnItemSharing(_0xd70a2c,_0xbeae6,_0x43bda3,_0x1d4e12,_0x3a86cf,_0x31a660){var _0x189696=a0_0xee81c7,_0x1b6c15=$(_0x189696(0x189))[_0x189696(0x1e9)](),_0x118259=$('#txtPermissionLevelId')['val']();$('#shareingTypePermissionLevel')[_0x189696(0x1e9)]()==_0x189696(0x21a)&&(_0x118259='',_0x1b6c15='');(_0x1b6c15==_0x189696(0x1fb)||_0x1b6c15==null||_0x1b6c15=='')&&(_0x118259='',_0x1b6c15='');var _0x3aff56='DepartmentalDMS',_0x5abf3e,_0x136c92=GetItemTypeDeptList(_0x3aff56);_0x5abf3e={'__metadata':{'type':_0x136c92},'SecurityLevel':_0x43bda3,'PermissionLevel':_0x1b6c15,'PermissionLevelId':_0x118259,'SharedId':{'results':_0x1d4e12}},checkoutDeptDocument(_0xbeae6)['done'](function(){var _0x4ee9b5=_0x189696;updateItemWithIDItemListDocuments(_0x3aff56,_0x5abf3e,_0xd70a2c,_0x3a86cf,_0x31a660)[_0x4ee9b5(0x22b)](function(){checkInDeptDocument(_0xbeae6)['done'](function(){var _0x6e338b=a0_0x5039,_0x1ff04f=readTargetUrlCookie(_0x6e338b(0x22d)+_spPageContextInfo['siteId']);departmentDoc[_0x6e338b(0x1f7)](_0x1ff04f);});});})['fail'](function(_0x543b4a){var _0x146789=_0x189696;console['log'](_0x146789(0x20b)+JSON[_0x146789(0x1ef)](_0x543b4a)),currentDlgShare!=''&&currentDlgShare[_0x146789(0x215)]();});}function GetItemTypeDeptList(_0x1cb20e){var _0x2cb156=a0_0xee81c7;return'SP.Data.'+_0x1cb20e[_0x2cb156(0x225)](0x0)[_0x2cb156(0x1ab)]()+_0x1cb20e['split']('\x20')[_0x2cb156(0x1b1)]('')[_0x2cb156(0x1ac)](0x1)+'Item';}function checkoutDeptDocument(_0x558c9f){var _0x41e6c4=a0_0xee81c7,_0x2d947e=$['Deferred']();return $[_0x41e6c4(0x23d)]({'url':currentFileSiteURL+_0x41e6c4(0x1f1)+_0x558c9f+_0x41e6c4(0x244),'method':'POST','headers':{'accept':'application/json;odata=verbose','content-type':_0x41e6c4(0x20a),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x41e6c4(0x1e9)]()},'success':function(_0x43cef4){var _0x12b02b=_0x41e6c4,_0x32c266=_0x43cef4;_0x2d947e['resolve'](_0x43cef4['d']),console[_0x12b02b(0x199)]('success:File\x20Checked\x20out\x20');},'error':function(_0x433561){var _0x22ddde=_0x41e6c4;alert(_0x22ddde(0x21d)+JSON[_0x22ddde(0x1ef)](_0x433561)),currentDlgShare!=''&&currentDlgShare[_0x22ddde(0x215)]();}}),_0x2d947e;}function checkInDeptDocument(_0x412fa0){var _0x37ccdf=a0_0xee81c7,_0x5f84d7=currentFileSiteURL+_0x37ccdf(0x1f1)+_0x412fa0+_0x37ccdf(0x1dc),_0x13d7c1=$[_0x37ccdf(0x21c)]();return $['ajax']({'url':_0x5f84d7,'method':_0x37ccdf(0x238),'data':JSON[_0x37ccdf(0x1ef)]({'checkInType':0x2,'comment':_0x37ccdf(0x1d1)}),'headers':{'accept':'application/json;odata=verbose','content-type':_0x37ccdf(0x20a),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x37ccdf(0x1e9)]()},'success':function(_0x57bdd9){var _0x3716fc=_0x37ccdf,_0x22290c=_0x57bdd9;_0x13d7c1['resolve'](_0x57bdd9['d']),console[_0x3716fc(0x199)](_0x3716fc(0x1cb));},'error':function(_0xd65aee){var _0x45fcf4=_0x37ccdf;_0x13d7c1['reject'](_0xd65aee),currentDlgShare!=''&&currentDlgShare[_0x45fcf4(0x215)]();}}),_0x13d7c1;}var SelectedFolderPathURL='';function DeptShareFolderProperties(_0x1e72b8,_0x2deae5,_0x346f64){var _0x20e39b=a0_0xee81c7;SelectedFolderPathURL=window[_0x20e39b(0x1cf)][_0x20e39b(0x201)]+_0x346f64[_0x20e39b(0x1b3)](_0x20e39b(0x1e0))[0x0],BindDeptSharingGroups(),commonUsedFolderSharingId=_0x1e72b8,$(_0x20e39b(0x1f6))[_0x20e39b(0x23f)](_0x20e39b(0x1d7),![]),sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[],clearPeoplePickerControl(_0x20e39b(0x185)),$('#sharingTypeDeptFolderPermissionLvl')[_0x20e39b(0x1e9)]('0'),$(_0x20e39b(0x239))['trigger']('change'),$('#myDeptFolderSharing')['modal'](_0x20e39b(0x1c0)),$(_0x20e39b(0x1ba))[_0x20e39b(0x23c)](_0x2deae5);}function BindDeptSharingGroups(){var _0xadd22a=a0_0xee81c7;$(_0xadd22a(0x205))[_0xadd22a(0x1e4)]();var _0x56bc4f=_spPageContextInfo[_0xadd22a(0x204)]+_0xadd22a(0x223)+_spPageContextInfo[_0xadd22a(0x1d0)]+'\x27';$[_0xadd22a(0x23d)]({'url':_0x56bc4f,'headers':{'Accept':_0xadd22a(0x20a)},'async':![],'success':function(_0x28eeb3){var _0x2105e8=_0xadd22a;$('#sharingTypeDeptFolderPermissionLvl')['empty']()[_0x2105e8(0x1e3)](_0x2105e8(0x210)),$(_0x2105e8(0x1c4))['append']($(_0x2105e8(0x1e1))[_0x2105e8(0x23f)]('value',_0x2105e8(0x21a))['text']('Private')),$(_0x2105e8(0x1c4))[_0x2105e8(0x1e3)]($('<option></option>')[_0x2105e8(0x23f)]('value','Selective')[_0x2105e8(0x227)](_0x2105e8(0x235))),$(_0x2105e8(0x1c4))[_0x2105e8(0x1e3)]($(_0x2105e8(0x1e1))[_0x2105e8(0x23f)](_0x2105e8(0x229),_0x2105e8(0x214))[_0x2105e8(0x227)](_0x2105e8(0x214)));for(var _0x409721=0x0;_0x409721<_0x28eeb3['d']['results'][_0x2105e8(0x186)];_0x409721++){$(_0x2105e8(0x1c4))[_0x2105e8(0x1e3)]($(_0x2105e8(0x1e1))['attr'](_0x2105e8(0x229),_0x28eeb3['d']['results'][_0x409721][_0x2105e8(0x1a5)])[_0x2105e8(0x227)](_0x28eeb3['d'][_0x2105e8(0x1aa)][_0x409721][_0x2105e8(0x1a5)]));}},'eror':function(_0x2a05dc){var _0x1d6047=_0xadd22a;console[_0x1d6047(0x199)](_0x1d6047(0x20b)+JSON['stringify'](_0x2a05dc)),currentDlgShare!=''&&currentDlgShare['close']();}});}function GetDeptSharingGpUsers(_0xf2fba5,_0x451b5c){var _0x559453=a0_0xee81c7;sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[];var _0x38c756=_spPageContextInfo[_0x559453(0x204)]+_0x559453(0x246)+_0xf2fba5+_0x559453(0x1fa)+_spPageContextInfo[_0x559453(0x1d0)]+'\x27';$['ajax']({'url':_0x38c756,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x4004e8){var _0x357b13=_0x559453,_0x3e5480='';for(var _0x3caa47=0x0;_0x3caa47<_0x4004e8['d'][_0x357b13(0x1aa)][_0x357b13(0x186)];_0x3caa47++){for(var _0x1af06d=0x0;_0x1af06d<_0x4004e8['d'][_0x357b13(0x1aa)][_0x3caa47][_0x357b13(0x20d)][_0x357b13(0x1aa)]['length'];_0x1af06d++){sharedUsersIdArrayListItemCollection[_0x357b13(0x18f)](_0x4004e8['d']['results'][_0x3caa47][_0x357b13(0x20d)][_0x357b13(0x1aa)][_0x1af06d]['ID'])==-0x1&&(sharedUsersIdArrayListItemCollection['push'](_0x4004e8['d'][_0x357b13(0x1aa)][_0x3caa47]['SharedUsers']['results'][_0x1af06d]['ID']),SetAndResolvePeoplePicker('customSharingDeptFolderPplPickr',_0x4004e8['d'][_0x357b13(0x1aa)][_0x3caa47]['SharedUsers'][_0x357b13(0x1aa)][_0x1af06d][_0x357b13(0x1ca)],![]));}}},'eror':function(_0x4cde7e){var _0x169ec1=_0x559453;console[_0x169ec1(0x199)](_0x169ec1(0x1be)+JSON[_0x169ec1(0x1ef)](_0x4cde7e)),currentDlgShare!=''&&currentDlgShare[_0x169ec1(0x215)]();}});}function a0_0x5039(_0x458308,_0x56b243){var _0x3d0a28=a0_0x3d0a();return a0_0x5039=function(_0x503949,_0x47553a){_0x503949=_0x503949-0x185;var _0x14bbc6=_0x3d0a28[_0x503949];return _0x14bbc6;},a0_0x5039(_0x458308,_0x56b243);}function deptDocFolderSharing(){var _0xe3d71=a0_0xee81c7,_0x322ea2=$(_0xe3d71(0x1c4))[_0xe3d71(0x1e9)](),_0xec091a=$(_0xe3d71(0x1a9))[_0xe3d71(0x1e9)]();if(_0x322ea2=='0'||_0x322ea2==null||_0x322ea2=='')return currentDlgShare!=''&&currentDlgShare[_0xe3d71(0x215)](),alert(_0xe3d71(0x213)),![];else{if(_0xec091a==null||_0xec091a==''||_0xec091a==_0xe3d71(0x1fb))return currentDlgShare!=''&&currentDlgShare['close'](),alert('Kindly\x20select\x20permission\x20type.'),![];else{if(_0x322ea2==_0xe3d71(0x214)){sharedHistoryUser=sharedUsersIdArrayListItemCollection;if($('#ddlOrgNameDeptFolder')[_0xe3d71(0x1e9)]()=='0')return currentDlgShare!=''&&currentDlgShare[_0xe3d71(0x215)](),alert(_0xe3d71(0x208)),![];if(sharedUsersIdArrayListItemCollection[_0xe3d71(0x186)]==0x0)return currentDlgShare!=''&&currentDlgShare[_0xe3d71(0x215)](),alert(_0xe3d71(0x1bc)),![];}}}if(_0x322ea2==_0xe3d71(0x21a))$('#chkDeptFolderSendEmail')['attr'](_0xe3d71(0x1d7),![]);else{if(_0x322ea2!=_0xe3d71(0x214)){sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[];if(getUserInfoFromPeoplePicker(_0xe3d71(0x185))){if(sharedUsersIdArrayListItemCollection!=null){if(sharedUsersIdArrayListItemCollection[_0xe3d71(0x186)]==0x0)return currentDlgShare!=''&&currentDlgShare[_0xe3d71(0x215)](),alert(_0xe3d71(0x23e)),![];}else return currentDlgShare!=''&&currentDlgShare[_0xe3d71(0x215)](),alert('Please\x20enter\x20sharing\x20users.'),![];}else return currentDlgShare!=''&&currentDlgShare['close'](),alert(_0xe3d71(0x23e)),![];}}var _0x1113ff=GetDeptFileServerUrlById(commonUsedFolderSharingId,_0xe3d71(0x1f8));_0x322ea2==_0xe3d71(0x21a)?(updateFolderProperties(commonUsedFolderSharingId,mydeptSiteUrl,![],_0xe3d71(0x1e0),'Private'),$[_0xe3d71(0x1d5)](GetAllDeptFolderUsrsSharedPrincipleId(commonUsedFolderSharingId))[_0xe3d71(0x22b)](function(_0x556efa){var _0x43308c=_0xe3d71;DeleteSharedLink(commonUsedFolderSharingId);var _0x2a21c4=readTargetUrlCookie(_0x43308c(0x22d)+_spPageContextInfo['siteId']);departmentDoc[_0x43308c(0x1f7)](_0x2a21c4),alert('Folder\x27s\x20permission\x20has\x20been\x20set\x20private.'),$(_0x43308c(0x1ad))[_0x43308c(0x240)](_0x43308c(0x1e4)),currentDlgShare!=''&&currentDlgShare['close']();})):(updateFolderProperties(commonUsedFolderSharingId,mydeptSiteUrl,![],_0xe3d71(0x1e0),_0x322ea2),ShareDeptFilesFolder(_0x1113ff,_0xe3d71(0x1f8),_0x322ea2));}function GetDeptFileServerUrlById(_0x16062d,_0x136773){var _0x4163fb=a0_0xee81c7,_0x33a28c='',_0x58e0fb=SelectedFolderPathURL+_0x4163fb(0x19e)+_0x16062d+_0x4163fb(0x237);return $['ajax']({'url':_0x58e0fb,'headers':{'accept':_0x4163fb(0x20a),'content-type':_0x4163fb(0x20a),'X-RequestDigest':$(_0x4163fb(0x187))[_0x4163fb(0x1e9)]()},'async':![],'success':function(_0x44f6a4){var _0xe53b5b=_0x4163fb;if(_0x136773==_0xe53b5b(0x228)){_0x33a28c=_0x44f6a4['d'][_0xe53b5b(0x228)]['ServerRelativeUrl'],shredLinkFileName=_0x44f6a4['d']['File']['Name'],commonserverRedirectedEmbedUri=_0x44f6a4['d'][_0xe53b5b(0x224)];if(_0x44f6a4['d']['SharedId']!=null)for(var _0x3ca0eb=0x0;_0x3ca0eb<_0x44f6a4['d'][_0xe53b5b(0x1e5)]['results'][_0xe53b5b(0x186)];_0x3ca0eb++){var _0x448510=_0x44f6a4['d']['SharedId']['results'][_0x3ca0eb];sharefileuser[_0xe53b5b(0x193)](_0x448510);}(commonserverRedirectedEmbedUri==null||commonserverRedirectedEmbedUri=='')&&(commonserverRedirectedEmbedUri='');}else _0x33a28c=_0x44f6a4['d'][_0xe53b5b(0x1f8)][_0xe53b5b(0x190)],shredLinkFolderName=_0x44f6a4['d'][_0xe53b5b(0x1f8)][_0xe53b5b(0x221)],commonserverRedirectedEmbedUri='';},'eror':function(_0x460353){var _0x4643b0=_0x4163fb;console[_0x4643b0(0x199)](_0x4643b0(0x1be)+JSON[_0x4643b0(0x1ef)](_0x460353));}}),_0x33a28c;}function GetAllDeptFolderUsrsSharedPrincipleId(_0x20d7d9){var _0x3b998d=a0_0xee81c7,_0x2db0ea=$[_0x3b998d(0x21c)](),_0x6b3d32=new Date(),_0x500023=Date[_0x3b998d(0x242)](_0x6b3d32);return $[_0x3b998d(0x23d)]({'url':SelectedFolderPathURL+_0x3b998d(0x1cd)+_0x20d7d9+_0x3b998d(0x1c9)+_0x500023,'method':_0x3b998d(0x232),'async':![],'headers':{'Accept':_0x3b998d(0x1b2)},'success':function(_0x5ac620){var _0x120756=_0x3b998d;_0x2db0ea[_0x120756(0x202)](_0x5ac620['d']['results']);for(var _0x52d16b=0x0;_0x52d16b<_0x5ac620['d'][_0x120756(0x216)][_0x120756(0x1aa)][_0x120756(0x186)];_0x52d16b++){if(_0x5ac620['d']['RoleAssignments'][_0x120756(0x1aa)][_0x52d16b][_0x120756(0x21b)]!=_spPageContextInfo[_0x120756(0x1d0)]){var _0x2c3f5d=_0x5ac620['d'][_0x120756(0x216)][_0x120756(0x1aa)][_0x52d16b][_0x120756(0x21b)];DeleteDeptFolderPrinciple(_0x20d7d9,_0x2c3f5d);}}},'error':function(_0x30e9df){var _0x28bc56=_0x3b998d;_0x2db0ea['reject'](_0x30e9df),waitingDialog[_0x28bc56(0x1e4)]();}}),_0x2db0ea[_0x3b998d(0x1a2)]();}function DeleteDeptFolderPrinciple(_0x1593a7,_0x197bb9){var _0x2c0644=a0_0xee81c7,_0x3f2940=$[_0x2c0644(0x21c)](),_0x51fa00={'X-RequestDigest':$(_0x2c0644(0x187))[_0x2c0644(0x1e9)](),'X-HTTP-Method':_0x2c0644(0x1e2)},_0x5493a1=SelectedFolderPathURL+_0x2c0644(0x188)+_0x1593a7+')/roleassignments/getbyprincipalid('+_0x197bb9+')';return $['ajax']({'url':_0x5493a1,'type':_0x2c0644(0x238),'headers':_0x51fa00,'async':![],'dataType':_0x2c0644(0x217),'success':function(_0x5b9403){var _0x5f1bf7=_0x2c0644;_0x3f2940[_0x5f1bf7(0x202)](_0x5b9403['d'][_0x5f1bf7(0x1aa)]),console['log'](_0x197bb9+_0x5f1bf7(0x1bd));},'error':function(_0x5281d3){var _0x3bd0c0=_0x2c0644;_0x3f2940[_0x3bd0c0(0x1e6)](_0x5281d3),console['log'](JSON[_0x3bd0c0(0x1ef)](_0x5281d3));}}),_0x3f2940[_0x2c0644(0x1a2)]();}function ShareDeptFilesFolder(_0x509ed6,_0x60ec9c,_0x52340f){var _0x2dad96=a0_0xee81c7,_0x98119b=[],_0x1e461f=0x1;if($('#shareWithDeptFolderPermission')['val']()=='Read')_0x1e461f=0x1;else $('#shareWithDeptFolderPermission')[_0x2dad96(0x1e9)]()==_0x2dad96(0x18a)?_0x1e461f=0x7:_0x1e461f=0x2;var _0x54869d=createJSONMetadata(sharedUsersEmailIDsArrayListItemCollection,_0x1e461f),_0x188806=_spPageContextInfo[_0x2dad96(0x236)]+_0x2dad96(0x1ea);$['ajax']({'url':_0x188806,'method':_0x2dad96(0x238),'async':![],'data':JSON[_0x2dad96(0x1ef)]({'resourceAddress':document[_0x2dad96(0x1cf)][_0x2dad96(0x201)]+_0x509ed6,'userRoleAssignments':_0x54869d,'validateExistingPermissions':![],'additiveMode':![],'sendServerManagedNotification':![],'customMessage':'Please\x20look\x20at\x20the\x20following\x20File/Folder.','includeAnonymousLinksInNotification':![]}),'headers':{'accept':_0x2dad96(0x20a),'content-type':_0x2dad96(0x20a),'X-RequestDigest':$(_0x2dad96(0x187))['val']()},'success':function(_0x28c705){var _0x1bd87b=_0x2dad96,_0x293031=$('#sharingTypeDeptFolderPermissionLvl')['val'](),_0x118fae='';if(_0x60ec9c==_0x1bd87b(0x1f8)){GetDocumentsRevoke(sharedUsersIdArrayListItemCollection,commonUsedFolderSharingId);_0x52340f==_0x1bd87b(0x214)&&_0x60ec9c==_0x1bd87b(0x1f8)?AddSharedLinkToListOrg(shredLinkFolderName,_0x509ed6,arrUserClientWise,commonUsedFolderSharingId,'Folder',_0x293031,$(_0x1bd87b(0x1a9))['val'](),_0x1bd87b(0x1dd)):AddSharedLinkToList22(shredLinkFolderName,_0x509ed6,sharedUsersIdArrayListItemCollection,commonUsedFolderSharingId,_0x1bd87b(0x1f8),_0x293031,$(_0x1bd87b(0x1a9))[_0x1bd87b(0x1e9)](),'Department');$(_0x1bd87b(0x1f6))[_0x1bd87b(0x195)]('checked')==!![]&&EmailDeptSharedProperties(sharedUsersEmailIDsArrayListItemCollection,_0x60ec9c);var _0x415619=readTargetUrlCookie(_0x1bd87b(0x22d)+_spPageContextInfo['siteId']);departmentDoc[_0x1bd87b(0x1f7)](_0x415619);}$(_0x1bd87b(0x1ad))['modal']('hide'),currentDlgShare!=''&&currentDlgShare[_0x1bd87b(0x215)](),$(_0x1bd87b(0x1fe))['prop'](_0x1bd87b(0x1d7),![]),$('.multiBox')[_0x1bd87b(0x227)](_0x1bd87b(0x222)),$(_0x1bd87b(0x20e))[_0x1bd87b(0x1e4)]();},'error':function(_0x51663b){var _0x537988=_0x2dad96;alert(_0x537988(0x1a8)+JSON[_0x537988(0x1ef)](_0x51663b)),currentDlgShare!=''&&currentDlgShare[_0x537988(0x215)]();}});}function EmailDeptSharedProperties(_0x93c9d2,_0x41fd30){var _0x3d7d70=a0_0xee81c7,_0xbab719=[];_0xbab719[_0x3d7d70(0x193)]($('#lblSelectedCurrentEmail')[_0x3d7d70(0x23c)]());var _0x42854a=$(_0x3d7d70(0x1c4))[_0x3d7d70(0x1e9)](),_0x343d0a='',_0x39810f=emailBodyContent;if(_0x41fd30=='Folder'){var _0x34f5a0=$(_0x3d7d70(0x1f5))['text']();_0x34f5a0==_0x3d7d70(0x1fb)&&(_0x34f5a0=''),_0x39810f=_0x39810f['replace'](_0x3d7d70(0x197),$('#lblFolderDeptTiltle')[_0x3d7d70(0x227)]()),_0x39810f=_0x39810f[_0x3d7d70(0x1f0)](_0x3d7d70(0x20c),_0x3d7d70(0x1f8)),_0x39810f=_0x39810f[_0x3d7d70(0x1f0)](_0x3d7d70(0x245),''),_0x39810f=_0x39810f[_0x3d7d70(0x1f0)](_0x3d7d70(0x1b0),_spPageContextInfo['siteAbsoluteUrl']+'/Pages/MyDocuments.aspx?WebAppId=1'),_0x39810f=_0x39810f[_0x3d7d70(0x1f0)](_0x3d7d70(0x192),_0x34f5a0);}else{globalSharingDocumentDocumentType==null&&(globalSharingDocumentDocumentType='');globalsharingDocumentDetails==null&&(globalsharingDocumentDetails='');var _0x34f5a0=$('#sharedWithPermission\x20\x20:selected')[_0x3d7d70(0x227)]();_0x34f5a0==_0x3d7d70(0x1fb)&&(_0x34f5a0=''),_0x39810f=_0x39810f[_0x3d7d70(0x1f0)](_0x3d7d70(0x197),$(_0x3d7d70(0x219))['html']()),_0x39810f=_0x39810f[_0x3d7d70(0x1f0)](_0x3d7d70(0x20c),globalSharingDocumentDocumentType),_0x39810f=_0x39810f['replace']('{{details}}',globalsharingDocumentDetails),_0x39810f=_0x39810f[_0x3d7d70(0x1f0)]('{{doclink}}',encodeURI(document[_0x3d7d70(0x1cf)][_0x3d7d70(0x201)]+'/'+$('#lblSelectedFileUrl')[_0x3d7d70(0x227)]())),_0x39810f=_0x39810f[_0x3d7d70(0x1f0)]('{{Permission}}',_0x34f5a0);}_0x39810f=_0x39810f[_0x3d7d70(0x1f0)](_0x3d7d70(0x1c6),_spPageContextInfo[_0x3d7d70(0x1a1)]),_0x343d0a=_0x39810f;var _0x312973=$('#lblSelectedCurrentEmail')['html'](),_0x44dc59;_0x44dc59={'properties':{'__metadata':{'type':_0x3d7d70(0x1b5)},'From':_0x312973,'To':{'results':_0x93c9d2},'CC':{'results':_0xbab719},'Body':_0x343d0a,'Subject':sharedEmailSubject}},SendEmailSharedNotification(_0x44dc59);}function RevokeDepartmntPermission(_0x4a652e,_0x56c890,_0x1dbbf4,_0x2d5ffd){var _0x58ff61=a0_0xee81c7,_0x27f24c={'Accept':'application/json;odata=verbose','content-Type':_0x58ff61(0x20a),'X-RequestDigest':jQuery(_0x58ff61(0x187))['val']()},_0x52b849=mydeptSiteUrl+_0x58ff61(0x231)+_0x56c890+'\x27)/ListItemAllFields/breakroleinheritance(true)';if(_0x2d5ffd!='')$[_0x58ff61(0x23d)]({'url':_0x52b849,'type':_0x58ff61(0x238),'headers':_0x27f24c,'dataType':_0x58ff61(0x217),'success':function(_0xbff1e){DeleatePermissionDeptDocs(_0x1dbbf4,_0x56c890,_0x4a652e,_0x2d5ffd,'Selective',0x0,0x0);},'error':function(_0x5594cd){var _0x4eee3e=_0x58ff61;console[_0x4eee3e(0x199)](JSON[_0x4eee3e(0x1ef)](_0x5594cd));}});else{_0x1dbbf4=decodeURI(_0x1dbbf4);var _0xf1cda6=arrSharedOrgUsers[_0x58ff61(0x23a)](function(_0x68d75c){var _0x53950a=_0x58ff61;return _0x1dbbf4==_0x68d75c[_0x53950a(0x214)];});$[_0x58ff61(0x23d)]({'url':_0x52b849,'type':_0x58ff61(0x238),'headers':_0x27f24c,'dataType':_0x58ff61(0x217),'success':function(_0x175687){var _0x19020c=_0x58ff61;for(k=0x0;k<_0xf1cda6['length'];k++){DeleatePermissionDeptDocs(_0xf1cda6[k]['userId'],_0x56c890,_0x4a652e,_0xf1cda6[k][_0x19020c(0x230)],_0x19020c(0x214),k,_0xf1cda6['length']);}},'error':function(_0x1a74c0){var _0x5c61eb=_0x58ff61;console['log'](JSON[_0x5c61eb(0x1ef)](_0x1a74c0));}});}}function DeleatePermissionDeptDocs(_0x206e99,_0x33b1d7,_0xb213dc,_0x315b37,_0x2c1eef,_0x477831,_0x2a00c4){var _0x11ed9a=a0_0xee81c7,_0x469ed7={'X-RequestDigest':$(_0x11ed9a(0x187))[_0x11ed9a(0x1e9)](),'X-HTTP-Method':'DELETE'},_0xc10025=mydeptSiteUrl+_0x11ed9a(0x231)+_0x33b1d7+'\x27)/ListItemAllFields/roleassignments/getbyprincipalid('+_0x206e99+')';$[_0x11ed9a(0x23d)]({'url':_0xc10025,'type':_0x11ed9a(0x238),'headers':_0x469ed7,'async':![],'success':function(_0x2f8f6f){var _0x2ab6af=_0x11ed9a,_0x5b6ae5=_0x2ab6af(0x20f),_0x5228ee,_0x38d1e2=GetItemTypeForListNameDetailsGroups(_0x5b6ae5);_0x5228ee={'__metadata':{'type':_0x38d1e2},'PermissionStatus':'Revoked'},$[_0x2ab6af(0x1d5)](updateItemWithIDItemListDocuments(_0x5b6ae5,_0x5228ee,_0x315b37,myCompanyUrl))[_0x2ab6af(0x22b)](function(_0x4c89a1){var _0x53f760=_0x2ab6af;_0x2c1eef==_0x53f760(0x214)?_0x477831+0x1==_0x2a00c4&&alert(_0x53f760(0x203)):alert('permission\x20deleted\x20sucessfully.'),$(_0x53f760(0x218))[_0x53f760(0x240)](_0x53f760(0x1e4));}),console['log'](_0x206e99+'\x20Successfully\x20removed\x20Permission\x20!');},'error':function(_0x163311){var _0x3a9e91=_0x11ed9a;console[_0x3a9e91(0x199)](JSON[_0x3a9e91(0x1ef)](_0x163311));}});}function BreakInheritePermissionFolderSharing(_0x14bf99,_0x2259a4,_0x1af207,_0x1f38cf){var _0x4c6d11=a0_0xee81c7,_0x140f73={'Accept':_0x4c6d11(0x20a),'content-Type':'application/json;odata=verbose','X-RequestDigest':jQuery(_0x4c6d11(0x187))[_0x4c6d11(0x1e9)]()},_0x249d6e=myCompanyUrl+'/_api/web/GetFolderByServerRelativeUrl(\x27'+_0x2259a4+_0x4c6d11(0x1e8);if(_0x1f38cf!='')$[_0x4c6d11(0x23d)]({'url':_0x249d6e,'type':_0x4c6d11(0x238),'headers':_0x140f73,'dataType':_0x4c6d11(0x217),'success':function(_0xd5cd53){var _0x146e1c=_0x4c6d11;DeleateUserPermissionFolder(_0x1af207,_0x2259a4,_0x14bf99,_0x1f38cf,_0x146e1c(0x235),0x0,0x0);},'error':function(_0x5e7f2a){var _0x2d7fbb=_0x4c6d11;console[_0x2d7fbb(0x199)](JSON[_0x2d7fbb(0x1ef)](_0x5e7f2a));}});else{_0x1af207=decodeURI(_0x1af207);var _0x5d8b18=arrSharedOrgUsers[_0x4c6d11(0x23a)](function(_0x3ab4a6){var _0x2ebca6=_0x4c6d11;return _0x1af207==_0x3ab4a6[_0x2ebca6(0x214)];});$[_0x4c6d11(0x23d)]({'url':_0x249d6e,'type':'POST','headers':_0x140f73,'dataType':_0x4c6d11(0x217),'success':function(_0x2f2434){var _0x5e4bbc=_0x4c6d11;for(k=0x0;k<_0x5d8b18[_0x5e4bbc(0x186)];k++){DeleateUserPermissionFolder(_0x5d8b18[k][_0x5e4bbc(0x1d0)],_0x2259a4,_0x14bf99,_0x5d8b18[k][_0x5e4bbc(0x230)],_0x5e4bbc(0x214),k,_0x5d8b18[_0x5e4bbc(0x186)]);}},'error':function(_0x318348){var _0x2264e7=_0x4c6d11;console[_0x2264e7(0x199)](JSON['stringify'](_0x318348));}});}}function BreakPermissionDeptDocFolder(_0x5ddb51,_0x1ec7ee,_0x4b4243,_0x1248c8){var _0xb1ce9d=a0_0xee81c7,_0x54ffca={'Accept':'application/json;odata=verbose','content-Type':_0xb1ce9d(0x20a),'X-RequestDigest':jQuery('#__REQUESTDIGEST')[_0xb1ce9d(0x1e9)]()},_0x2e64eb=mydeptSiteUrl+_0xb1ce9d(0x1d4)+_0x1ec7ee+_0xb1ce9d(0x1e8);if(_0x1248c8!='')$[_0xb1ce9d(0x23d)]({'url':_0x2e64eb,'type':_0xb1ce9d(0x238),'headers':_0x54ffca,'dataType':_0xb1ce9d(0x217),'success':function(_0x58079b){var _0x63a348=_0xb1ce9d;DeleteDeptPermissionFolder(_0x4b4243,_0x1ec7ee,_0x5ddb51,_0x1248c8,_0x63a348(0x235),0x0,0x0);},'error':function(_0x13e152){var _0x1110c7=_0xb1ce9d;console['log'](JSON[_0x1110c7(0x1ef)](_0x13e152));}});else{_0x4b4243=decodeURI(_0x4b4243);var _0x248e32=arrSharedOrgUsers['filter'](function(_0x4fe76c){var _0x71cab8=_0xb1ce9d;return _0x4b4243==_0x4fe76c[_0x71cab8(0x214)];});$[_0xb1ce9d(0x23d)]({'url':_0x2e64eb,'type':_0xb1ce9d(0x238),'headers':_0x54ffca,'dataType':_0xb1ce9d(0x217),'success':function(_0x1bd7de){var _0xd4a695=_0xb1ce9d;for(k=0x0;k<_0x248e32['length'];k++){DeleteDeptPermissionFolder(_0x248e32[k][_0xd4a695(0x1d0)],_0x1ec7ee,_0x5ddb51,_0x248e32[k][_0xd4a695(0x230)],'Organization',k,_0x248e32['length']);}},'error':function(_0x4e3e15){var _0x1eae28=_0xb1ce9d;console[_0x1eae28(0x199)](JSON[_0x1eae28(0x1ef)](_0x4e3e15));}});}}function DeleteDeptPermissionFolder(_0x270766,_0x459e21,_0x142a0d,_0x4821d3,_0x4d6488,_0x3e44d1,_0x5bd372){var _0x16c9c1=a0_0xee81c7,_0x5f2b9a={'X-RequestDigest':$('#__REQUESTDIGEST')[_0x16c9c1(0x1e9)](),'X-HTTP-Method':_0x16c9c1(0x1e2)},_0x24b155=mydeptSiteUrl+_0x16c9c1(0x1d4)+_0x459e21+_0x16c9c1(0x1ff)+_0x270766+')';$[_0x16c9c1(0x23d)]({'url':_0x24b155,'type':_0x16c9c1(0x238),'headers':_0x5f2b9a,'async':![],'success':function(_0x2ab931){var _0x544bfb=_0x16c9c1,_0x360e7d=_0x544bfb(0x20f),_0x573f21,_0x574dc3=GetItemTypeForListNameDetailsGroups(_0x360e7d);_0x573f21={'__metadata':{'type':_0x574dc3},'PermissionStatus':_0x544bfb(0x1ec)},$[_0x544bfb(0x1d5)](updateItemWithIDItemListDocuments(_0x360e7d,_0x573f21,_0x4821d3,myCompanyUrl))[_0x544bfb(0x22b)](function(_0x5f5c40){var _0x27cd06=_0x544bfb;_0x4d6488==_0x27cd06(0x214)?_0x3e44d1+0x1==_0x5bd372&&alert(_0x27cd06(0x203)):alert(_0x27cd06(0x203)),$(_0x27cd06(0x218))[_0x27cd06(0x240)]('hide');}),console[_0x544bfb(0x199)](_0x270766+_0x544bfb(0x1bd));},'error':function(_0x3c697d){var _0x20e10b=_0x16c9c1;console[_0x20e10b(0x199)](JSON[_0x20e10b(0x1ef)](_0x3c697d));}});}