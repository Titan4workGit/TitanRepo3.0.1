var a0_0xbb5b47=a0_0x9228;(function(_0x54a28e,_0xb44927){var _0x350ea9=a0_0x9228,_0x314441=_0x54a28e();while(!![]){try{var _0x3d7cf6=-parseInt(_0x350ea9(0x1dd))/0x1+parseInt(_0x350ea9(0x1d6))/0x2+-parseInt(_0x350ea9(0x1ea))/0x3+-parseInt(_0x350ea9(0x15a))/0x4*(parseInt(_0x350ea9(0x103))/0x5)+parseInt(_0x350ea9(0x17e))/0x6+-parseInt(_0x350ea9(0x15d))/0x7+parseInt(_0x350ea9(0x195))/0x8;if(_0x3d7cf6===_0xb44927)break;else _0x314441['push'](_0x314441['shift']());}catch(_0x244f43){_0x314441['push'](_0x314441['shift']());}}}(a0_0xc3ea,0x5a8d1));var token,peoplePickerDiv='',peoplePickerDivsuper='',GroupId='',email='',IsUpdate=![],userListItemId='',GuestUserEmail='',UserListId=[],Client_Id;function initializePeoplePicker(_0x51f83c,_0x5d1eb2){var _0x2e92c0=a0_0x9228,_0x3430c2={};_0x3430c2[_0x2e92c0(0xf4)]='User,DL,SecGroup,SPGroup',_0x3430c2[_0x2e92c0(0x16a)]=0xf,_0x3430c2[_0x2e92c0(0x141)]=0xf,_0x3430c2['AllowMultipleValues']=_0x5d1eb2,_0x3430c2[_0x2e92c0(0xfb)]=0x32,_0x3430c2[_0x2e92c0(0x1e9)]=_0x2e92c0(0x1c8),this[_0x2e92c0(0x132)](_0x51f83c,null,_0x3430c2),$('.sp-peoplepicker-editorInput')[_0x2e92c0(0x16b)](0xfa);}$(function(){var _0x5da4de=a0_0x9228;$(_0x5da4de(0x174))[_0x5da4de(0x1a8)]({'changeMonth':!![],'changeYear':!![]});});function GetGueastEmployee(_0x27de90){var _0x283de5=a0_0x9228,_0x495861='https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27'+_0x27de90+'\x27';return DeferredObj=$[_0x283de5(0x12b)](),$['ajax']({'method':_0x283de5(0x1e2),'url':_0x495861,'headers':{'Authorization':_0x283de5(0x12f)+token,'Content-Type':_0x283de5(0x1ee)},'async':![],'success':function(_0x188b25){var _0x538a6b=_0x283de5;DeferredObj[_0x538a6b(0x123)](_0x188b25[_0x538a6b(0x145)]);},'error':function(_0x469200){var _0x234ffa=_0x283de5;DeferredObj[_0x234ffa(0x1a2)](_0x469200),alert(_0x234ffa(0x17a)+JSON[_0x234ffa(0x177)](_0x469200));}}),DeferredObj[_0x283de5(0x147)]();}function GetGueastUsers(_0x3a53fb){var _0x407d77=a0_0x9228,_0x5a48e8=_0x407d77(0x12d)+_0x3a53fb+'\x27';return DeferredObj=$[_0x407d77(0x12b)](),$['ajax']({'method':_0x407d77(0x1e2),'url':_0x5a48e8,'headers':{'Authorization':_0x407d77(0x12f)+token,'Content-Type':_0x407d77(0x1ee)},'async':![],'success':function(_0x509adf){var _0x505770=_0x407d77;DeferredObj['resolve'](_0x509adf[_0x505770(0x145)]);},'error':function(_0xcf859a){var _0x199a38=_0x407d77;DeferredObj[_0x199a38(0x1a2)](_0xcf859a),alert(_0x199a38(0x17a)+JSON[_0x199a38(0x177)](_0xcf859a));}}),DeferredObj[_0x407d77(0x147)]();}function GetCategoryMaster(){var _0x40a025=a0_0x9228,_0x588187=_0x40a025(0x19a),_0xdaa51d=_spPageContextInfo[_0x40a025(0x101)]+_0x40a025(0x121)+_0x588187+'\x27)/items?$filter=CategoryType\x20eq\x20\x27Guest\x20Type\x27\x20and\x20Status\x20eq\x20\x20\x27Yes\x27\x20';$[_0x40a025(0x136)]({'url':_0xdaa51d,'headers':{'Accept':_0x40a025(0xfe)},'async':![],'success':function(_0x1ba1cf){var _0x30e81a=_0x40a025,_0x19ef95=document[_0x30e81a(0x13a)](_0x30e81a(0x1fb));_0x19ef95[_0x30e81a(0x1aa)]='';for(var _0x5cfab3=0x0;_0x5cfab3<_0x1ba1cf['d'][_0x30e81a(0x165)][_0x30e81a(0x12a)];_0x5cfab3++){var _0xe7a437=_0x1ba1cf['d']['results'][_0x5cfab3]['CatogeryName'],_0x2e9448=_0x1ba1cf['d'][_0x30e81a(0x165)][_0x5cfab3][_0x30e81a(0x1da)];opt=document[_0x30e81a(0x1b9)](_0x30e81a(0x11e)),opt[_0x30e81a(0x145)]=_0x2e9448,opt[_0x30e81a(0x17d)]=_0xe7a437,_0x19ef95[_0x30e81a(0x175)](opt);}},'error':function(_0x57ad0a){var _0x1d395d=_0x40a025;console[_0x1d395d(0x128)](_0x57ad0a);}});}function GetUserId(_0x588fe2){var _0x5a1c4f=a0_0x9228,_0x106369='',_0xecfc15='i:0#.f|membership|',_0x56d60d=_spPageContextInfo['siteAbsoluteUrl'],_0x1a26b7=_0xecfc15+_0x588fe2;return $['ajax']({'url':_0x56d60d+_0x5a1c4f(0x1c5)+encodeURIComponent(_0x1a26b7)+'\x27','method':_0x5a1c4f(0x1e2),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x507979){_0x106369=_0x507979['d']['Id'];},'error':function(_0x134873){var _0x125bdb=_0x5a1c4f;console['log'](JSON[_0x125bdb(0x177)](_0x134873));}}),_0x106369;}function GetUserName(_0x1ec068){var _0x7d4f7a=a0_0x9228,_0x117aae='',_0x187adf=_0x7d4f7a(0x168),_0x3999a9=_spPageContextInfo[_0x7d4f7a(0x1b2)],_0x37474b=_0x187adf+_0x1ec068;return $['ajax']({'url':_0x3999a9+_0x7d4f7a(0x1c5)+encodeURIComponent(_0x37474b)+'\x27','method':_0x7d4f7a(0x1e2),'headers':{'Accept':_0x7d4f7a(0x1a1)},'async':![],'success':function(_0x2d82dd){var _0x881285=_0x7d4f7a;_0x117aae=_0x2d82dd['d'][_0x881285(0x11a)];},'error':function(_0x4db695){var _0x54e7d9=_0x7d4f7a;console['log'](JSON[_0x54e7d9(0x177)](_0x4db695));}}),_0x117aae;}function AddNewGuest(){var _0x237bd1=a0_0x9228;try{var _0x4e0b16='ExternalUsers',_0x23d59a=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDiv[0x0]['id']],_0x5a17f9=_0x23d59a['GetAllUserInfo'](),_0x76f2ce=[];for(var _0x50ae42=0x0;_0x50ae42<_0x5a17f9[_0x237bd1(0x12a)];_0x50ae42++){var _0x2d08ee=GetUserId(_0x5a17f9[_0x50ae42]['EntityData'][_0x237bd1(0x1ac)]);_0x76f2ce[_0x237bd1(0x1c7)](_0x2d08ee),UserListId['push'](_0x2d08ee);}_0x23d59a=SPClientPeoplePicker[_0x237bd1(0x122)][peoplePickerDivsuper[0x0]['id']],_0x5a17f9=_0x23d59a[_0x237bd1(0xfa)]();var _0x3f771d=GetUserId(_0x5a17f9[0x0][_0x237bd1(0x1a3)][_0x237bd1(0x1ac)]);UserListId['push'](_0x3f771d);GroupId==''&&GetGroupIDByGroupName();AddUserinSharePointGroup($(_0x237bd1(0x18f))[_0x237bd1(0x1d0)]());var _0x14abb1=GetUserId($('#txtExtEmail')[_0x237bd1(0x1d0)]());UserListId[_0x237bd1(0x1c7)](_0x14abb1);var _0x595553=_spPageContextInfo['webAbsoluteUrl']+_0x237bd1(0x119)+$(_0x237bd1(0x14f))[_0x237bd1(0x1d0)]()[_0x237bd1(0x11d)]()['replace'](/ /g,'')+_0x237bd1(0x135),_0x41c928,_0x1ed223=GetItemTypeForListName(_0x4e0b16);_0x41c928={'__metadata':{'type':_0x1ed223},'LoginNameId':_0x14abb1,'Title':$(_0x237bd1(0x18f))[_0x237bd1(0x1d0)](),'email':$('#txtExtEmail')[_0x237bd1(0x1d0)](),'Designation':$('#txtExtDesignation')['val'](),'Organization':$(_0x237bd1(0x14f))[_0x237bd1(0x1d0)](),'ReferenceCode':$(_0x237bd1(0x115))[_0x237bd1(0x1d0)](),'TemplateType':$('option:selected',$(_0x237bd1(0x178)))[_0x237bd1(0x1d0)](),'InternalStakeholdersId':{'results':_0x76f2ce},'SupervisorId':_0x3f771d,'Client_NameId':Client_Id,'External_Supervisor':$('#txtExternalSupervisor')['val'](),'ValidUpto':$(_0x237bd1(0x174))[_0x237bd1(0x1d0)](),'CollaborationType':$(_0x237bd1(0x17c),$(_0x237bd1(0x1e5)))[_0x237bd1(0x1d0)](),'Status':$(_0x237bd1(0x17c),$(_0x237bd1(0xf5)))[_0x237bd1(0x1d0)](),'DocumentLibrary':_0x595553},AddItemToList(_0x4e0b16,_0x41c928,UserListId);}catch(_0x7b2a38){console[_0x237bd1(0x128)](_0x7b2a38[_0x237bd1(0x1e8)]);}}function cleartextBox(){var _0x4ef299=a0_0x9228;$(_0x4ef299(0x1a6))['val'](''),$(_0x4ef299(0x18f))[_0x4ef299(0x1d0)](''),$(_0x4ef299(0x10a))[_0x4ef299(0x1d0)](''),$(_0x4ef299(0x115))[_0x4ef299(0x1d0)](''),$('#txtExtOrganizationName')[_0x4ef299(0x1d0)](''),$(_0x4ef299(0x1d2))[_0x4ef299(0x1e4)](_0x4ef299(0xff),_0x4ef299(0x111)),initializePeoplePicker(_0x4ef299(0x186),!![]),peoplePickerDiv=$(_0x4ef299(0x142)),initializePeoplePicker(_0x4ef299(0x18b),![]),peoplePickerDivsuper=$('[id$=\x27internalsupervisor_TopSpan\x27]');}function AddItemToList(_0x18d14f,_0x1a5ddd,_0x49cc43){var _0x462ad9=a0_0x9228,_0x745658=$[_0x462ad9(0x12b)]();return $[_0x462ad9(0x136)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x462ad9(0x1be)+_0x18d14f+_0x462ad9(0x11b),'type':_0x462ad9(0x171),'async':![],'headers':{'accept':_0x462ad9(0xfe),'X-RequestDigest':$(_0x462ad9(0x1ae))[_0x462ad9(0x1d0)](),'content-Type':_0x462ad9(0xfe)},'data':JSON[_0x462ad9(0x177)](_0x1a5ddd),'success':function(_0x1fcb4d){var _0xa0a261=_0x462ad9;if(document['getElementById'](_0xa0a261(0x179))[_0xa0a261(0xfc)]['length']===0x0){}else UploadAttachement(_0x1fcb4d['d']['ID']);console['log'](_0x1fcb4d),IsExistOrNotLibrary($(_0xa0a261(0x14f))[_0xa0a261(0x1d0)]()[_0xa0a261(0x11d)]()[_0xa0a261(0x1c9)](/ /g,''))?AssignTheEditRole($('#txtAddOrganization')[_0xa0a261(0x1d0)]()[_0xa0a261(0x11d)]()['replace'](/ /g,''),_0x49cc43):(createNewLibraryByRest($(_0xa0a261(0x14f))['val']()[_0xa0a261(0x11d)]()['replace'](/ /g,'')),AssignTheEditRole($(_0xa0a261(0x14f))[_0xa0a261(0x1d0)]()['trim']()['replace'](/ /g,''),_0x49cc43)),alert('Guest\x20user\x20has\x20registered\x20successfully!'),cleartextBox();},'error':function(_0x24b774){var _0x52bebf=_0x462ad9;console[_0x52bebf(0x128)](JSON[_0x52bebf(0x177)](_0x24b774)),_0x745658['reject'](_0x24b774);}}),_0x745658[_0x462ad9(0x147)]();}function UpdateGeustuser(_0x57c45b){var _0x5ec851=a0_0x9228,_0x3566dd=_0x5ec851(0x1b7),_0x33f140=SPClientPeoplePicker[_0x5ec851(0x122)][peoplePickerDiv[0x0]['id']],_0xca74cd=_0x33f140[_0x5ec851(0xfa)](),_0x169357=[];for(var _0x577edd=0x0;_0x577edd<_0xca74cd[_0x5ec851(0x12a)];_0x577edd++){var _0x1237db=GetUserId(_0xca74cd[_0x577edd]['EntityData'][_0x5ec851(0x1ac)]);_0x169357[_0x5ec851(0x1c7)](_0x1237db),UserListId[_0x5ec851(0x1c7)](_0x1237db);}_0x33f140=SPClientPeoplePicker[_0x5ec851(0x122)][peoplePickerDivsuper[0x0]['id']],_0xca74cd=_0x33f140['GetAllUserInfo']();var _0x182cc3=GetUserId(_0xca74cd[0x0][_0x5ec851(0x1a3)][_0x5ec851(0x1ac)]);UserListId['push'](_0x182cc3);var _0x5461a0=GetUserId($(_0x5ec851(0x18f))[_0x5ec851(0x1d0)]());UserListId[_0x5ec851(0x1c7)](_0x5461a0),GuestUserEmail=$(_0x5ec851(0x18f))[_0x5ec851(0x1d0)]();var _0x32df7a=_spPageContextInfo['webAbsoluteUrl']+_0x5ec851(0x119)+$(_0x5ec851(0x14f))['val']()[_0x5ec851(0x11d)]()[_0x5ec851(0x1c9)](/ /g,'')+_0x5ec851(0x135);_0x5461a0==''&&(GetGroupIDByGroupName(),AddUserinSharePointGroup($(_0x5ec851(0x18f))[_0x5ec851(0x1d0)]()));var _0x195c43,_0x367959=GetItemTypeForListName(_0x3566dd);_0x195c43={'__metadata':{'type':_0x367959},'Designation':$('#txtExtDesignation')['val'](),'LoginNameId':_0x5461a0,'Organization':$(_0x5ec851(0x14f))[_0x5ec851(0x1d0)](),'ReferenceCode':$(_0x5ec851(0x115))['val'](),'TemplateType':$(_0x5ec851(0x17c),$(_0x5ec851(0x178)))[_0x5ec851(0x1d0)](),'InternalStakeholdersId':{'results':_0x169357},'SupervisorId':_0x182cc3,'Client_NameId':Client_Id,'ValidUpto':$(_0x5ec851(0x174))[_0x5ec851(0x1d0)](),'CollaborationType':$('option:selected',$('#selectByUser'))[_0x5ec851(0x1d0)](),'Status':$(_0x5ec851(0x17c),$('#txtExtStatus'))['val'](),'DocumentLibrary':_0x32df7a};var _0x3dc44d=$['Deferred']();return $[_0x5ec851(0x136)]({'url':_spPageContextInfo[_0x5ec851(0x101)]+'/_api/web/lists/GetByTitle(\x27'+_0x3566dd+_0x5ec851(0x105)+_0x57c45b+')','type':_0x5ec851(0x171),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x5ec851(0x1ae))[_0x5ec851(0x1d0)](),'content-Type':_0x5ec851(0xfe),'IF-MATCH':'*','X-HTTP-Method':_0x5ec851(0x1a5)},'data':JSON[_0x5ec851(0x177)](_0x195c43),'success':function(_0x4da955){var _0xac265d=_0x5ec851;if(document[_0xac265d(0x13a)](_0xac265d(0x179))[_0xac265d(0xfc)][_0xac265d(0x12a)]===0x0){}else UploadAttachement(_0x57c45b);console[_0xac265d(0x128)](_0x4da955),IsExistOrNotLibrary($(_0xac265d(0x14f))[_0xac265d(0x1d0)]()[_0xac265d(0x11d)]()[_0xac265d(0x1c9)](/ /g,''))?AssignTheEditRole($(_0xac265d(0x14f))[_0xac265d(0x1d0)]()[_0xac265d(0x11d)]()[_0xac265d(0x1c9)](/ /g,''),UserListId):(createNewLibraryByRest($(_0xac265d(0x14f))[_0xac265d(0x1d0)]()[_0xac265d(0x11d)]()['replace'](/ /g,'')),AssignTheEditRole($(_0xac265d(0x14f))['val']()[_0xac265d(0x11d)]()[_0xac265d(0x1c9)](/ /g,''),UserListId)),alert(_0xac265d(0x172));},'error':function(_0x1e6052){var _0x2bce56=_0x5ec851;console[_0x2bce56(0x128)](JSON['stringify'](_0x1e6052)),_0x3dc44d[_0x2bce56(0x1a2)](_0x1e6052);}}),_0x3dc44d['promise']();}function GetItemToList(_0x4c05e0){var _0x2a83e4=a0_0x9228,_0x1eeca3=_0x2a83e4(0x1b7),_0x6c99fe=$['Deferred']();return $[_0x2a83e4(0x136)]({'url':_spPageContextInfo[_0x2a83e4(0x101)]+'/_api/web/lists/getbytitle(\x27'+_0x1eeca3+_0x2a83e4(0x182)+_0x4c05e0+'\x27','type':_0x2a83e4(0x10d),'async':![],'headers':{'accept':_0x2a83e4(0xfe),'X-RequestDigest':$(_0x2a83e4(0x1ae))[_0x2a83e4(0x1d0)](),'content-Type':_0x2a83e4(0xfe)},'success':function(_0x27f1cf){var _0x287f15=_0x2a83e4;_0x6c99fe[_0x287f15(0x123)](_0x27f1cf['d'][_0x287f15(0x165)]),console[_0x287f15(0x128)](_0x27f1cf);},'error':function(_0x5e478e){var _0x3015c5=_0x2a83e4;console[_0x3015c5(0x128)](JSON['stringify'](_0x5e478e)),_0x6c99fe[_0x3015c5(0x1a2)](_0x5e478e);}}),_0x6c99fe['promise']();}function GetItemToListchoice(){var _0x203fff=a0_0x9228,_0x387dac='ExternalUsers',_0x4d96d8=$[_0x203fff(0x12b)]();return $[_0x203fff(0x136)]({'url':_spPageContextInfo[_0x203fff(0x101)]+'/_api/web/lists/getbytitle(\x27'+_0x387dac+_0x203fff(0x1f4),'type':'get','async':![],'headers':{'accept':_0x203fff(0xfe),'X-RequestDigest':$(_0x203fff(0x1ae))[_0x203fff(0x1d0)](),'content-Type':'application/json;odata=verbose'},'success':function(_0x3fab5b){var _0x37c537=_0x203fff;_0x4d96d8['resolve'](_0x3fab5b['d']['results'][0x0]['Choices'][_0x37c537(0x165)]),console[_0x37c537(0x128)](_0x3fab5b);},'error':function(_0x340e5e){var _0x1d3a8f=_0x203fff;console[_0x1d3a8f(0x128)](JSON[_0x1d3a8f(0x177)](_0x340e5e)),_0x4d96d8['reject'](_0x340e5e);}}),_0x4d96d8['promise']();}function GetItemToClientMaster(){var _0x3ce33b=a0_0x9228,_0x4c81e3=_0x3ce33b(0x185),_0x58993d=$[_0x3ce33b(0x12b)]();return $[_0x3ce33b(0x136)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x3ce33b(0x1be)+_0x4c81e3+_0x3ce33b(0x125),'type':_0x3ce33b(0x10d),'async':![],'headers':{'accept':_0x3ce33b(0xfe),'X-RequestDigest':$(_0x3ce33b(0x1ae))[_0x3ce33b(0x1d0)](),'content-Type':_0x3ce33b(0xfe)},'success':function(_0x140fd3){var _0x93b012=_0x3ce33b;_0x58993d['resolve'](_0x140fd3['d'][_0x93b012(0x165)]),console[_0x93b012(0x128)](_0x140fd3);},'error':function(_0x1fed59){var _0x1d0a8e=_0x3ce33b;console[_0x1d0a8e(0x128)](JSON['stringify'](_0x1fed59)),_0x58993d[_0x1d0a8e(0x1a2)](_0x1fed59);}}),_0x58993d[_0x3ce33b(0x147)]();}function requestToken(){var _0x1c01c9=a0_0x9228;$[_0x1c01c9(0x136)]({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':_0x1c01c9(0x171),'headers':{'content-type':_0x1c01c9(0x1e6)},'data':{'grant_type':'client_credentials','client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':_0x1c01c9(0x1f5)},'success':function(_0x13b19b){var _0xe83385=_0x1c01c9;console[_0xe83385(0x128)](_0x13b19b),token=_0x13b19b[_0xe83385(0x118)];},'error':function(_0x172dc7){var _0x25b6e8=_0x1c01c9;console[_0x25b6e8(0x128)](JSON['stringify'](_0x172dc7));}});}function ClientCredentialss(){var _0x5c0668=a0_0x9228,_0x255f8d=_0x5c0668(0x11f),_0x19e8b2=_spPageContextInfo[_0x5c0668(0x101)]+'/_api/web/lists/GetByTitle(\x27'+_0x255f8d+_0x5c0668(0x184);$['ajax']({'url':_0x19e8b2,'headers':{'Accept':_0x5c0668(0xfe)},'async':![],'success':function(_0x28ddba){var _0x1f4b36=_0x5c0668,_0x379249=_0x28ddba['d'][_0x1f4b36(0x165)];ClientId=_0x379249[0x0][_0x1f4b36(0x1ba)],ClentSecret=_0x379249[0x0]['ChangeFileName'],ClientUrl=_0x379249[0x0][_0x1f4b36(0x1bc)],requestToken();},'error':function(_0x377fc5){var _0x5079a8=_0x5c0668;console[_0x5079a8(0x128)](_0x377fc5);}});}function GraphAccessTokenTogetUserDetails(){var _0x4e3e55=a0_0x9228,_0x43a62a=new jQuery[(_0x4e3e55(0x12b))](),_0x5cf6a6={'X-RequestDigest':$(_0x4e3e55(0x1ae))['val'](),'accept':'application/json;odata=nometadata','content-type':'application/json;odata=nometadata'},_0x4f0426={'resource':'https://graph.microsoft.com'};return $[_0x4e3e55(0x136)]({'url':_spPageContextInfo[_0x4e3e55(0x101)]+_0x4e3e55(0x1ca),'headers':_0x5cf6a6,'type':_0x4e3e55(0x171),'data':JSON['stringify'](_0x4f0426),'success':function(_0x1db7ec){var _0x132e65=_0x4e3e55;token=_0x1db7ec[_0x132e65(0x118)],token_=token,_0x43a62a[_0x132e65(0x123)](token);},'error':function(_0x13ac07,_0x37b917,_0x379f68){var _0x6a30=_0x4e3e55;console[_0x6a30(0x128)](_0x13ac07['responseText']),_0x43a62a['reject'](_0x13ac07[_0x6a30(0xfd)]);}}),_0x43a62a[_0x4e3e55(0x147)]();}var Errorcount=0x1,Ischeckerror=![];function Inviteuser(){var _0x3ce422=a0_0x9228,_0x47c679=$(_0x3ce422(0x181))[_0x3ce422(0x1d0)](),_0x4238ff=$(_0x3ce422(0x1cb))['val'](),_0x404acd=$(_0x3ce422(0x1bd))[_0x3ce422(0x1d0)]();Errorcount=0x1,$[_0x3ce422(0x136)]({'url':_0x3ce422(0x1fc),'type':_0x3ce422(0x171),'headers':{'Authorization':_0x3ce422(0x12f)+token,'content-type':_0x3ce422(0x1ee)},'data':JSON[_0x3ce422(0x177)]({'invitedUserDisplayName':_0x4238ff,'invitedUserEmailAddress':_0x47c679,'inviteRedirectUrl':_spPageContextInfo[_0x3ce422(0x101)]+_0x3ce422(0x1bb),'sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':_0x404acd}}),'async':![],'success':function(_0x1d3131){var _0x3bdce7=_0x3ce422;console[_0x3bdce7(0x128)](_0x1d3131),$(_0x3bdce7(0x181))['val'](''),$('#txtinvitename')[_0x3bdce7(0x1d0)](''),$(_0x3bdce7(0x1bd))['val']('');GroupId==''&&GetGroupIDByGroupName();GuestUserEmail=_0x1d3131[_0x3bdce7(0x114)];try{$[_0x3bdce7(0x1b3)](AddUserinSharePointGroup(_0x1d3131['invitedUserEmailAddress']))[_0x3bdce7(0x1a9)](function(_0x19dc49){var _0x33a178=_0x3bdce7;Ischeckerror=![],_0x19dc49==_0x33a178(0x157)?alert(_0x33a178(0x1d7)):alert(_0x33a178(0x153));});}catch(_0x5ec031){alert(_0x3bdce7(0x153));}},'error':function(_0x5c1089){var _0x4713a7=_0x3ce422;_0x5c1089[_0x4713a7(0x1bf)]==_0x4713a7(0x1d1)?alert(_0x5c1089['statusText']+':\x20\x20Compact\x20Token\x20parsing\x20failed'):(alert(_0x4713a7(0x104)),console[_0x4713a7(0x128)](JSON[_0x4713a7(0x177)](_0x5c1089)));}}),Ischeckerror&&alert(_0x3ce422(0x153));}function setPeoplePickerUsersInfoCurrent(_0x37c55f,_0x201199){var _0x354814=a0_0x9228,_0x2198ee=$(_0x354814(0x159)+_0x37c55f+'\x27]'),_0x4651b0=SPClientPeoplePicker[_0x354814(0x122)][_0x2198ee[0x0]['id']];_0x4651b0[_0x354814(0x1e7)](_0x201199,![]),_0x4651b0['SetEnabledState'](![]);}function readURL(_0x4972e5){var _0x54e0b2=a0_0x9228;if(_0x4972e5[_0x54e0b2(0xfc)]&&_0x4972e5[_0x54e0b2(0xfc)][0x0]){var _0x5ddc4c=new FileReader();_0x5ddc4c[_0x54e0b2(0x13c)]=function(_0x2b7ed2){var _0x760f26=_0x54e0b2;$(_0x760f26(0x1d2))[_0x760f26(0x1e4)](_0x760f26(0xff),_0x2b7ed2[_0x760f26(0x163)][_0x760f26(0x155)]);},_0x5ddc4c[_0x54e0b2(0x113)](_0x4972e5[_0x54e0b2(0xfc)][0x0]);}}function UploadAttachement(_0x9aa144){var _0x536771=a0_0x9228;try{if(document['getElementById'](_0x536771(0x179))[_0x536771(0xfc)][_0x536771(0x12a)]===0x0){}else{var _0x406111=_0x9aa144,_0x12538e=$(_0x536771(0x1d3)),_0x4c9224=_0x12538e[0x0][_0x536771(0xfc)][_0x536771(0x12a)],_0x5096e1=[],_0x5c52d9=_0x12538e[0x0][_0x536771(0xfc)][0x0][_0x536771(0x148)];_0x5c52d9=_0x12538e[0x0][_0x536771(0xfc)][0x0][_0x536771(0x148)][_0x536771(0x1c9)](/[^a-zA-Z0-9-. ]/g,''),_0x5c52d9=_0x5c52d9[_0x536771(0x1c9)](/\s/g,'');for(var _0x3eae9d=0x0;_0x3eae9d<_0x4c9224;_0x3eae9d++){_0x5096e1['push'](_0x12538e[0x0][_0x536771(0xfc)][_0x3eae9d]);}uploadFileSP(_0x536771(0x1b7),_0x406111,_0x5096e1,_0x4c9224,_0x5c52d9);}}catch(_0x571129){alert(_0x536771(0x173));}}function getFileBuffer(_0x4edda3){var _0x15c30f=a0_0x9228,_0x15f340=$['Deferred'](),_0x5aefc7=new FileReader();return _0x5aefc7[_0x15c30f(0x13c)]=function(_0x5a7811){var _0x160e64=_0x15c30f;_0x15f340['resolve'](_0x5a7811[_0x160e64(0x163)][_0x160e64(0x155)]);},_0x5aefc7[_0x15c30f(0x198)]=function(_0x45d470){var _0x4885fd=_0x15c30f;_0x15f340[_0x4885fd(0x1a2)](_0x45d470['target'][_0x4885fd(0x1f7)]);},_0x5aefc7[_0x15c30f(0x1b0)](_0x4edda3),_0x15f340[_0x15c30f(0x147)]();}function uploadFileSP(_0x45bd3c,_0x5bcec5,_0x1ba825,_0xc533cf,_0x5504a8){var _0x38371b=a0_0x9228,_0x142403=0x0,_0x48f075=$['Deferred'](),_0x293547='',_0x3d7d64=_0x1ba825[0x0],_0x46d9ff=getFileBuffer(_0x3d7d64);return _0x46d9ff[_0x38371b(0x1a9)](function(_0xe8e07f,_0xd1b335,_0x3cfad8){var _0x5da76e=_0x38371b,_0x2fa657=new Uint8Array(_0xe8e07f),_0x1294f9=new SP[(_0x5da76e(0x1b1))](),_0x55e432=_spPageContextInfo['webAbsoluteUrl']+_0x5da76e(0x1c6)+_0x45bd3c+'\x27)/items('+_0x5bcec5+_0x5da76e(0x1fa)+_0x5504a8+'\x27)',_0x5a8ba2=0x0;$[_0x5da76e(0x136)]({'url':_0x55e432,'type':'POST','processData':![],'contentType':_0x5da76e(0xfe),'data':_0xe8e07f,'headers':{'accept':_0x5da76e(0xfe),'X-RequestDigest':$(_0x5da76e(0x1ae))[_0x5da76e(0x1d0)](),'content-length':_0xe8e07f[_0x5da76e(0x18e)]},'success':function(_0x48576b){var _0x5ac81b=_0x5da76e;_0x142403++,_0x293547=_0x142403,_0x1ba825['shift']();if(_0x1ba825['length']>0x0)uploadFileSP(_0x5ac81b(0x1b7),_0x5bcec5,_0x1ba825,_0x1ba825['length']);else{}},'error':function(_0x5821ed){alert('Idea\x20has\x20been\x20submitted\x20but\x20some\x20files\x20failed\x20to\x20upload.');}}),_0x48f075[_0x5da76e(0x123)](_0x293547);}),_0x46d9ff[_0x38371b(0x138)](function(_0x4d6d6f){_0x48f075['reject'](_0x4d6d6f);}),_0x48f075[_0x38371b(0x147)]();}function GetGroupIDByGroupName(){var _0x5abf8d=a0_0x9228,_0x2c722a=_spPageContextInfo[_0x5abf8d(0x101)]+_0x5abf8d(0x158);$[_0x5abf8d(0x136)]({'url':_0x2c722a,'method':_0x5abf8d(0x1e2),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x13c3f0){GroupId=_0x13c3f0['d']['Id'];},'error':function(_0x283c94){var _0x9d6361=_0x5abf8d;console[_0x9d6361(0x128)](_0x283c94);}});}function AddUserToSiteGroup(_0x42e4d8){var _0x303dc8=a0_0x9228;clientContext=new SP[(_0x303dc8(0x151))]();var _0x494503=clientContext[_0x303dc8(0xf9)]()[_0x303dc8(0x199)]()[_0x303dc8(0x1d4)]('Contributors'),_0x3a78fe=_0x494503[_0x303dc8(0x14e)]();_0x3a78fe[_0x303dc8(0x139)](_0x42e4d8),clientContext['executeQueryAsync'](onsuccess,onfailed);}function onsuccess(){var _0xe232fc=a0_0x9228;console['log'](_0xe232fc(0x1f8));}function a0_0xc3ea(){var _0x5d36ce=['option:selected','text','1311258LhgWmV','Client_Code','IsActive','#txtinviteemail','\x27)/items?$select=*,AttachmentFiles,Supervisor/Title,Supervisor/EMail,InternalStakeholders/Title,InternalStakeholders/EMail,LoginName/Title,Client_Name/Title,Client_Name/Id\x20&$expand=Supervisor,InternalStakeholders,AttachmentFiles,LoginName,Client_Name\x20&$filter=\x20email\x20eq\x20\x27','#TemplateType\x20>\x20[value=','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','ClientMaster','InternalStakeholders','<h3>Dear\x20<span\x20class=\x22user_name\x22>','/_api/web/sitegroups/getbyname(\x27Contributors\x27)/users','Text','#msgExtEmail','internalsupervisor','Sending\x20mail\x20with\x20attach','.msg','byteLength','#txtExtEmail','<td\x20class=\x22text-left\x22>','Recognition\x20has\x20been\x20submitted\x20\x20!!','From:\x20no-reply@sharepointonline.com','prop','append','7586144vzRoqs','</p>\x20\x20','split','onerror','get_siteGroups','CategoryMaster','test','\x20\x20<tr\x20class=\x22text-center\x22>','externalUserState','input[name=UpdateEmp][value=','send','click','application/json;\x20odata=verbose','reject','EntityData','Supervisor','MERGE','#txtExtLoginName','find','datepicker','done','innerHTML','InternalStakeholders_TopSpan','Email','#UpdateEmp-box-2','#__REQUESTDIGEST','.sp-peoplepicker-delImage','readAsArrayBuffer','Base64EncodedByteArray','siteAbsoluteUrl','when','<option>','<p>Welcome\x20to\x20the\x20','none','ExternalUsers','\x22></label>','createElement','ClientName','/SitePages/Thankyou.aspx','Description','#txtinvitemessage','/_api/web/lists/getbytitle(\x27','statusText','TemplateType','div[id^=\x27InternalStakeholders\x27]','css','.</p>','removeClass','/_api/web/siteusers(@v)?@v=\x27','/_api/lists/GetByTitle(\x27','push','251px','replace','/_api/SP.OAuth.Token/Acquire','#txtinvitename','Not\x20Found','This\x20user\x20is\x20not\x20invited\x20at.\x0a\x20Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.','</td>','Active','val','Unauthorized','#extrenalImage','#GueastextinputFile','getByName','#ddlAssociation','1073754rAQMet','Invitation\x20mail\x20has\x20been\x20sent\x20to\x20the\x20user.','InternalSupervisor','Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.','CatogeryName','contentEditable','show','465100GeNwch','\x22\x20class=\x22getclientmaster\x22\x20onclick=\x22selectOnlyThis(this.id)\x22\x20\x20value=\x22','Message\x20has\x20been\x20sent.','/GuestUserDocuments/_api/web/lists/getbytitle(\x27','Already\x20send\x20invitation\x20but\x20this\x20user\x20is\x20not\x20Accepted..','GET','CustType','attr','#selectByUser','application/x-www-form-urlencoded','AddUserKeys','message','Width','1583403EijbwQ','Client_Name','slow','EMail','application/json','Customerdd','#txtExtOrganizationName','#txtExternalSupervisor','get_message','</span>','\x27)/fields?&$select=*&$filter=EntityPropertyName\x20eq\x20\x27TemplateType\x27','https://graph.microsoft.com/.default','\x27)/breakroleinheritance(false)','error','Success','#InternalStakeholders',')/AttachmentFiles/add(FileName=\x27','selectByUser','https://graph.microsoft.com/v1.0/invitations','InternalMembers','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0.1@latest/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg','selected','webServerRelativeUrl','d-none','Error\x20in\x20sending\x20Email:\x20','PrincipalAccountType','#txtExtStatus','</span></h3>','.error','<p>Click\x20on\x20<a\x20href=\x22https://adaptindia.sharepoint.com/sites/Titan_2_2_1_DEV/SitePages/GuestPortal.aspx\x22\x20target=\x22_blank\x22>\x20this-link\x20</a></p>','get_web','GetAllUserInfo','MaximumEntitySuggestions','files','responseText','application/json;odata=verbose','src','true','webAbsoluteUrl','Meet\x20for\x20lun\x20Indramani\x20Indra?','5PToKGo','Please\x20enter\x20a\x20valid\x20email\x20address\x20of\x20the\x20guest\x20user,\x20who\x20is\x20outsider\x20of\x20this\x20organization.','\x27)/items(','d\x20M,\x20y','internalsupervisor_TopSpan','Guest','?$select=*,Id,Supervisor/Title,Supervisor/EMail\x20,InternalMembers/EMail,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20','#txtExtDesignation','#UpdateEmp-box-','disabled','get','then','addClass','SP.Utilities.EmailProperties','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0.1@latest/SiteAssets/AdminPortal/ManageEmployee/assets/images/user_pic.jpg','#Customer-box','readAsDataURL','invitedUserEmailAddress','#txtReferenceCodeExt','display','PendingAcceptance','access_token','/GuestUserDocuments/','Title','\x27)/items','/_api/web/sitegroups(','trim','option','EnvironmentalSettings','SelfCompany','/_api/web/lists/GetByTitle(\x27','SPClientPeoplePickerDict','resolve','application/json;odata=nometadata','\x27)/items?$select=*','checked','empty','log','CollaborationType','length','Deferred','Email\x20Sent\x20Successfully','https://graph.microsoft.com/v1.0/users?$select=id,displayName,userPrincipalName,otherMails,userType,identities,creationType,externalUserState\x20&$filter=mail\x20eq\x20\x27','\x20portal\x20of\x20','Bearer\x20','input:checkbox','Attn_Name','SPClientPeoplePicker_InitStandaloneControlWrapper','Incase\x20of\x20any\x20help\x20needed\x20or\x20if\x20you\x20are\x20facing\x20any\x20problem\x20in\x20accessing\x20this\x20portal,\x20please\x20send\x20an\x20e-mail\x20to\x20<\x20e-mail\x20ID\x20of\x20\x20admin\x20(s)\x20>','\x27,roledefid=\x271073741830\x27)','/Forms/AllItems.aspx','ajax','#internalsupervisor','fail','addUser','getElementById','Accepted','onload','.toHide','ServerRelativeUrl','#btnExtUpdate','<label><input\x20type=\x22checkbox\x22\x20id=\x22Check_','ResolvePrincipalSource','[id$=\x27InternalStakeholders_TopSpan\x27]','#btnExtSubmit','[id$=\x27internalsupervisor_TopSpan\x27]','value','<p>Please\x20click\x20on\x20the\x20following\x20link\x20to\x20access\x20this\x20portal.\x20</p>','promise','name','formatDate','AttachmentFiles','\x09<span>','#selectByUser\x20>\x20[value=','change','get_users','#txtAddOrganization','[name=UpdateEmp]','ClientContext','</tr>','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.','focusout','result','/GuestUserDocuments/_api/web/lists/?$filter=Title\x20eq\x20\x27','User\x20Added','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','[id$=\x27','183836iuSIyb','\x27)/roleassignments/addroleassignment(principalid=\x27','\x20<p>','2057517cUNcbK','#Employee-box','</p>','The\x20new\x20cafeteria\x20is\x20open.','#btnotherOrganizationSearch','/GuestUserDocuments/_api/Web/Lists/','target','ready','results','/_api/SP.Utilities.Utility.SendEmail','<span>','i:0#.f|membership|','not','SearchPrincipalSource','width','d-block','SP.User','mail\x20sent\x20successfully','\x20Your\x20e-mail\x20configured\x20for\x20this\x20portal\x20is\x20<span\x20id=\x22user_id\x22>@info.gmail.com</span>\x20and\x20you’ll\x20be\x20able\x20to\x20login\x20using\x20your\x20existing\x20passport\x20for\x20this\x20e-mail\x20service.','<div\x20class=\x22checkbox\x20m-0\x22>','POST','Guest\x20user\x20has\x20Update\x20successfully!','Your\x20item\x20has\x20not\x20been\x20submitted\x20successfully!','#datepickerAD5','appendChild','hide','stringify','#TemplateType','GueastextinputFile','error1','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.\x0a\x20Enter\x20valid\x20email\x20address\x20or\x20check\x20the\x20external\x20sharing\x20features\x20is\x20enabled.'];a0_0xc3ea=function(){return _0x5d36ce;};return a0_0xc3ea();}function onfailed(_0x12ae1e,_0x3b4562){var _0x1c9885=a0_0x9228;console['log']('Failed'+_0x3b4562[_0x1c9885(0x1f2)]()+'\x0a'+_0x3b4562['get_stackTrace']());}function AddUserinSharePointGroup(_0x117dd0){var _0x1e286c=a0_0x9228,_0x175e4a=$[_0x1e286c(0x12b)](),_0x31527e=_0x1e286c(0x168),_0x52e373=_0x31527e+_0x117dd0,_0x2782c6=_spPageContextInfo[_0x1e286c(0x101)]+_0x1e286c(0x188);$[_0x1e286c(0x136)]({'url':_0x2782c6,'type':_0x1e286c(0x171),'async':![],'data':JSON[_0x1e286c(0x177)]({'__metadata':{'type':_0x1e286c(0x16d)},'LoginName':_0x52e373}),'headers':{'accept':_0x1e286c(0xfe),'content-type':_0x1e286c(0xfe),'X-RequestDigest':$(_0x1e286c(0x1ae))['val']()},'success':_0x351fb6,'error':_0x58362a});function _0x351fb6(_0x758b35){var _0x283efd=_0x1e286c;Ischeckerror=!![],_0x175e4a['resolve'](_0x283efd(0x157)),Errorcount=0x1,console['log'](_0x283efd(0x157));}function _0x58362a(_0x41cd1d){var _0x418b7d=_0x1e286c;console['log'](JSON['stringify'](_0x41cd1d)),(_0x41cd1d['statusText']==_0x418b7d(0x1cc)||_0x41cd1d['statusText']=='error')&&Errorcount==0xa?_0x41cd1d[_0x418b7d(0x1bf)]==_0x418b7d(0x1f7)?alert('Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.'):alert(_0x418b7d(0x17b)):(Errorcount++,AddUserinSharePointGroup(GuestUserEmail));}return _0x175e4a[_0x1e286c(0x147)]();}function AddUserinSharePointGroupforEdit(_0x482536){var _0x3d8df8=a0_0x9228,_0x49c01b='',_0x3e70f8=_0x3d8df8(0x168),_0x28f9b=_0x3e70f8+_0x482536,_0x99db9d=_spPageContextInfo['webAbsoluteUrl']+_0x3d8df8(0x11c)+GroupId+')/users';$[_0x3d8df8(0x136)]({'url':_0x99db9d,'type':'POST','async':![],'data':JSON[_0x3d8df8(0x177)]({'__metadata':{'type':_0x3d8df8(0x16d)},'LoginName':_0x28f9b}),'headers':{'accept':'application/json;odata=verbose','content-type':_0x3d8df8(0xfe),'X-RequestDigest':$(_0x3d8df8(0x1ae))['val']()},'success':_0x907ad,'error':_0x2a65b7});function _0x907ad(_0x230613){var _0x35769d=_0x3d8df8;_0x49c01b=_0x230613['d'],console[_0x35769d(0x128)](_0x35769d(0x157));}function _0x2a65b7(_0x2cf40b){var _0x541c63=_0x3d8df8;console[_0x541c63(0x128)](JSON[_0x541c63(0x177)](_0x2cf40b));}return _0x49c01b;}function processSendEmails(_0xc270c8,_0x552371,_0x4bc837){var _0x36932c=a0_0x9228,_0x59dc4e=[],_0x123c0a='<img\x20src=\x22img/customer.png\x22\x20id=\x22logo\x22>'+_0x36932c(0x187)+_0xc270c8+_0x36932c(0xf6)+_0x36932c(0x1b5)+_0x552371+_0x36932c(0x12e)+_0x4bc837+_0x36932c(0x1c3)+_0x36932c(0x146)+_0x36932c(0xf8)+'<p>'+_0x36932c(0x16f)+'Browsers\x20supported\x20by\x20this\x20portal\x20are\x20Chrome,\x20Microsoft\x20Edge,\x20Safari…..\x20(incase\x20you\x20want\x20to\x20specify\x20their\x20versions\x20as\x20well)'+_0x36932c(0x196)+_0x36932c(0x15c)+_0x36932c(0x133)+'\x20This\x20is\x20auto\x20generated\x20e-mail,\x20please\x20do\x20not\x20respond\x20on\x20this\x20sender\x20e-mail.'+_0x36932c(0x15f),_0x4c2cbc='Invite\x20to\x20guest\x20Portal';_0x59dc4e['push'](email);var _0x39c28b=_spPageContextInfo['userEmail'],_0x263627;_0x263627={'properties':{'__metadata':{'type':'SP.Utilities.EmailProperties'},'From':_0x39c28b,'To':{'results':_0x59dc4e},'Body':_0x123c0a,'Subject':_0x4c2cbc}};var _0x4dc39e={'properties':{'__metadata':{'type':_0x36932c(0x110)},'From':_0x36932c(0x192),'To':{'results':_0x59dc4e},'Body':_0x123c0a,'Subject':_0x4c2cbc}},_0x53a557=_spPageContextInfo['webServerRelativeUrl']==='/'?'/':_spPageContextInfo[_0x36932c(0x200)],_0x52e22b=_0x53a557,_0x435657=_0x52e22b+_0x36932c(0x166),_0x5c3cce=_spPageContextInfo['webAbsoluteUrl']+_0x36932c(0x166);$['ajax']({'contentType':_0x36932c(0x1ee),'url':_0x5c3cce,'type':'POST','data':JSON[_0x36932c(0x177)](_0x4dc39e),'async':![],'headers':{'Accept':_0x36932c(0xfe),'content-type':'application/json;odata=verbose','X-RequestDigest':$(_0x36932c(0x1ae))['val']()},'success':function(_0x4bc889){var _0x2d83c6=_0x36932c;console[_0x2d83c6(0x128)](_0x2d83c6(0x1df));},'error':function(_0x16e0c4){var _0x433eb8=_0x36932c;console[_0x433eb8(0x128)]('SendEmailSharedNotification\x20\x20'+JSON['stringify'](_0x16e0c4));}});}function a0_0x9228(_0x90d6ce,_0x18c8a6){var _0xc3eac6=a0_0xc3ea();return a0_0x9228=function(_0x922835,_0x13f3c8){_0x922835=_0x922835-0xf4;var _0xfd6b0f=_0xc3eac6[_0x922835];return _0xfd6b0f;},a0_0x9228(_0x90d6ce,_0x18c8a6);}function sendEmail(_0x5f35b1,_0x56d573,_0x5504ce,_0x307ce6){var _0x5b7fec=a0_0x9228;Email[_0x5b7fec(0x19f)]({'SecureToken':token,'To':_0x56d573[0x0],'From':_0x5f35b1,'Subject':_0x307ce6,'Body':_0x5504ce})[_0x5b7fec(0x10e)](_0x3d8dc7=>alert(_0x5b7fec(0x16e)));var _0x35357b=_spPageContextInfo[_0x5b7fec(0x200)],_0x295a68=_0x35357b+_0x5b7fec(0x166);$[_0x5b7fec(0x136)]({'contentType':_0x5b7fec(0x1ee),'url':_0x295a68,'type':'POST','data':JSON[_0x5b7fec(0x177)]({'properties':{'__metadata':{'type':_0x5b7fec(0x110)},'From':_0x5f35b1,'To':{'results':_0x56d573},'Body':_0x5504ce,'Subject':_0x307ce6}}),'headers':{'Accept':_0x5b7fec(0xfe),'content-type':_0x5b7fec(0xfe),'X-RequestDigest':jQuery(_0x5b7fec(0x1ae))[_0x5b7fec(0x1d0)]()},'success':function(_0x47b37c){var _0x3e121f=_0x5b7fec;alert(_0x3e121f(0x12c));},'error':function(_0x5088ae){var _0x5c43f4=_0x5b7fec;alert(_0x5c43f4(0x202)+JSON[_0x5c43f4(0x177)](_0x5088ae));}});}$(function(){var _0x56d44f=a0_0x9228;$(_0x56d44f(0x150))[_0x56d44f(0x1a0)](function(){var _0x28fe86=_0x56d44f;$('.toHide')['hide'](),cleartextBox(),$(_0x28fe86(0x10b)+$(this)[_0x28fe86(0x1d0)]())[_0x28fe86(0x1dc)]('slow'),$(this)[_0x28fe86(0x1d0)]()=='3'&&(GetCategoryMaster(),$[_0x28fe86(0x1b3)](GetItemToListchoice())[_0x28fe86(0x1a9)](function(_0x1fe0b3){var _0x4066dc=_0x28fe86;$('#TemplateType')['empty']();for(var _0x14e5f5=0x0;_0x14e5f5<_0x1fe0b3[_0x4066dc(0x12a)];_0x14e5f5++){var _0x5db5b0=$(_0x4066dc(0x1b4));_0x5db5b0[_0x4066dc(0x1e4)](_0x4066dc(0x145),_0x1fe0b3[_0x14e5f5])[_0x4066dc(0x17d)](_0x1fe0b3[_0x14e5f5]),$(_0x4066dc(0x178))[_0x4066dc(0x194)](_0x5db5b0);}})),$(_0x28fe86(0x18a))[_0x28fe86(0x176)]();});});function sendEmailg(){var _0x23168d=a0_0x9228;$[_0x23168d(0x136)]({'async':![],'crossDomain':!![],'url':'https://graph.microsoft.com/v1.0/me/sendMail','method':_0x23168d(0x171),'headers':{'authorization':'Bearer\x20'+token_,'content-type':_0x23168d(0x1ee)},'data':JSON[_0x23168d(0x177)]({'message':{'subject':_0x23168d(0x102),'body':{'contentType':_0x23168d(0x189),'content':_0x23168d(0x160)},'toRecipients':[{'emailAddress':{'address':'indramani047@gmail.com'}}]}}),'success':function(_0x8a1266){var _0x39011e=_0x23168d;alert(_0x39011e(0x191));},'error':function(_0x409967){var _0x3965b7=_0x23168d;console['log'](_0x3965b7(0x18c)+JSON['stringify'](_0x409967));}});}function createNewLibraryByRest(_0x582be9){var _0x199a2e=a0_0x9228,_0x140f36=_0x582be9,_0x1dbd05=_spPageContextInfo[_0x199a2e(0x101)]+_0x199a2e(0x162);$['ajax']({'url':_0x1dbd05,'method':'POST','async':![],'data':JSON[_0x199a2e(0x177)]({'__metadata':{'type':'SP.List'},'AllowContentTypes':!![],'BaseTemplate':0x65,'ContentTypesEnabled':!![],'Description':_0x199a2e(0x1bc),'OnQuickLaunch':!![],'Title':_0x582be9}),'headers':{'content-type':_0x199a2e(0xfe),'X-RequestDigest':$(_0x199a2e(0x1ae))[_0x199a2e(0x1d0)]()},'success':function(_0x38fed3){BreakRoleInheritance(_0x140f36);},'error':function(_0x18b2c8){alert(_0x18b2c8['responseText']);}});}function BreakRoleInheritance(_0x379e99){var _0x24b482=a0_0x9228;url=_spPageContextInfo['webAbsoluteUrl']+_0x24b482(0x1e0)+_0x379e99+_0x24b482(0x1f6),$[_0x24b482(0x136)]({'url':url,'type':_0x24b482(0x171),'async':![],'headers':{'accept':'application/json;odata=nometadata','X-RequestDigest':$(_0x24b482(0x1ae))[_0x24b482(0x1d0)]()},'success':function(_0x598171){var _0x43f8b1=_0x24b482;console[_0x43f8b1(0x128)](_0x598171);},'error':function(_0x3cdaff){var _0x484e97=_0x24b482;console[_0x484e97(0x128)](_0x3cdaff);}});}function AssignTheEditRole(_0x1e2363,_0xd153e8){var _0x575ceb=a0_0x9228;for(var _0xad12d2=0x0;_0xad12d2<_0xd153e8[_0x575ceb(0x12a)];_0xad12d2++){url=_spPageContextInfo['webAbsoluteUrl']+'/GuestUserDocuments/_api/web/lists/getbytitle(\x27'+_0x1e2363+_0x575ceb(0x15b)+_0xd153e8[_0xad12d2]+_0x575ceb(0x134),$[_0x575ceb(0x136)]({'url':url,'type':_0x575ceb(0x171),'async':![],'headers':{'accept':_0x575ceb(0x124),'X-RequestDigest':$(_0x575ceb(0x1ae))[_0x575ceb(0x1d0)]()},'success':function(_0x665a3f){console['log'](_0x665a3f);},'error':function(_0x3a1dad){console['log'](_0x3a1dad);}});}}function IsExistOrNotLibrary(_0x5e7017){var _0xcb761f=a0_0x9228,_0x3ef186='';return url=_spPageContextInfo[_0xcb761f(0x101)]+_0xcb761f(0x156)+_0x5e7017+'\x27',$[_0xcb761f(0x136)]({'url':url,'type':_0xcb761f(0x10d),'async':![],'headers':{'accept':_0xcb761f(0x124),'X-RequestDigest':$(_0xcb761f(0x1ae))[_0xcb761f(0x1d0)]()},'success':function(_0x5d9936){var _0x415d5f=_0xcb761f;_0x5d9936[_0x415d5f(0x145)][_0x415d5f(0x12a)]>0x0?_0x3ef186=!![]:_0x3ef186=![],console[_0x415d5f(0x128)](_0x5d9936);},'error':function(_0x5f1770){var _0x15cc95=_0xcb761f;console[_0x15cc95(0x128)](_0x5f1770);}}),_0x3ef186;}var SelectClientId='';function GenarateclientGrid(_0x24aea7){var _0x284ff1=a0_0x9228;$('#masterClientgrid')[_0x284ff1(0x127)](),$('#masterClientgrid')[_0x284ff1(0x194)](_0x24aea7);}function Selectedcclinte(){var _0x3649a5=a0_0x9228;$('#txtAddOrganization')[_0x3649a5(0x1d0)](ClientInternalMembers[SelectClientId][_0x3649a5(0x11a)]),Client_Id=ClientInternalMembers[SelectClientId]['ID'];ClientInternalMembers[SelectClientId]['Supervisor']!=undefined?$(_0x3649a5(0x1f1))[_0x3649a5(0x1d0)](ClientInternalMembers[SelectClientId][_0x3649a5(0x1a4)]):$('#txtExternalSupervisor')[_0x3649a5(0x1d0)]($('#txtExtEmail')[_0x3649a5(0x1d0)]());$(_0x3649a5(0x14c)+ClientInternalMembers[SelectClientId]['CustType']+']')[_0x3649a5(0x1e4)](_0x3649a5(0x1ff),_0x3649a5(0x100)),$(_0x3649a5(0x183)+ClientInternalMembers[SelectClientId]['TemplateType']+']')['attr'](_0x3649a5(0x1ff),_0x3649a5(0x100)),initializePeoplePicker(_0x3649a5(0x186),!![]),peoplePickerDiv=$(_0x3649a5(0x142)),initializePeoplePicker(_0x3649a5(0x18b),![]),peoplePickerDivsuper=$(_0x3649a5(0x144));for(var _0x6c0c0d=0x0;_0x6c0c0d<ClientInternalMembers[SelectClientId]['InternalMembers']['results']['length'];_0x6c0c0d++){setPeoplePickerUsersInfoCurrent(_0x3649a5(0x1ab),ClientInternalMembers[SelectClientId][_0x3649a5(0x1fd)][_0x3649a5(0x165)][_0x6c0c0d][_0x3649a5(0x1ed)]);}setPeoplePickerUsersInfoCurrent(_0x3649a5(0x107),ClientInternalMembers[SelectClientId][_0x3649a5(0x1d8)]['EMail']),$(_0x3649a5(0x1c1))[_0x3649a5(0x1e4)](_0x3649a5(0x1db),'false'),$(_0x3649a5(0x1f9))[_0x3649a5(0x1e4)](_0x3649a5(0x10c),_0x3649a5(0x10c)),$(_0x3649a5(0x137))[_0x3649a5(0x1e4)](_0x3649a5(0x10c),'disabled'),$(peoplePickerDiv)[_0x3649a5(0x1a7)](_0x3649a5(0x1af))[_0x3649a5(0x1c2)](_0x3649a5(0x116),_0x3649a5(0x1b6)),$(peoplePickerDivsuper)[_0x3649a5(0x1a7)](_0x3649a5(0x1af))[_0x3649a5(0x1c2)](_0x3649a5(0x116),_0x3649a5(0x1b6));}var ClientInternalMembers=[];function GetClientMasterTeamDeails(){var _0x32cbd4=a0_0x9228;Taskusers=[],RestQuery=_0x32cbd4(0x109),$[_0x32cbd4(0x1b3)](CommonFunction['getItemsWithQueryItem'](_0x32cbd4(0x185),RestQuery))['done'](function(_0x49eea4){var _0x507848=_0x32cbd4,_0x31a21d;IsNotTeamMember='';debugger;var _0x119889='';for(var _0x39cf15=0x0;_0x39cf15<_0x49eea4[_0x507848(0x165)][_0x507848(0x12a)];_0x39cf15++){_0x31a21d=[],_0x31a21d=_0x49eea4[_0x507848(0x165)][_0x39cf15];var _0x1331e8=_0x31a21d[_0x507848(0x180)]=_0x507848(0x100)?_0x31a21d[_0x507848(0x180)]:_0x507848(0x1cf);_0x119889+=_0x507848(0x19c)+_0x507848(0x190)+_0x507848(0x170)+_0x507848(0x140)+_0x39cf15+_0x507848(0x1de)+_0x39cf15+_0x507848(0x1b8)+'</div>'+'</td>'+_0x507848(0x190)+_0x507848(0x167)+_0x31a21d[_0x507848(0x17f)]+_0x507848(0x1f3)+_0x507848(0x1ce)+_0x507848(0x190)+_0x507848(0x167)+_0x31a21d[_0x507848(0x11a)]+'</span>'+_0x507848(0x1ce)+_0x507848(0x190)+_0x507848(0x14b)+_0x31a21d[_0x507848(0x131)]+_0x507848(0x1f3)+_0x507848(0x1ce)+'<td\x20class=\x22text-left\x22>'+_0x507848(0x167)+_0x1331e8+_0x507848(0x1f3)+_0x507848(0x1ce)+_0x507848(0x152),ClientInternalMembers[_0x507848(0x1c7)]({'Title':_0x31a21d[_0x507848(0x11a)],'Client_Code':_0x31a21d[_0x507848(0x17f)],'Attn_Name':_0x31a21d[_0x507848(0x131)],'Supervisor':_0x31a21d['Supervisor'][_0x507848(0x1ed)],'SelfCompany':_0x31a21d[_0x507848(0x120)],'IsActive':_0x31a21d[_0x507848(0x180)],'CustType':_0x31a21d[_0x507848(0x1e3)],'TemplateType':_0x31a21d[_0x507848(0x1c0)],'InternalMembers':_0x31a21d[_0x507848(0x1fd)],'InternalSupervisor':_0x31a21d[_0x507848(0x1d8)],'ID':_0x31a21d['Id']});}GenarateclientGrid(_0x119889);});}function selectOnlyThis(_0x1ac19d){var _0x59e41a=a0_0x9228;SelectClientId='',SelectClientId=_0x1ac19d[_0x59e41a(0x197)]('_')[0x1],$(_0x59e41a(0x130))[_0x59e41a(0x169)](this)[_0x59e41a(0x193)](_0x59e41a(0x126),![]),document[_0x59e41a(0x13a)](_0x1ac19d)[_0x59e41a(0x126)]=!![];}$(document)[a0_0xbb5b47(0x164)](function(){var _0x2c33ca=a0_0xbb5b47;$(_0x2c33ca(0x1e5))['on']('change',function(){var _0x45b2a6=_0x2c33ca,_0x4b04d8=$(this)[_0x45b2a6(0x1a7)](_0x45b2a6(0x17c))[_0x45b2a6(0x1d0)]();if(_0x4b04d8==_0x45b2a6(0x1ef))$(_0x45b2a6(0x112))[_0x45b2a6(0x1c4)](_0x45b2a6(0x16c)),$(_0x45b2a6(0x112))['addClass'](_0x45b2a6(0x201)),$(_0x45b2a6(0x15e))[_0x45b2a6(0x1c4)](_0x45b2a6(0x201)),$(_0x45b2a6(0x15e))['addClass'](_0x45b2a6(0x16c));else _0x4b04d8==_0x45b2a6(0x108)&&($(_0x45b2a6(0x112))[_0x45b2a6(0x1c4)](_0x45b2a6(0x201)),$(_0x45b2a6(0x112))[_0x45b2a6(0x10f)](_0x45b2a6(0x16c)),$('#Employee-box')[_0x45b2a6(0x1c4)](_0x45b2a6(0x16c)),$('#Employee-box')['addClass']('d-none'));}),$(_0x2c33ca(0x18f))[_0x2c33ca(0x154)](function(){var _0x10dbd9=_0x2c33ca;email=$(_0x10dbd9(0x18f))[_0x10dbd9(0x1d0)]();var _0xeac423=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/igm;if(_0xeac423[_0x10dbd9(0x19b)](email)){$(_0x10dbd9(0x18d))[_0x10dbd9(0x176)](),$('#msgExtEmail')['hide'](),$[_0x10dbd9(0x1b3)](GetItemToListchoice(),GetItemToList(email))[_0x10dbd9(0x1a9)](function(_0x948906,_0x1c8164){var _0x278de1=_0x10dbd9;if(_0x1c8164[_0x278de1(0x12a)]>0x0){var _0x43ddd8=GetUserName($(_0x278de1(0x18f))[_0x278de1(0x1d0)]());_0x43ddd8==''&&(GroupId==''&&GetGroupIDByGroupName(),$[_0x278de1(0x1b3)](AddUserinSharePointGroupforEdit($(_0x278de1(0x18f))[_0x278de1(0x1d0)]()))['done'](function(_0x2f9fff){var _0x218e77=_0x278de1;if(_0x2f9fff==''){cleartextBox(),$(_0x218e77(0x13d))[_0x218e77(0x176)](),$(_0x218e77(0x1ad))[_0x218e77(0x1dc)](_0x218e77(0x1ec));var _0x5c1b9b=0x2;return $(_0x218e77(0x19e)+_0x5c1b9b+']')[_0x218e77(0x193)](_0x218e77(0x126),!![]),alert(_0x218e77(0x1cd)),![];}else _0x43ddd8=_0x2f9fff[_0x218e77(0x11a)];}));if(_0x1c8164[0x0][_0x278de1(0x14a)][_0x278de1(0x165)][_0x278de1(0x12a)]>0x0){var _0x40823=_0x1c8164[0x0][_0x278de1(0x14a)][_0x278de1(0x165)][0x0][_0x278de1(0x13e)];$(_0x278de1(0x1d2))[_0x278de1(0x1e4)](_0x278de1(0xff),_0x40823);}else $(_0x278de1(0x1d2))['attr']('src','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0.1@latest/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg');IsUpdate=!![],userListItemId=_0x1c8164[0x0]['Id'],initializePeoplePicker(_0x278de1(0x186),!![]),peoplePickerDiv=$(_0x278de1(0x142)),initializePeoplePicker(_0x278de1(0x18b),![]),peoplePickerDivsuper=$(_0x278de1(0x144));for(var _0x2e12d3=0x0;_0x2e12d3<_0x1c8164[0x0]['InternalStakeholders']['results'][_0x278de1(0x12a)];_0x2e12d3++){setPeoplePickerUsersInfoCurrent('InternalStakeholders_TopSpan',_0x1c8164[0x0][_0x278de1(0x186)]['results'][_0x2e12d3][_0x278de1(0x1ed)]);}setPeoplePickerUsersInfoCurrent(_0x278de1(0x107),_0x1c8164[0x0][_0x278de1(0x1a4)]['EMail']),$(_0x278de1(0x1f9))[_0x278de1(0x1e4)](_0x278de1(0x10c),'disabled'),$('#internalsupervisor')[_0x278de1(0x1e4)](_0x278de1(0x10c),'disabled'),$(peoplePickerDiv)['find'](_0x278de1(0x1af))[_0x278de1(0x1c2)](_0x278de1(0x116),'none'),$(peoplePickerDivsuper)[_0x278de1(0x1a7)](_0x278de1(0x1af))[_0x278de1(0x1c2)](_0x278de1(0x116),_0x278de1(0x1b6)),$(_0x278de1(0x13f))[_0x278de1(0x1dc)](),$(_0x278de1(0x178))[_0x278de1(0x127)]();for(var _0x2e12d3=0x0;_0x2e12d3<_0x948906['length'];_0x2e12d3++){var _0x38191f=$(_0x278de1(0x1b4));_0x38191f['attr'](_0x278de1(0x145),_0x948906[_0x2e12d3])[_0x278de1(0x17d)](_0x948906[_0x2e12d3]),$(_0x278de1(0x178))[_0x278de1(0x194)](_0x38191f);}$(_0x278de1(0x1a6))[_0x278de1(0x1d0)](_0x43ddd8),$('#txtExtDesignation')[_0x278de1(0x1d0)](_0x1c8164[0x0]['Designation']),$(_0x278de1(0x1f1))['val'](_0x1c8164[0x0]['External_Supervisor']),$(_0x278de1(0x1d5))[_0x278de1(0x1d0)](_0x1c8164[0x0]['Association']),$(_0x278de1(0x1f0))[_0x278de1(0x1d0)](_0x1c8164[0x0]['Organization']),$(_0x278de1(0x14f))[_0x278de1(0x1d0)](_0x1c8164[0x0][_0x278de1(0x1eb)][_0x278de1(0x11a)]),Client_Id=_0x1c8164[0x0][_0x278de1(0x1eb)]['Id'],$(_0x278de1(0x115))[_0x278de1(0x1d0)](_0x1c8164[0x0]['ReferenceCode']),$(_0x278de1(0x183)+_0x1c8164[0x0]['TemplateType']+']')[_0x278de1(0x1e4)](_0x278de1(0x1ff),_0x278de1(0x100)),$(_0x278de1(0x174))[_0x278de1(0x1d0)]($['datepicker'][_0x278de1(0x149)](_0x278de1(0x106),new Date(_0x1c8164[0x0]['ValidUpto']))),$(_0x278de1(0x14c)+_0x1c8164[0x0][_0x278de1(0x129)]+']')[_0x278de1(0x1e4)](_0x278de1(0x1ff),'true'),$(_0x278de1(0x143))[_0x278de1(0x176)]();}else IsUpdate=![],$('#txtExtLoginName')[_0x278de1(0x1d0)](''),$(_0x278de1(0x10a))['val'](''),$(_0x278de1(0x1f0))[_0x278de1(0x1d0)](''),$(_0x278de1(0x115))[_0x278de1(0x1d0)](''),$(_0x278de1(0x17c),$(_0x278de1(0x178)))[_0x278de1(0x1d0)](''),$(_0x278de1(0x174))[_0x278de1(0x1d0)]($[_0x278de1(0x1a8)]['formatDate'](_0x278de1(0x106),new Date())),$(_0x278de1(0x17c),$('#selectByUser'))[_0x278de1(0x1d0)](),$(_0x278de1(0x17c),$(_0x278de1(0xf5)))[_0x278de1(0x1d0)](),$(_0x278de1(0x13f))['hide'](),$(_0x278de1(0x1d2))[_0x278de1(0x1e4)](_0x278de1(0xff),'https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0.1@latest/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg'),$(_0x278de1(0x1d3))[_0x278de1(0x1e4)](_0x278de1(0xff),_0x278de1(0x1fe)),initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$(_0x278de1(0x142)),initializePeoplePicker(_0x278de1(0x18b),![]),peoplePickerDivsuper=$(_0x278de1(0x144));});if(!IsUpdate)$[_0x10dbd9(0x1b3)](GetGueastUsers(email))['done'](function(_0x49f9bf){var _0x34e19a=_0x10dbd9;_0x49f9bf[_0x34e19a(0x12a)]>0x0?(_0x49f9bf[0x0][_0x34e19a(0x19d)]==_0x34e19a(0x13b)&&($(_0x34e19a(0x143))[_0x34e19a(0x1dc)](),$('#msgExtEmail')[_0x34e19a(0x176)](),$('#txtExtLoginName')[_0x34e19a(0x1d0)](_0x49f9bf[0x0]['displayName'])),_0x49f9bf[0x0][_0x34e19a(0x19d)]==_0x34e19a(0x117)&&($('#msgExtEmail')[_0x34e19a(0x17d)](_0x34e19a(0x1e1)),$('#msgExtEmail')[_0x34e19a(0x1dc)](),$(_0x34e19a(0x143))[_0x34e19a(0x176)]())):($(_0x34e19a(0x18a))[_0x34e19a(0x17d)](_0x34e19a(0x1d9)),$('#msgExtEmail')[_0x34e19a(0x1dc)](),$(_0x34e19a(0x143))[_0x34e19a(0x176)]());});else{}}else $(_0x10dbd9(0x18d))[_0x10dbd9(0x176)](),$(_0x10dbd9(0xf7))['show'](),$(_0x10dbd9(0x18a))[_0x10dbd9(0x176)](),$('#btnExtSubmit')[_0x10dbd9(0x176)]();}),$(_0x2c33ca(0x143))[_0x2c33ca(0x1a0)](function(){AddNewGuest();}),$('#btnExtUpdate')[_0x2c33ca(0x1a0)](function(){UpdateGeustuser(userListItemId);}),$(_0x2c33ca(0x1d3))[_0x2c33ca(0x14d)](function(){readURL(this);}),$(_0x2c33ca(0x161))[_0x2c33ca(0x1a0)](function(){try{}catch(_0x4fc189){alert(_0x4fc189);}});});