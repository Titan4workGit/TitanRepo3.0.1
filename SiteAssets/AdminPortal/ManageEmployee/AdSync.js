var a0_0x148606=a0_0x1927;(function(_0x4ace1f,_0x313f73){var _0x524ae2=a0_0x1927,_0x12c628=_0x4ace1f();while(!![]){try{var _0x1a9ab0=-parseInt(_0x524ae2(0x284))/0x1+-parseInt(_0x524ae2(0x2d3))/0x2+parseInt(_0x524ae2(0x1d2))/0x3+-parseInt(_0x524ae2(0x295))/0x4+-parseInt(_0x524ae2(0x2a7))/0x5+-parseInt(_0x524ae2(0x1ba))/0x6+-parseInt(_0x524ae2(0x1e6))/0x7*(-parseInt(_0x524ae2(0x2d7))/0x8);if(_0x1a9ab0===_0x313f73)break;else _0x12c628['push'](_0x12c628['shift']());}catch(_0x418f9b){_0x12c628['push'](_0x12c628['shift']());}}}(a0_0x2931,0x8e166));var token,ClientId='',ClentSecret='',ClientUrl='',DeferredObj=$['Deferred'](),color_red='',Error=0x0,Ready=0x0,Exits=0x0,lblUpdate=0x0,ErrorUser='',alluserdata,contributersGroupId='',counusers=0x0,excelRows,AllCompanies,AllDepartments,AllOfficeLocation,tabledata,pageIndex,UserEmailId,warningmessage='',userfullname='',AvilableLicenses,ReadySelected=[],MiisingSelected=[],AddedEmployeeList=[],IsMiisingSelect,isReadeySelect,peoplePickerDiv='',EmployeeId='',EmployeeDepartment='',EmployeeOfficeLocation='',checkedAudience='';$(document)[a0_0x148606(0x289)](function(){var _0x5e9bdb=a0_0x148606;$('#btnCloseSync')[_0x5e9bdb(0x257)](function(){var _0x287257=_0x5e9bdb;window[_0x287257(0x208)][_0x287257(0x2bb)]=_spPageContextInfo[_0x287257(0x23d)]+'/Pages/Show_Employee.aspx?WebAppId=2';}),GraphAccessTokenTogetUserDetails(),GetCompanies(),GetOfficeLocation(),GetDepartments(),LoadShowUser([]),GetAllUserId(),GetEmployees(),$(_0x5e9bdb(0x2cc))[_0x5e9bdb(0x2a8)](AvilableLicenses);});function initializePeoplePicker(_0x248665){var _0x272548=a0_0x148606,_0xaf6308={};_0xaf6308[_0x272548(0x259)]=_0x272548(0x2ac),_0xaf6308[_0x272548(0x1e9)]=0xf,_0xaf6308[_0x272548(0x24a)]=0xf,_0xaf6308[_0x272548(0x19e)]=![],_0xaf6308[_0x272548(0x25b)]=0x32,_0xaf6308['Width']=_0x272548(0x1d4),this[_0x272548(0x1c9)](_0x248665,null,_0xaf6308),$('.sp-peoplepicker-editorInput')[_0x272548(0x299)](0xfa);}function GetSelectItem(){var _0x1faadf=a0_0x148606;if(contributersGroupId!==''){var _0xc7e831=tabledata[_0x1faadf(0x209)]();counusers=0x0,IsaddedNewEmployee=![];for(var _0x1c1f9b=0x0;_0x1c1f9b<_0xc7e831[_0x1faadf(0x198)];_0x1c1f9b++){var _0x51fe14=alluserdata['filter'](function(_0x5ae6af){var _0x59cb18=_0x1faadf;return _0x5ae6af['Email']==_0xc7e831[_0x1c1f9b][_0x59cb18(0x1c5)][_0x59cb18(0x264)]['Email'];});AvilableLicenses>0x0?_0x51fe14[0x0][_0x1faadf(0x21c)]==_0x1faadf(0x276)?IsaddedNewEmployee=AddNewEmployeeAllocated(_0x51fe14,_0x1faadf(0x1d1)):_0x51fe14[0x0][_0x1faadf(0x21c)]=='Already\x20Exist'&&UpdateExistingEmployeeAllocated(_0x51fe14,'Employees'):($(_0x1faadf(0x2d2))[_0x1faadf(0x2a8)](counusers),alert('Your\x20License\x20limit\x20has\x20been\x20ended'),_0x1c1f9b=_0xc7e831[_0x1faadf(0x198)]);}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x1faadf(0x2d2))['text'](counusers),showmessage(),tabledata['setData'](excelRows),tabledata[_0x1faadf(0x25a)](pageIndex),IsaddedNewEmployee&&($(_0x1faadf(0x2db))[_0x1faadf(0x230)]({'backdrop':_0x1faadf(0x1a6),'keyboard':![]},_0x1faadf(0x2de)),AddedEmployeeList['length']>0x0?$('#divAudience')['show']():$('#divAudience')['hide']());}else $(_0x1faadf(0x20d))['fadeIn']()['delay'](0x7d0)[_0x1faadf(0x2ad)](),GetGroupIDByGroupName(),GetSelectItem();}$(a0_0x148606(0x202))[a0_0x148606(0x257)](function(){var _0x2f2569=a0_0x148606;$[_0x2f2569(0x258)]({'cache':![],'beforeSend':function(){var _0xbcc478=_0x2f2569;$(_0xbcc478(0x293))[_0xbcc478(0x2cb)]();},'success':function(_0x2bf404){var _0x50f4a5=_0x2f2569;AzureUsrlist=[],GetAzureUsrlist(AdusersUrl,token),excelRows=[];for(var _0x31a14c=0x0;_0x31a14c<AzureUsrlist['length'];_0x31a14c++){if(AzureUsrlist[_0x31a14c][_0x50f4a5(0x256)]!=null&&AzureUsrlist[_0x31a14c][_0x50f4a5(0x1fd)]==!![]){if(AzureUsrlist[_0x31a14c][_0x50f4a5(0x2c6)]!=_0x50f4a5(0x20c)){var _0x302df3=EmployeeListUsers[_0x50f4a5(0x1b6)](function(_0x1d4af9){var _0x21383c=_0x50f4a5;return _0x1d4af9[_0x21383c(0x1cc)]['toLowerCase']()==AzureUsrlist[_0x31a14c][_0x21383c(0x256)]['toLowerCase']();}),_0x3210c1=AllCompanies[_0x50f4a5(0x1b6)](function(_0x2eac2a){var _0x4687f5=_0x50f4a5;if(AzureUsrlist[_0x31a14c]['companyName']!=null)return _0x2eac2a['CompanyName'][_0x4687f5(0x214)]()==AzureUsrlist[_0x31a14c][_0x4687f5(0x25f)][_0x4687f5(0x214)]();}),_0x365db5=0x0;_0x3210c1[_0x50f4a5(0x198)]>0x0?_0x365db5=_0x3210c1[0x0]['Id']:_0x365db5=parseInt(Logged_CompanyId);var _0x5c8306=AllOfficeLocation[_0x50f4a5(0x1b6)](function(_0x8a8ab2){var _0x3e8328=_0x50f4a5;if(AzureUsrlist[_0x31a14c]['officeLocation']!=null)return _0x8a8ab2[_0x3e8328(0x287)][_0x3e8328(0x214)]()==AzureUsrlist[_0x31a14c][_0x3e8328(0x244)]['toLowerCase']();}),_0xdb12b7=0x0;_0x5c8306[_0x50f4a5(0x198)]>0x0&&(_0xdb12b7=_0x5c8306[0x0]['Id']);var _0x4efb98=AllDepartments[_0x50f4a5(0x1b6)](function(_0x2d7043){var _0x405e21=_0x50f4a5;if(AzureUsrlist[_0x31a14c][_0x405e21(0x24f)]!=null)return _0x2d7043[_0x405e21(0x287)][_0x405e21(0x214)]()==AzureUsrlist[_0x31a14c][_0x405e21(0x24f)]['toLowerCase']();}),_0x54aa67=0x0;_0x4efb98[_0x50f4a5(0x198)]>0x0&&(_0x54aa67=_0x4efb98[0x0]['Id']);var _0x344054='',_0x2259ed='';AzureUsrlist[_0x31a14c]['manager']!=undefined&&(_0x344054=AzureUsrlist[_0x31a14c][_0x50f4a5(0x2a4)][_0x50f4a5(0x256)]);AzureUsrlist[_0x31a14c][_0x50f4a5(0x262)]!=undefined||AzureUsrlist[_0x31a14c][_0x50f4a5(0x262)]!=null?(_0x2259ed=new Date(AzureUsrlist[_0x31a14c][_0x50f4a5(0x262)]),_0x2259ed=$[_0x50f4a5(0x1a8)][_0x50f4a5(0x227)]('mm/dd/yy',_0x2259ed)):(_0x2259ed=new Date(),_0x2259ed=$[_0x50f4a5(0x1a8)][_0x50f4a5(0x227)]('mm/dd/yy',_0x2259ed));if(_0x302df3[_0x50f4a5(0x198)]==0x0){var _0x54dfd4=AzureUsrlist[_0x31a14c][_0x50f4a5(0x2da)]=='Guest'?_0x50f4a5(0x2b7):_0x50f4a5(0x2af);excelRows[_0x50f4a5(0x1e2)]({'Id':_0x31a14c,'Name':AzureUsrlist[_0x31a14c][_0x50f4a5(0x226)],'Email':AzureUsrlist[_0x31a14c]['mail'],'Type':_0x54dfd4,'Department':_0x54aa67,'Company':_0x365db5,'DepartmentName':AzureUsrlist[_0x31a14c]['department'],'CompanyName':AzureUsrlist[_0x31a14c][_0x50f4a5(0x25f)],'country':AzureUsrlist[_0x31a14c][_0x50f4a5(0x282)],'DateOfJoining':_0x2259ed,'employeeId':AzureUsrlist[_0x31a14c][_0x50f4a5(0x273)],'Manager':_0x344054,'postalCode':AzureUsrlist[_0x31a14c]['postalCode'],'state':AzureUsrlist[_0x31a14c][_0x50f4a5(0x23a)],'streetAddress':AzureUsrlist[_0x31a14c][_0x50f4a5(0x1ee)],'city':AzureUsrlist[_0x31a14c][_0x50f4a5(0x1ae)],'mobilePhone':AzureUsrlist[_0x31a14c][_0x50f4a5(0x2ce)],'Location':_0xdb12b7,'LocationName':AzureUsrlist[_0x31a14c][_0x50f4a5(0x244)],'otherMails':AzureUsrlist[_0x31a14c][_0x50f4a5(0x19c)][0x0],'Designation':AzureUsrlist[_0x31a14c][_0x50f4a5(0x1e8)]});}}}}Ready=0x0,Error=0x0,lblUpdate=0x0,counusers=0x0,Exits=0x0,$(_0x50f4a5(0x26e))[_0x50f4a5(0x2a8)](0x0),$(_0x50f4a5(0x218))['text'](0x0),$('#added')[_0x50f4a5(0x2a8)](0x0),$('#lblUpdate')[_0x50f4a5(0x2a8)](0x0),$(_0x50f4a5(0x25c))['text'](0x0);for(var _0x31a14c=0x0;_0x31a14c<excelRows[_0x50f4a5(0x198)];_0x31a14c++){var _0x345ec2='',_0x14cbc0=AzureUsrlist[_0x50f4a5(0x1b6)](function(_0x2659ae){var _0x2fbcfe=_0x50f4a5;if(_0x2659ae[_0x2fbcfe(0x256)]!=null){var _0x9d14c7=_0x2659ae[_0x2fbcfe(0x256)]['toLowerCase']();return _0x9d14c7==excelRows[_0x31a14c][_0x2fbcfe(0x1cc)][_0x2fbcfe(0x214)]();}});if(_0x14cbc0[_0x50f4a5(0x198)]>0x0){_0x345ec2=_0x14cbc0[0x0][_0x50f4a5(0x226)];var _0x4bacd9=AllCompanies[_0x50f4a5(0x1b6)](function(_0x32b034){return _0x32b034['ID']==excelRows[_0x31a14c]['Company'];}),_0x48125b=AllDepartments[_0x50f4a5(0x1b6)](function(_0x3f3d6b){var _0x36ddce=_0x50f4a5;return _0x3f3d6b['ID']==excelRows[_0x31a14c][_0x36ddce(0x28d)];}),_0x2a44ea=AllOfficeLocation['filter'](function(_0x28e73f){return _0x28e73f['ID']==excelRows[_0x31a14c]['Location'];});_0x4bacd9['length']>0x0&&_0x48125b[_0x50f4a5(0x198)]>0x0&&_0x2a44ea[_0x50f4a5(0x198)]>0x0?(Ready=Ready+0x1,ErrorUser=_0x50f4a5(0x276)):(ErrorUser='Required\x20Value\x20Missing',Error=Error+0x1);}else ErrorUser=_0x50f4a5(0x28b),color_red='color-red',Error=Error+0x1;excelRows[_0x31a14c]['Status']=ErrorUser;}alluserdata=excelRows,LoadShowUser(excelRows),$(_0x50f4a5(0x293))[_0x50f4a5(0x2ad)]();}});});var Temparray=[];$(a0_0x148606(0x28a))[a0_0x148606(0x257)](function(){var _0x4dd48d=a0_0x148606;debugger;Temparray=alluserdata;let _0x15f63e=[...new Set(Temparray[_0x4dd48d(0x290)](_0x4b1865=>_0x4b1865[_0x4dd48d(0x26f)]))];var _0x17d7e6=document[_0x4dd48d(0x201)](_0x4dd48d(0x1ca));_0x17d7e6[_0x4dd48d(0x260)]='',opt[_0x4dd48d(0x22e)]='0',opt[_0x4dd48d(0x2a8)]=_0x4dd48d(0x2b5),_0x17d7e6[_0x4dd48d(0x196)](opt);for(var _0x449958=0x0;_0x449958<_0x15f63e[_0x4dd48d(0x198)];_0x449958++){opt=document[_0x4dd48d(0x2b9)](_0x4dd48d(0x28c)),opt[_0x4dd48d(0x22e)]=_0x15f63e[_0x449958],opt['text']=_0x15f63e[_0x449958],_0x17d7e6['appendChild'](opt);}Temparray=alluserdata;var _0xe564a0=[...new Set(Temparray[_0x4dd48d(0x290)](_0x5a9dc1=>_0x5a9dc1[_0x4dd48d(0x1d8)]))],_0x17d7e6=document[_0x4dd48d(0x201)](_0x4dd48d(0x298)),_0x1e5fc4=_0x4dd48d(0x2c9);for(var _0x449958=0x0;_0x449958<_0xe564a0[_0x4dd48d(0x198)];_0x449958++){_0x1e5fc4+='<option\x20value=\x22'+_0xe564a0[_0x449958]+'\x22>'+_0xe564a0[_0x449958]+_0x4dd48d(0x28e);}$('#ddlfilterOfficeLocation')[_0x4dd48d(0x270)](_0x1e5fc4),Temparray=alluserdata;let _0x19cdeb=[...new Set(Temparray[_0x4dd48d(0x290)](_0x5841de=>_0x5841de[_0x4dd48d(0x28d)]))];var _0x17d7e6=document['getElementById'](_0x4dd48d(0x1bf));_0x17d7e6[_0x4dd48d(0x260)]='',opt['value']='0',opt['text']=_0x4dd48d(0x2a1),_0x17d7e6['appendChild'](opt);for(var _0x449958=0x0;_0x449958<_0x19cdeb['length'];_0x449958++){opt=document[_0x4dd48d(0x2b9)](_0x4dd48d(0x28c)),opt['value']=_0x19cdeb[_0x449958],opt['text']=_0x19cdeb[_0x449958],_0x17d7e6['appendChild'](opt);}}),$('#btnfiltervalue')[a0_0x148606(0x257)](function(){var _0x336a5c=a0_0x148606;let _0x83b967;var _0x109a0b='',_0x419465=!![];$(_0x336a5c(0x22b))[_0x336a5c(0x2dc)]()!='0'&&(_0x419465=![]);if($(_0x336a5c(0x2c7))[_0x336a5c(0x2dc)]()!='0')_0x419465=![];else return alert(_0x336a5c(0x271)),![];if($('#ddlfilterOfficeLocation')['val']()!='0')_0x419465=![];else return alert(_0x336a5c(0x20b)),![];_0x83b967=alluserdata['filter'](function(_0x80d1db){var _0x45960a=_0x336a5c;return _0x80d1db[_0x45960a(0x2ae)]==$(_0x45960a(0x296),$(_0x45960a(0x22c)))[_0x45960a(0x2dc)]()&&_0x80d1db[_0x45960a(0x28d)]==$('option:selected',$(_0x45960a(0x2c7)))[_0x45960a(0x2dc)]()&&_0x80d1db[_0x45960a(0x1a7)]==$(_0x45960a(0x296),$('#ddlfilterAllCompanies'))[_0x45960a(0x2dc)]();});var _0x1f3659=alluserdata['find'](_0x4a27f4=>_0x4a27f4[_0x336a5c(0x2ae)]===$(_0x336a5c(0x296),$(_0x336a5c(0x22c)))[_0x336a5c(0x2dc)]()&&_0x4a27f4['Department']==$('option:selected',$(_0x336a5c(0x2c7)))['val']()&&_0x4a27f4[_0x336a5c(0x1a7)]==$(_0x336a5c(0x296),$(_0x336a5c(0x22b)))[_0x336a5c(0x2dc)]());_0x419465?LoadShowUser(alluserdata):LoadShowUser(_0x83b967);}),$(a0_0x148606(0x2ab))['keyup'](function(_0x502135){var _0x3da285=a0_0x148606;LoadShowUser(search($(_0x3da285(0x2ab))[_0x3da285(0x2dc)]()));});function search(_0x43397e){var _0x53d86f=a0_0x148606;return alluserdata[_0x53d86f(0x1b6)](({Name:_0x33e49c,Email:_0x450171})=>{var _0x49e43d=_0x53d86f;return _0x33e49c[_0x49e43d(0x214)]()[_0x49e43d(0x24b)](_0x43397e[_0x49e43d(0x214)]())>-0x1||_0x450171[_0x49e43d(0x214)]()['indexOf'](_0x43397e[_0x49e43d(0x214)]())>-0x1;});}$(a0_0x148606(0x197))['click'](function(){var _0x21997b=a0_0x148606;$[_0x21997b(0x258)]({'cache':![],'beforeSend':function(){var _0x3af72c=_0x21997b;$(_0x3af72c(0x293))[_0x3af72c(0x2cb)]();},'success':function(_0x50c804){var _0x39629f=_0x21997b;AddedEmployeeList=[],SubmitReady(),$('#overlaysearch')[_0x39629f(0x2ad)]();}});});function SubmitReady(){var _0xb4d8df=a0_0x148606;if(contributersGroupId!==''){var _0x2ecfa5=tabledata[_0xb4d8df(0x209)]();counusers=0x0,IsaddedNewEmployee=![];for(var _0x1bba57=0x0;_0x1bba57<_0x2ecfa5['length'];_0x1bba57++){var _0x1c3f6e=alluserdata[_0xb4d8df(0x1b6)](function(_0x2e531f){var _0x50d542=_0xb4d8df;return _0x2e531f[_0x50d542(0x1cc)]==_0x2ecfa5[_0x1bba57]['_row'][_0x50d542(0x264)][_0x50d542(0x1cc)];});if(AvilableLicenses>0x0)_0x1c3f6e[0x0]['Status']==_0xb4d8df(0x276)?IsaddedNewEmployee=AddNewEmployeeAllocated(_0x1c3f6e,_0xb4d8df(0x1d1)):_0x1c3f6e[0x0][_0xb4d8df(0x21c)]==_0xb4d8df(0x27a)&&UpdateExistingEmployeeAllocated(_0x1c3f6e,_0xb4d8df(0x1d1));else return alert(_0xb4d8df(0x217)),![];}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0xb4d8df(0x2d2))['text'](counusers),showmessage(),tabledata['setData'](excelRows),tabledata[_0xb4d8df(0x25a)](pageIndex),IsaddedNewEmployee&&($(_0xb4d8df(0x2db))[_0xb4d8df(0x230)]({'backdrop':_0xb4d8df(0x1a6),'keyboard':![]},_0xb4d8df(0x2de)),AddedEmployeeList[_0xb4d8df(0x198)]>0x0?$('#divAudience')['show']():$(_0xb4d8df(0x1f9))[_0xb4d8df(0x1ec)]());}else GetGroupIDByGroupName(),GetSelectItem();}$(a0_0x148606(0x253))['on'](a0_0x148606(0x257),function(){$['ajax']({'cache':![],'beforeSend':function(){$('#overlaysearch')['fadeIn']();},'success':function(_0x4e734d){var _0x473a65=a0_0x1927;if(AddedEmployeeList[_0x473a65(0x198)]>0x0&&checkedAudience!=_0x473a65(0x24e))for(var _0x1dc740=0x0;_0x1dc740<AddedEmployeeList[_0x473a65(0x198)];_0x1dc740++){var _0x541413=new Date(AddedEmployeeList[_0x1dc740]['Metadata']['JoiningDate']),_0x579f89=new Date();_0x579f89[_0x473a65(0x281)](_0x541413[_0x473a65(0x19a)]()+0x3),_0x541413=$['datepicker'][_0x473a65(0x227)](_0x473a65(0x2c8),_0x541413),_0x579f89=$[_0x473a65(0x1a8)]['formatDate']('mm/dd/yy',_0x579f89);var _0xe1b5d3=new Date(AddedEmployeeList[_0x1dc740][_0x473a65(0x1da)][_0x473a65(0x269)]);_0xe1b5d3=$['datepicker'][_0x473a65(0x227)](_0x473a65(0x27d),_0xe1b5d3);var _0x38d6ef=[],_0x3b5011=[],_0x2ef360=[];_0x2ef360[_0x473a65(0x1e2)](Logged_CompanyId);var _0x14847a;_0x14847a={'__metadata':{'type':_0x473a65(0x279)}},(_0x14847a[_0x473a65(0x280)]='Welcome',_0x14847a['EmployeeID']=AddedEmployeeList[_0x1dc740][_0x473a65(0x1c8)]['toString'](),_0x14847a['Title']=_0x473a65(0x21b),_0x14847a['EmployeeName']=AddedEmployeeList[_0x1dc740][_0x473a65(0x1da)][_0x473a65(0x21e)],_0x14847a[_0x473a65(0x292)]=AddedEmployeeList[_0x1dc740][_0x473a65(0x1da)][_0x473a65(0x292)],_0x14847a[_0x473a65(0x28d)]=AddedEmployeeList[_0x1dc740][_0x473a65(0x1c7)],_0x14847a[_0x473a65(0x26a)]=AddedEmployeeList[_0x1dc740][_0x473a65(0x1b0)],_0x14847a[_0x473a65(0x268)]=_0x473a65(0x1a9),_0x14847a['WebPartName']='Welcome',_0x14847a[_0x473a65(0x25d)]=checkedAudience,_0x14847a['ApprovalStatus']=_0x473a65(0x19d),_0x14847a[_0x473a65(0x1a4)]=_0x541413,_0x14847a[_0x473a65(0x24d)]=_0x579f89,_0x14847a[_0x473a65(0x275)]=_0x473a65(0x1aa)+_0xe1b5d3);if(checkedAudience==_0x473a65(0x29b))_0x2ef360=[0x0],_0x38d6ef=[0x0],_0x3b5011=[0x0],_0x14847a['CompanyId']={'results':_0x2ef360},_0x14847a[_0x473a65(0x24c)]={'results':_0x3b5011},_0x14847a[_0x473a65(0x232)]={'results':_0x38d6ef};else{if(checkedAudience=='Company')_0x2ef360['push'](AddedEmployeeList[_0x1dc740][_0x473a65(0x1da)][_0x473a65(0x19f)]),_0x38d6ef=[0x0],_0x3b5011=[0x0],_0x14847a[_0x473a65(0x19f)]={'results':_0x2ef360},_0x14847a[_0x473a65(0x24c)]={'results':_0x3b5011},_0x14847a[_0x473a65(0x232)]={'results':_0x38d6ef};else{if(checkedAudience==_0x473a65(0x28d))_0x2ef360=[0x0],_0x38d6ef=[0x0],_0x3b5011[_0x473a65(0x1e2)](AddedEmployeeList[_0x1dc740][_0x473a65(0x1da)][_0x473a65(0x1d5)]),_0x14847a[_0x473a65(0x19f)]={'results':_0x2ef360},_0x14847a[_0x473a65(0x24c)]={'results':_0x3b5011},_0x14847a[_0x473a65(0x232)]={'results':_0x38d6ef};else checkedAudience==_0x473a65(0x2ae)&&(_0x2ef360=[0x0],_0x38d6ef[_0x473a65(0x1e2)](AddedEmployeeList[_0x1dc740][_0x473a65(0x1da)][_0x473a65(0x26c)]),_0x3b5011=[0x0],_0x14847a['CompanyId']={'results':_0x2ef360},_0x14847a[_0x473a65(0x24c)]={'results':_0x3b5011},_0x14847a[_0x473a65(0x232)]={'results':_0x38d6ef});}}InsertWelcomeInAnnouncementList(_0x14847a);}$(_0x473a65(0x293))['fadeOut']();}});}),$(a0_0x148606(0x288))['change'](function(){var _0x2dda96=a0_0x148606;checkedAudience=this[_0x2dda96(0x22e)];});function isReadeySelecteds(){var _0x152b2=a0_0x148606;isReadeySelect=document['getElementById']('isReadeySelected');if(isReadeySelect[_0x152b2(0x1dd)]){tabledata[_0x152b2(0x1fc)](MiisingSelected),$(_0x152b2(0x274))[_0x152b2(0x1d6)](_0x152b2(0x1dd),![]),$('#IsMiisingSelected')['prop'](_0x152b2(0x1dd),![]),ReadySelected=[];for(var _0x3b7f66=0x0;_0x3b7f66<excelRows[_0x152b2(0x198)];_0x3b7f66++){(excelRows[_0x3b7f66][_0x152b2(0x21c)]==_0x152b2(0x276)||excelRows[_0x3b7f66][_0x152b2(0x21c)]==_0x152b2(0x27a))&&ReadySelected[_0x152b2(0x1e2)](_0x3b7f66);}$(_0x152b2(0x2c1))[_0x152b2(0x1d6)](_0x152b2(0x1dd),!![]),tabledata[_0x152b2(0x251)](ReadySelected);}else tabledata[_0x152b2(0x1fc)](ReadySelected),$(_0x152b2(0x2c1))[_0x152b2(0x1d6)](_0x152b2(0x1dd),![]);}function IsMiisingSelecteds(){var _0x578fe4=a0_0x148606;IsMiisingSelect=document[_0x578fe4(0x201)]('IsMiisingSelected');if(IsMiisingSelect['checked']){tabledata[_0x578fe4(0x1fc)](ReadySelected),$(_0x578fe4(0x2b4))[_0x578fe4(0x1d6)]('checked',![]),$(_0x578fe4(0x2c1))[_0x578fe4(0x1d6)]('checked',![]),MiisingSelected=[];for(var _0x4c5439=0x0;_0x4c5439<excelRows['length'];_0x4c5439++){(excelRows[_0x4c5439]['Status']==_0x578fe4(0x229)||excelRows[_0x4c5439][_0x578fe4(0x21c)]==_0x578fe4(0x27a)||excelRows[_0x4c5439]['Status']=='Ready')&&(MiisingSelected['push'](_0x4c5439),$(_0x578fe4(0x274))['prop'](_0x578fe4(0x1dd),!![]));}tabledata[_0x578fe4(0x251)](MiisingSelected);}else tabledata[_0x578fe4(0x1fc)](MiisingSelected),$(_0x578fe4(0x274))['prop'](_0x578fe4(0x1dd),![]);}function AssignPermissiononDMSLibary(_0x3e440e,_0x401796,_0x17f3cc){var _0x35fd98=a0_0x148606,_0x24cb6f={'Accept':_0x35fd98(0x2b8),'content-Type':_0x35fd98(0x2b8),'X-RequestDigest':jQuery(_0x35fd98(0x28f))[_0x35fd98(0x2dc)]()},_0x1c54dc=_0x17f3cc+'/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/roleassignments/addroleassignment(principalid='+_0x3e440e+_0x35fd98(0x22d)+_0x401796+')';$['ajax']({'url':_0x1c54dc,'type':_0x35fd98(0x247),'headers':_0x24cb6f,'dataType':'json','async':![],'success':function(_0x4dabd0){var _0x356a2e=_0x35fd98;console[_0x356a2e(0x235)](_0x356a2e(0x1c1));},'error':function(_0x2b39ce){var _0x1ff303=_0x35fd98;console[_0x1ff303(0x235)](JSON[_0x1ff303(0x1a0)](_0x2b39ce)),Permissionloder[_0x1ff303(0x1ce)]();}});}function GetGroupIDByGroupName(){var _0x22398e=a0_0x148606,_0x173606=_spPageContextInfo[_0x22398e(0x23d)]+_0x22398e(0x29f);$['ajax']({'url':_0x173606,'method':_0x22398e(0x216),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x4ecb66){contributersGroupId=_0x4ecb66['d']['Id'];},'error':function(_0x1778b8){var _0x1d77c8=_0x22398e;console[_0x1d77c8(0x235)](_0x1778b8);}});}function GetListItems(_0x4d28e9,_0x1b40b8){var _0x6570c2=a0_0x148606,_0x514d6d,_0x5b50bb=_spPageContextInfo[_0x6570c2(0x23d)]+_0x6570c2(0x203)+_0x4d28e9+_0x6570c2(0x1dc)+_0x1b40b8+_0x6570c2(0x294);return $[_0x6570c2(0x258)]({'url':_0x5b50bb,'method':'GET','async':![],'headers':{'Accept':_0x6570c2(0x2ba)},'success':function(_0x377e6b){var _0xe1af7f=_0x6570c2;_0x377e6b['d'][_0xe1af7f(0x2d6)][_0xe1af7f(0x198)]>0x0?_0x514d6d=![]:_0x514d6d=!![];},'error':function(_0x21c7d1){console['log'](_0x21c7d1);}}),_0x514d6d;}function GetCompanies(){var _0x12e5fb=a0_0x148606,_0x508ef4=_spPageContextInfo[_0x12e5fb(0x23d)]+_0x12e5fb(0x1c2);$[_0x12e5fb(0x258)]({'url':_0x508ef4,'method':_0x12e5fb(0x216),'async':![],'headers':{'Accept':_0x12e5fb(0x2ba)},'success':function(_0x16e00a){var _0x1c82e9=_0x12e5fb;AllCompanies=_0x16e00a['d'][_0x1c82e9(0x2d6)];},'error':function(_0x204861){var _0xca49dd=_0x12e5fb;console[_0xca49dd(0x235)](_0x204861);}});}function GetDepartments(){var _0x15e5ff=a0_0x148606,_0x364266=_spPageContextInfo[_0x15e5ff(0x23d)]+_0x15e5ff(0x212);$[_0x15e5ff(0x258)]({'url':_0x364266,'method':_0x15e5ff(0x216),'async':![],'headers':{'Accept':_0x15e5ff(0x2ba)},'success':function(_0x21af87){var _0x4b21b6=_0x15e5ff;AllDepartments=_0x21af87['d'][_0x4b21b6(0x2d6)];},'error':function(_0x576338){var _0x5c4635=_0x15e5ff;console[_0x5c4635(0x235)](_0x576338);}});}function GetOfficeLocation(){var _0x5411e0=a0_0x148606,_0x564b21=_spPageContextInfo['webAbsoluteUrl']+_0x5411e0(0x1ac);$[_0x5411e0(0x258)]({'url':_0x564b21,'method':_0x5411e0(0x216),'async':![],'headers':{'Accept':_0x5411e0(0x2ba)},'success':function(_0x2c979a){var _0x1755c1=_0x5411e0;AllOfficeLocation=_0x2c979a['d'][_0x1755c1(0x2d6)];},'error':function(_0x2fb6d2){var _0x8babec=_0x5411e0;console[_0x8babec(0x235)](_0x2fb6d2);}});}function GetSubSiteUrl(_0x202098,_0x1e8a7d){var _0x4847a0=a0_0x148606,_0x1b5c80,_0x277eb6=_spPageContextInfo[_0x4847a0(0x23d)]+_0x4847a0(0x203)+_0x202098+'\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20'+_0x1e8a7d+_0x4847a0(0x294);return $[_0x4847a0(0x258)]({'url':_0x277eb6,'method':'GET','async':![],'headers':{'Accept':_0x4847a0(0x2ba)},'success':function(_0x4d69d1){var _0x210702=_0x4847a0;_0x1b5c80=_0x4d69d1['d'][_0x210702(0x2d6)][0x0][_0x210702(0x231)];},'error':function(_0x256040){var _0x2f4594=_0x4847a0;console[_0x2f4594(0x235)](_0x256040);}}),_0x1b5c80;}function AddUserinSharePointGroup(_0x26b80e){var _0x35ab32=a0_0x148606,_0x28d633=$['Deferred'](),_0x4be2cf=_0x35ab32(0x206),_0x30ab21=_0x4be2cf+_0x26b80e,_0x31459a=_spPageContextInfo[_0x35ab32(0x23d)]+_0x35ab32(0x242)+contributersGroupId+_0x35ab32(0x240);$['ajax']({'url':_0x31459a,'type':_0x35ab32(0x247),'async':![],'data':JSON[_0x35ab32(0x1a0)]({'__metadata':{'type':_0x35ab32(0x23f)},'LoginName':_0x30ab21}),'headers':{'accept':'application/json;odata=verbose','content-type':'application/json;odata=verbose','X-RequestDigest':$(_0x35ab32(0x28f))[_0x35ab32(0x2dc)]()},'success':_0x97a914,'error':_0x59912a});function _0x97a914(_0x2b7d0){var _0x289f79=_0x35ab32;_0x28d633[_0x289f79(0x228)](_0x2b7d0['d']['Id']),console['log']('User\x20Added');}function _0x59912a(_0x3f147e){var _0x3aa880=_0x35ab32;console[_0x3aa880(0x235)](JSON['stringify'](_0x3f147e));}return _0x28d633[_0x35ab32(0x263)]();}function GetUserId(_0x45d687){var _0x3de178=a0_0x148606,_0xfaa1b5='',_0x2b0fa9=_0x3de178(0x206),_0x252b06=_spPageContextInfo[_0x3de178(0x29c)],_0x39aac7=_0x2b0fa9+_0x45d687;return $[_0x3de178(0x258)]({'url':_0x252b06+'/_api/web/siteusers(@v)?@v=\x27'+encodeURIComponent(_0x39aac7)+'\x27','method':_0x3de178(0x216),'headers':{'Accept':_0x3de178(0x2ba)},'async':![],'success':function(_0x35bf78){_0xfaa1b5=_0x35bf78['d']['Id'];},'error':function(_0x34e4ce){var _0x455d4e=_0x3de178;console[_0x455d4e(0x235)](JSON['stringify'](_0x34e4ce));}}),_0xfaa1b5;}function a0_0x1927(_0x37374c,_0xbc11b5){var _0x2931ac=a0_0x2931();return a0_0x1927=function(_0x19270f,_0x4cbd17){_0x19270f=_0x19270f-0x196;var _0x126487=_0x2931ac[_0x19270f];return _0x126487;},a0_0x1927(_0x37374c,_0xbc11b5);}var GetAllGroupsUser=[],GroupUrl=_spPageContextInfo[a0_0x148606(0x29c)]+a0_0x148606(0x220);function GetAllUserId(){var _0x4c7ad3=a0_0x148606;$[_0x4c7ad3(0x258)]({'url':GroupUrl,'method':_0x4c7ad3(0x216),'headers':{'Accept':_0x4c7ad3(0x2ba)},'async':![],'success':function(_0x599edb){var _0x79c721=_0x4c7ad3;GetAllGroupsUser=GetAllGroupsUser['concat'](_0x599edb['d'][_0x79c721(0x2d6)]),_0x599edb['d'][_0x79c721(0x19b)]!=null&&(GroupUrl=_0x599edb['d'][_0x79c721(0x19b)],GetAllUserId());},'error':function(_0x40b75b){console['log'](JSON['stringify'](_0x40b75b));}});}var LoginName;function UpdateExistingEmployeeAllocated(_0xa1de4e,_0x2676d3){var _0x270510=a0_0x148606;try{UserEmailId=_0xa1de4e[0x0][_0x270510(0x1cc)],LoginName=_0x270510(0x206)+_0xa1de4e[0x0][_0x270510(0x1cc)];var _0x51426e,_0x21a838,_0x589a63=GetAllGroupsUser[_0x270510(0x1b6)](function(_0x349c11){var _0x4da76d=_0x270510;return _0x349c11[_0x4da76d(0x1cc)][_0x4da76d(0x214)]()==_0xa1de4e[0x0][_0x4da76d(0x1cc)][_0x4da76d(0x214)]();});if(_0x589a63[_0x270510(0x198)]>0x0)var _0x43da75=_0x589a63[0x0]['Id'];else{}if(TopExecutive==_0x270510(0x2be)||_0xa1de4e[0x0][_0x270510(0x1ab)]==undefined)_0xa1de4e[0x0][_0x270510(0x2a2)]=_0x270510(0x2be),_0x51426e=-0x1;else{var _0x577b7c=EmployeeListUsers['filter'](function(_0x16a0d1){var _0x15c3dd=_0x270510,_0x280184;if(_0x16a0d1[_0x15c3dd(0x1ab)]!=null)return _0x280184=_0x16a0d1[_0x15c3dd(0x1cc)][_0x15c3dd(0x214)](),_0x280184==_0xa1de4e[0x0]['Manager'][_0x15c3dd(0x214)]();});if(_0x577b7c[_0x270510(0x198)]>0x0){_0x21a838=_0x577b7c[0x0][_0x270510(0x21e)];var _0x589a63=GetAllGroupsUser['filter'](function(_0x2eb0f5){var _0x57c0f5=_0x270510;return _0x2eb0f5[_0x57c0f5(0x1cc)]['toLowerCase']()==_0xa1de4e[0x0]['Manager'][_0x57c0f5(0x214)]();});if(_0x589a63[_0x270510(0x198)]>0x0)_0x51426e=_0x589a63[0x0]['Id'];else{}}else{IsManager=![],_0x51426e='';var _0x1ab5ce=excelRows[_0x270510(0x2a9)](_0x37608a=>_0x37608a[_0x270510(0x1cc)][_0x270510(0x214)]()==_0xa1de4e[0x0][_0x270510(0x1cc)][_0x270510(0x214)]());excelRows[_0x1ab5ce]['Status']=_0x270510(0x2c2);}}var _0x551fb8,_0x388bde=GetItemTypeForListName(_0x2676d3);_0x551fb8={'__metadata':{'type':_0x388bde},'Designation':_0xa1de4e[0x0]['Designation'],'GroupName':_0xa1de4e[0x0][_0x270510(0x1be)],'Manager':_0x21a838,'ManagerLoginNameId':_0x51426e},$[_0x270510(0x199)](updateItemExitUser(_0x2676d3,_0x551fb8,_0xa1de4e[0x0]['EmpUserId']))[_0x270510(0x2d4)](function(_0x3d204e){var _0x54a615=_0x270510,_0x5299b4=_0x3d204e;if(_0x5299b4){lblUpdate=lblUpdate+0x1,Exits=Exits-0x1;var _0x281da4=excelRows[_0x54a615(0x2a9)](_0x2e110b=>_0x2e110b['Email']==UserEmailId);excelRows[_0x281da4][_0x54a615(0x21c)]='Updated',showmessage();}});}catch(_0x312503){console[_0x270510(0x235)](_0x312503['message']);}}var IsManager=!![];function AddNewEmployeeAllocated(_0x414ece,_0x1809e9){var _0x36e341=a0_0x148606,_0x56c5aa=![];try{var _0x57b97b=AllCompanies[_0x36e341(0x1b6)](function(_0x43b3f2){var _0x1a039f=_0x36e341;return _0x43b3f2['ID']==parseInt(_0x414ece[0x0][_0x1a039f(0x1a7)]);});if(!(_0x57b97b[_0x36e341(0x198)]>0x0))return alert(_0x36e341(0x204)),_0x56c5aa=![],![];var _0x3f4b12=AllDepartments[_0x36e341(0x1b6)](function(_0x3ced4b){var _0x267df2=_0x36e341;return _0x3ced4b['ID']==parseInt(_0x414ece[0x0][_0x267df2(0x28d)]);});if(!(_0x3f4b12[_0x36e341(0x198)]>0x0))return alert('Department\x20Id\x20is\x20not\x20Correct'),_0x56c5aa=![],![];var _0x2768fb=AllOfficeLocation[_0x36e341(0x1b6)](function(_0x3766a2){var _0x28593e=_0x36e341;return _0x3766a2['ID']==parseInt(_0x414ece[0x0][_0x28593e(0x2ae)]);});if(!(_0x2768fb['length']>0x0))return alert(_0x36e341(0x238)),_0x56c5aa=![],![];if(_0x57b97b[_0x36e341(0x198)]>0x0&&_0x3f4b12[_0x36e341(0x198)]>0x0&&_0x2768fb[_0x36e341(0x198)]>0x0){EmployeeDepartment=_0x3f4b12[0x0]['DepartmentName'],EmployeeOfficeLocation=_0x2768fb[0x0][_0x36e341(0x2a0)],LoginName=_0x414ece[0x0][_0x36e341(0x1cc)][_0x36e341(0x214)]();var _0x17891c,_0x249706,_0x26ea98=GetAllGroupsUser[_0x36e341(0x1b6)](function(_0x1f9912){var _0x556e2b=_0x36e341;return _0x1f9912[_0x556e2b(0x1cc)][_0x556e2b(0x214)]()==_0x414ece[0x0][_0x556e2b(0x1cc)][_0x556e2b(0x214)]();}),_0x13c922;if(_0x26ea98[_0x36e341(0x198)]>0x0)var _0x13c922=_0x26ea98[0x0]['Id'];else $[_0x36e341(0x199)](AddUserinSharePointGroup(LoginName))[_0x36e341(0x2d4)](function(_0x48754b){_0x13c922=_0x48754b;});if(TopExecutive==_0x36e341(0x2be)||_0x414ece[0x0]['Manager']==undefined)_0x414ece[0x0][_0x36e341(0x2a2)]='Chief\x20Executive',_0x17891c=-0x1;else{var _0x10d755=EmployeeListUsers[_0x36e341(0x1b6)](function(_0x1d02c7){var _0x53392f=_0x36e341,_0x358128;if(_0x1d02c7[_0x53392f(0x1cc)]!=null)return _0x358128=_0x1d02c7[_0x53392f(0x1cc)][_0x53392f(0x214)](),_0x358128==_0x414ece[0x0][_0x53392f(0x1ab)][_0x53392f(0x214)]();});if(_0x10d755[_0x36e341(0x198)]>0x0){_0x249706=_0x10d755[0x0][_0x36e341(0x21e)];var _0x26ea98=GetAllGroupsUser['filter'](function(_0x49c38a){var _0x21fbf6=_0x36e341;return _0x49c38a[_0x21fbf6(0x1cc)][_0x21fbf6(0x214)]()==_0x414ece[0x0][_0x21fbf6(0x1ab)][_0x21fbf6(0x214)]();});_0x26ea98[_0x36e341(0x198)]>0x0?_0x17891c=_0x26ea98[0x0]['Id']:_0x17891c=AddUserinSharePointGroup(_0x414ece[0x0][_0x36e341(0x1ab)][_0x36e341(0x214)]());}else{IsManager=![],_0x17891c='';var _0x415fbd=excelRows['findIndex'](_0x467cf1=>_0x467cf1[_0x36e341(0x1cc)][_0x36e341(0x214)]()==LoginName);excelRows[_0x415fbd][_0x36e341(0x21c)]='Wrong\x20Manager';}}var _0xfd1bd1,_0x92a4b6=GetItemTypeForListName(_0x1809e9);_0xfd1bd1={'__metadata':{'type':_0x92a4b6},'CompanyId':parseInt(_0x414ece[0x0][_0x36e341(0x1a7)]),'DepartmentId':parseInt(_0x414ece[0x0]['Department']),'FullName':_0x414ece[0x0][_0x36e341(0x215)],'Title':_0x414ece[0x0]['Name'],'ParentId':'-1','Email':_0x414ece[0x0][_0x36e341(0x1cc)],'LogonNameId':_0x13c922,'Manager':_0x414ece[0x0][_0x36e341(0x1ab)],'ManagerLoginNameId':_0x17891c,'OfficeLocationId':parseInt(_0x414ece[0x0][_0x36e341(0x2ae)]),'MobileNumber':_0x414ece[0x0][_0x36e341(0x2ce)],'DateOfBirth':_0x414ece[0x0][_0x36e341(0x1d7)],'Gender':_0x414ece[0x0]['Gender'],'DateOfAnniversary':_0x414ece[0x0][_0x36e341(0x1a2)],'JoiningDate':_0x414ece[0x0][_0x36e341(0x2d8)],'Designation':_0x414ece[0x0]['Designation'],'PrimaryCompany':_0x36e341(0x1a5),'EmployeeID':_0x414ece[0x0][_0x36e341(0x273)],'GroupName':_0x414ece[0x0][_0x36e341(0x1be)],'Status':_0x36e341(0x1cd),'PostalAddresses':_0x414ece[0x0][_0x36e341(0x272)],'City':_0x414ece[0x0][_0x36e341(0x1ae)],'StateProvince':_0x414ece[0x0][_0x36e341(0x23a)],'ZIPPostalCode':_0x414ece[0x0][_0x36e341(0x272)],'Country':_0x414ece[0x0][_0x36e341(0x282)],'HomePhone':_0x414ece[0x0][_0x36e341(0x2ce)],'OtherEMailAddress':_0x414ece[0x0][_0x36e341(0x19c)],'HomeAddress':_0x414ece[0x0]['Home\x20Address']},AddItemToList(_0x1809e9,_0xfd1bd1);var _0x145dc6=new Date(),_0x58f93a=new Date(_0x414ece[0x0][_0x36e341(0x2d8)]),_0x5c69d6=daysDifference(_0x58f93a,_0x145dc6);_0x5c69d6<=0xf&&AddedEmployeeList[_0x36e341(0x1e2)]({'Metadata':_0xfd1bd1,'EmployeeId':_0x414ece[0x0][_0x36e341(0x273)],'EmployeeOfficeLocation':EmployeeOfficeLocation,'EmployeeDepartment':EmployeeDepartment}),_0x56c5aa=!![];}}catch(_0x5153ba){console[_0x36e341(0x235)](_0x5153ba[_0x36e341(0x2b0)]);}return _0x56c5aa;}function daysDifference(_0x23782a,_0x45cf14){var _0xc8ffe2=a0_0x148606,_0x5888bd=new Date(+_0x45cf14)[_0xc8ffe2(0x2a5)](0xc)-new Date(+_0x23782a)[_0xc8ffe2(0x2a5)](0xc);return Math[_0xc8ffe2(0x1c4)](_0x5888bd/0x5265c00);}function updateItemExitUser(_0x313631,_0x6fe657,_0xac9d7e){var _0x4167d1=a0_0x148606,_0x2acfa8=$[_0x4167d1(0x207)]();return $[_0x4167d1(0x258)]({'url':_spPageContextInfo[_0x4167d1(0x23d)]+'/_api/web/lists/getbytitle(\x27'+_0x313631+_0x4167d1(0x2bd)+_0xac9d7e+'\x27)','type':_0x4167d1(0x247),'headers':{'accept':_0x4167d1(0x2b8),'X-RequestDigest':$(_0x4167d1(0x28f))['val'](),'content-Type':_0x4167d1(0x2b8),'X-Http-Method':_0x4167d1(0x234),'If-Match':'*'},'data':JSON[_0x4167d1(0x1a0)](_0x6fe657),'async':![],'success':function(_0x5c91da){_0x2acfa8['resolve'](!![]);},'error':function(_0x4010cf){_0x2acfa8['reject'](_0x4010cf);}}),_0x2acfa8[_0x4167d1(0x263)]();}function AddItemToList(_0xd7cb9c,_0x210786){var _0x9c61e6=a0_0x148606;UserEmailId=_0x210786['Email'];var _0x17f6a0=_0x210786[_0x9c61e6(0x21e)],_0x3aff15=$[_0x9c61e6(0x207)]();return $[_0x9c61e6(0x258)]({'url':_spPageContextInfo[_0x9c61e6(0x23d)]+_0x9c61e6(0x224)+_0xd7cb9c+_0x9c61e6(0x1de),'type':_0x9c61e6(0x247),'async':![],'headers':{'accept':_0x9c61e6(0x2b8),'X-RequestDigest':$(_0x9c61e6(0x28f))['val'](),'content-Type':_0x9c61e6(0x2b8)},'data':JSON['stringify'](_0x210786),'success':function(_0x1a5a12){var _0x5c7a6e=_0x9c61e6;counusers=counusers+0x1,AvilableLicenses=AvilableLicenses-0x1,Ready=Ready-0x1;var _0x1fff23=excelRows[_0x5c7a6e(0x2a9)](_0x5c0326=>_0x5c0326[_0x5c7a6e(0x1cc)]==UserEmailId);excelRows[_0x1fff23][_0x5c7a6e(0x21c)]=_0x5c7a6e(0x1f2),showmessage();var _0xae7cd5=GetSubSiteUrl(_0x5c7a6e(0x1d9),_0x1a5a12['d'][_0x5c7a6e(0x1d5)]);AssignPermissiononDMSLibary(_0x1a5a12['d'][_0x5c7a6e(0x2c0)],'1073741826',_0xae7cd5),_0x3aff15[_0x5c7a6e(0x228)](_0x1a5a12);},'error':function(_0x4d9ca8){var _0x35e192=_0x9c61e6;if(IsManager){var _0x5715f4=excelRows[_0x35e192(0x2a9)](_0xf23395=>_0xf23395[_0x35e192(0x1cc)]==UserEmailId);excelRows[_0x5715f4][_0x35e192(0x21c)]=_0x35e192(0x1cf);}userfullname==''?(userfullname+=_0x17f6a0,warningmessage=_0x35e192(0x1a3)):userfullname+=_0x35e192(0x291)+_0x17f6a0,Ready=Ready-0x1,Error=Error+0x1,console[_0x35e192(0x235)](JSON[_0x35e192(0x1a0)](_0x4d9ca8)),_0x3aff15[_0x35e192(0x1fb)](JSON[_0x35e192(0x1a0)](_0x4d9ca8));}}),_0x3aff15['promise']();}function LoadShowUser(_0x1f5a3e){var _0x483e9c=a0_0x148606;tabledata=new Tabulator('#example-table',{'height':'','pagination':_0x483e9c(0x222),'paginationSize':0xa,'layout':_0x483e9c(0x267),'paginationSizeSelector':[0xa,0x19,0x32,0x64],'placeholder':_0x483e9c(0x2b6),'data':_0x1f5a3e,'pageLoaded':function(_0x4332c3){var _0xc19dcb=_0x483e9c;_0x4332c3>=0x1?pageIndex=_0x4332c3:pageIndex=_0x4332c3,IsMiisingSelect=document['getElementById'](_0xc19dcb(0x1b5)),IsMiisingSelect['checked']&&$(_0xc19dcb(0x274))[_0xc19dcb(0x1d6)](_0xc19dcb(0x1dd),!![]),isReadeySelect=document['getElementById'](_0xc19dcb(0x250)),isReadeySelect[_0xc19dcb(0x1dd)]&&$(_0xc19dcb(0x2c1))['prop']('checked',!![]);},'columns':[{'formatter':function(_0x9ccd27,_0x311f10){var _0x4809c7=_0x483e9c,_0x4d8bf6=_0x9ccd27['_cell'][_0x4809c7(0x252)][_0x4809c7(0x264)][_0x4809c7(0x21c)];return _0x4d8bf6==_0x4809c7(0x28b)||_0x4d8bf6==_0x4809c7(0x229)||_0x4d8bf6==_0x4809c7(0x1f2)||_0x4d8bf6==_0x4809c7(0x249)?_0x4809c7(0x20e):'<input\x20type=\x22checkbox\x22\x20class=\x22select-row_isReadeySelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>';},'title':_0x483e9c(0x1b4),'field':'ID','width':'1%','headerSort':![],'cellClick':function(_0x4b275a,_0x58483a){var _0xed40cd=_0x483e9c,_0x4b688b=$(_0x58483a[_0xed40cd(0x266)]()),_0xdc84ae=_0x4b688b[_0xed40cd(0x20f)](_0xed40cd(0x2c1));_0xdc84ae[0x0][_0xed40cd(0x1dd)]==![]&&$(_0x58483a[_0xed40cd(0x2dd)]()['getElement']())[_0xed40cd(0x20f)](_0xed40cd(0x274))[0x0]['checked']==![]?_0x58483a[_0xed40cd(0x2dd)]()[_0xed40cd(0x22a)]():_0x58483a[_0xed40cd(0x2dd)]()[_0xed40cd(0x23b)]();}},{'formatter':function(_0x4faaaa,_0x4ffd98){var _0x77ae6b=_0x483e9c,_0x2d03d7=_0x4faaaa[_0x77ae6b(0x1b7)]['row'][_0x77ae6b(0x264)][_0x77ae6b(0x21c)];return _0x2d03d7==_0x77ae6b(0x229)||_0x2d03d7=='Already\x20Exist'||_0x2d03d7=='Ready'?'<input\x20type=\x22checkbox\x22\x20class=\x22select-row_IsMiisingSelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>':_0x77ae6b(0x20e);},'title':_0x483e9c(0x2c4),'hozAlign':'center','field':'ID','headerSort':![],'width':'1%','cellClick':function(_0x49e163,_0x44b1a5){var _0x200152=_0x483e9c,_0x13abb0=$(_0x44b1a5['getElement']()),_0x45ee58=_0x13abb0[_0x200152(0x20f)](_0x200152(0x274));_0x45ee58[0x0][_0x200152(0x1dd)]==![]?_0x44b1a5[_0x200152(0x2dd)]()[_0x200152(0x22a)]():_0x44b1a5[_0x200152(0x2dd)]()[_0x200152(0x23b)]();}},{'title':'Status','field':_0x483e9c(0x21c),'width':'10%','formatter':function(_0x451959,_0x3d2a0d){var _0xf64a3e=_0x483e9c,_0x1d3f8f=_0x451959[_0xf64a3e(0x1d0)]();if(_0x1d3f8f==_0xf64a3e(0x28b)||_0x1d3f8f=='Required\x20Value\x20Missing'||_0x1d3f8f=='Not\x20SP\x20Permission'||_0x1d3f8f=='Worng\x20Manager')return'\x20<span\x20style=\x27color:red;\x20font-weight:bold;\x27>'+_0x1d3f8f+_0xf64a3e(0x246);else return _0x1d3f8f==_0xf64a3e(0x27a)?_0xf64a3e(0x1bb)+_0x1d3f8f+_0xf64a3e(0x246):_0xf64a3e(0x1fa)+_0x1d3f8f+'</span>';}},{'title':'Type','field':_0x483e9c(0x2bf),'width':'10%'},{'title':_0x483e9c(0x215),'field':_0x483e9c(0x215),'width':_0x483e9c(0x29a)},{'title':_0x483e9c(0x1cc),'field':'Email','align':'left','width':'15%'},{'title':_0x483e9c(0x1a7),'field':_0x483e9c(0x1e5),'width':_0x483e9c(0x29a),'align':_0x483e9c(0x2c5)},{'title':_0x483e9c(0x28d),'field':_0x483e9c(0x233),'width':'10%','align':_0x483e9c(0x2c5)},{'title':_0x483e9c(0x2ae),'field':'LocationName','width':_0x483e9c(0x29a),'align':_0x483e9c(0x2c5)},{'title':_0x483e9c(0x292),'field':_0x483e9c(0x292),'width':_0x483e9c(0x29a)},{'title':_0x483e9c(0x1ab),'field':_0x483e9c(0x1ab),'width':_0x483e9c(0x29a)},{'title':_0x483e9c(0x2cd),'field':_0x483e9c(0x2d8),'width':_0x483e9c(0x29a)},{'title':'Group\x20Name','field':'Group\x20Name','width':_0x483e9c(0x29a)}]}),showmessage(),$(_0x483e9c(0x21d))['html'](_0x483e9c(0x277)),$(_0x483e9c(0x1b3))[_0x483e9c(0x211)](),$('.tabulator-page-size')[_0x483e9c(0x285)](_0x483e9c(0x1e3));}function showmessage(){var _0xe0d0b7=a0_0x148606;$(_0xe0d0b7(0x26e))[_0xe0d0b7(0x2a8)](Ready),$(_0xe0d0b7(0x218))[_0xe0d0b7(0x2a8)](Error),$(_0xe0d0b7(0x25c))[_0xe0d0b7(0x2a8)](Exits),$(_0xe0d0b7(0x1d3))[_0xe0d0b7(0x2a8)](lblUpdate),$(_0xe0d0b7(0x2cc))[_0xe0d0b7(0x2a8)](AvilableLicenses);}function GraphAccessTokenTogetUserDetails(){var _0x34bda8=a0_0x148606,_0x3c56b2=new jQuery[(_0x34bda8(0x207))](),_0x305be2={'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'accept':'application/json;odata=nometadata','content-type':_0x34bda8(0x2cf)},_0x2cf9f3={'resource':'https://graph.microsoft.com'};return $[_0x34bda8(0x258)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x34bda8(0x1e7),'headers':_0x305be2,'type':_0x34bda8(0x247),'async':![],'data':JSON[_0x34bda8(0x1a0)](_0x2cf9f3),'success':function(_0x4dfcfb){var _0x38faa5=_0x34bda8;token=_0x4dfcfb['access_token'],_0x3c56b2[_0x38faa5(0x228)](token);},'error':function(_0x37684b,_0x16344c,_0x52abf9){var _0x5c77ba=_0x34bda8;console[_0x5c77ba(0x235)](_0x37684b[_0x5c77ba(0x2d9)]),_0x3c56b2['reject'](_0x37684b[_0x5c77ba(0x2d9)]);}}),_0x3c56b2[_0x34bda8(0x263)]();}var employeehtml='',userName='',AzureUsrlist=[],AdusersUrl=a0_0x148606(0x1f0);function GetAzureUsrlist(_0x4f6e1a,_0x3760d4){var _0x2c5a0c=a0_0x148606;return DeferredObj=$['Deferred'](),$['ajax']({'method':'GET','url':_0x4f6e1a,'headers':{'Authorization':_0x2c5a0c(0x278)+_0x3760d4,'Content-Type':_0x2c5a0c(0x2b2)},'async':![],'success':function(_0x5315af){var _0xd4ee61=_0x2c5a0c;AzureUsrlist=AzureUsrlist[_0xd4ee61(0x1f6)](_0x5315af['value']),_0x5315af[_0xd4ee61(0x1ea)]!=null?(AdusersUrl=_0x5315af[_0xd4ee61(0x1ea)],GetAzureUsrlist(AdusersUrl,_0x3760d4)):AdusersUrl='https://graph.microsoft.com/v1.0/users?$top=999&$select=mail,displayName,userPrincipalName,department,officeLocation,companyName,otherMails,userType,identities,creationType,externalUserState,externalUserState,country,employeeId,jobTitle,postalCode,state,streetAddress,city,mobilePhone,accountEnabled,employeeHireDate\x20&$expand=manager($levels=max;$select=id,displayName,mail)';},'error':function(_0x320e40){var _0x40b736=_0x2c5a0c;DeferredObj['reject'](_0x320e40),alert(_0x40b736(0x1c3)+JSON[_0x40b736(0x1a0)](_0x320e40));}}),DeferredObj[_0x2c5a0c(0x263)]();}function getEmployee(_0x12cc83){var _0x422859=a0_0x148606,_0x440844='https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27'+_0x12cc83+'\x27';return DeferredObj=$[_0x422859(0x207)](),$[_0x422859(0x258)]({'method':_0x422859(0x216),'url':_0x440844,'headers':{'Authorization':'Bearer\x20'+token,'Content-Type':_0x422859(0x2b2)},'async':![],'success':function(_0x40e311){var _0x4af9cc=_0x422859;_0x40e311[_0x4af9cc(0x22e)][_0x4af9cc(0x198)]>0x0?DeferredObj[_0x4af9cc(0x228)](_0x40e311[_0x4af9cc(0x22e)][0x0][_0x4af9cc(0x226)]):DeferredObj['resolve'](_0x4af9cc(0x28b));},'error':function(_0x57ed89){var _0x419547=_0x422859;DeferredObj['reject'](_0x57ed89),alert(_0x419547(0x1c3)+JSON['stringify'](_0x57ed89));}}),DeferredObj[_0x422859(0x263)]();}function ClientCredentials(){var _0x2c4579=a0_0x148606,_0x483ffd='EnvironmentalSettings',_0x57dcc9=titanForWork[_0x2c4579(0x1b2)](_0x2c4579(0x19f)),_0x14e211=_spPageContextInfo[_0x2c4579(0x23d)]+_0x2c4579(0x1e4)+_0x483ffd+'\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20';$['ajax']({'url':_0x14e211,'headers':{'Accept':_0x2c4579(0x2b8)},'async':![],'success':function(_0x3f07a7){var _0x8db177=_0x2c4579,_0x2a9293=_0x3f07a7['d']['results'];ClientId=_0x2a9293[0x0][_0x8db177(0x1cb)],ClentSecret=_0x2a9293[0x0][_0x8db177(0x25e)],ClientUrl=_0x2a9293[0x0][_0x8db177(0x275)];},'error':function(_0x304244){var _0x11b27e=_0x2c4579;console[_0x11b27e(0x235)](_0x304244);}});}var EmployeeListUsers=[],GetQueryURL=_spPageContextInfo[a0_0x148606(0x23d)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20';function GetEmployees(){var _0x4e2040=a0_0x148606;$[_0x4e2040(0x258)]({'url':GetQueryURL,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'beforeSend':function(){},'success':function(_0x2b0d18){var _0x3aac0e=_0x4e2040;EmployeeListUsers=EmployeeListUsers[_0x3aac0e(0x1f6)](_0x2b0d18['d'][_0x3aac0e(0x2d6)]);if(_0x2b0d18['d'][_0x3aac0e(0x19b)]!=null)GetQueryURL=_0x2b0d18['d'][_0x3aac0e(0x19b)],GetEmployees();else{GetQueryURL=_spPageContextInfo['webAbsoluteUrl']+_0x3aac0e(0x1ad);var _0x33fc3a=0x0,_0x48be65=_spPageContextInfo[_0x3aac0e(0x23d)]+_0x3aac0e(0x2a6);extdfds=$['Deferred'](),$['when'](getItems(_0x48be65,extdfds))[_0x3aac0e(0x2d4)](function(_0x54256b){var _0x45eb78=_0x3aac0e;response=[],_0x54256b[_0x45eb78(0x198)]>0x0&&(_0x33fc3a=_0x54256b['length']);});}_0x33fc3a!=undefined&&(AvilableLicenses=parseInt(UsersLicenceRequired)-(parseInt(EmployeeListUsers['length'])+parseInt(_0x33fc3a)));},'error':function(_0x25d3c3){var _0x4e5eaf=_0x4e2040;console[_0x4e5eaf(0x235)](_0x25d3c3);}});}$(function(){var _0x251638=a0_0x148606;$('#upload')[_0x251638(0x257)](function(){var _0x260a6d=_0x251638;$(_0x260a6d(0x20d))[_0x260a6d(0x2cb)]()[_0x260a6d(0x27b)](0x5dc)[_0x260a6d(0x2ad)]();var _0x566cea=document[_0x260a6d(0x201)]('fileUpload');GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,counusers=0x0;var _0x4608f6=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x4608f6[_0x260a6d(0x23c)](_0x566cea[_0x260a6d(0x22e)][_0x260a6d(0x214)]())){if(typeof FileReader!='undefined'){var _0x3ba2bc=new FileReader();_0x3ba2bc[_0x260a6d(0x1e0)]?(_0x3ba2bc[_0x260a6d(0x2b1)]=function(_0x38b211){var _0x18c613=_0x260a6d;ProcessExcel(_0x38b211['target'][_0x18c613(0x1f5)]);},_0x3ba2bc[_0x260a6d(0x1e0)](_0x566cea[_0x260a6d(0x261)][0x0])):(_0x3ba2bc['onload']=function(_0x4b9e95){var _0x6deea9=_0x260a6d,_0x1bf4b7='',_0x2ca59b=new Uint8Array(_0x4b9e95[_0x6deea9(0x21a)]['result']);for(var _0xdc0274=0x0;_0xdc0274<_0x2ca59b[_0x6deea9(0x1b9)];_0xdc0274++){_0x1bf4b7+=String[_0x6deea9(0x1c6)](_0x2ca59b[_0xdc0274]);}ProcessExcel(_0x1bf4b7);},_0x3ba2bc[_0x260a6d(0x23e)](_0x566cea[_0x260a6d(0x261)][0x0]));}else alert('This\x20browser\x20does\x20not\x20support\x20HTML5.');}else alert(_0x260a6d(0x1af));});});function ProcessExcel(_0x14add1){var _0x2b2184=a0_0x148606,_0x2f363f=XLSX[_0x2b2184(0x27c)](_0x14add1,{'type':_0x2b2184(0x223)}),_0x1561dd=_0x2f363f[_0x2b2184(0x1bd)][0x0];excelRows=XLSX[_0x2b2184(0x219)]['sheet_to_row_object_array'](_0x2f363f['Sheets'][_0x1561dd]),$('#UploadedItems')['empty'](),$(_0x2b2184(0x1f3))[_0x2b2184(0x1bc)](_0x2b2184(0x225)+excelRows['length']+_0x2b2184(0x1df)),$(_0x2b2184(0x213))[_0x2b2184(0x270)]('');for(var _0x25d4e6=0x0;_0x25d4e6<excelRows[_0x2b2184(0x198)];_0x25d4e6++){var _0x1e65fd='';ErrorUser='';var _0x40afa0=EmployeeListUsers['filter'](function(_0xaaa060){var _0x55cf83=_0x2b2184,_0x348af5=_0xaaa060[_0x55cf83(0x1cc)]['toLowerCase']();return _0x348af5==excelRows[_0x25d4e6][_0x55cf83(0x265)]['toLowerCase']();});if(_0x40afa0[_0x2b2184(0x198)]>0x0){_0x1e65fd=_0x40afa0[0x0][_0x2b2184(0x21e)],color_red=_0x2b2184(0x2a3),ErrorUser='Already\x20Exist',Exits=Exits+0x1;var _0x189bb5=_0x40afa0[0x0]['ID'];excelRows[_0x25d4e6]['Company\x20*']='-',excelRows[_0x25d4e6][_0x2b2184(0x1db)]='-',excelRows[_0x25d4e6]['Location\x20*']='-';}else{var _0x44e65a=AzureUsrlist[_0x2b2184(0x1b6)](function(_0x394ace){var _0xffec4c=_0x2b2184;if(_0x394ace[_0xffec4c(0x256)]!=null){var _0x239fe5=_0x394ace['mail'][_0xffec4c(0x214)]();return _0x239fe5==excelRows[_0x25d4e6][_0xffec4c(0x265)]['toLowerCase']();}});if(_0x44e65a['length']>0x0){_0x1e65fd=_0x44e65a[0x0][_0x2b2184(0x226)];var _0x3678b0=AllCompanies[_0x2b2184(0x1b6)](function(_0x5672f4){var _0x5f1c22=_0x2b2184;return _0x5672f4['ID']==excelRows[_0x25d4e6][_0x5f1c22(0x26f)];}),_0x293292=AllDepartments['filter'](function(_0x152a3a){var _0x31b42b=_0x2b2184;return _0x152a3a['ID']==excelRows[_0x25d4e6][_0x31b42b(0x1db)];}),_0xba872b=AllOfficeLocation['filter'](function(_0x450d21){var _0x3a5218=_0x2b2184;return _0x450d21['ID']==excelRows[_0x25d4e6][_0x3a5218(0x1d8)];});_0x3678b0[_0x2b2184(0x198)]>0x0&&_0x293292[_0x2b2184(0x198)]>0x0&&_0xba872b['length']>0x0?(Ready=Ready+0x1,ErrorUser='Ready',excelRows[_0x25d4e6][_0x2b2184(0x1ef)]=_0x293292[0x0][_0x2b2184(0x233)],excelRows[_0x25d4e6][_0x2b2184(0x243)]=_0xba872b[0x0][_0x2b2184(0x2a0)]):(ErrorUser='Required\x20Value\x20Missing',Error=Error+0x1);}else ErrorUser=_0x2b2184(0x28b),color_red=_0x2b2184(0x2a3),Error=Error+0x1;}excelRows[_0x25d4e6][_0x2b2184(0x215)]=_0x1e65fd,excelRows[_0x25d4e6]['id']=_0x25d4e6,excelRows[_0x25d4e6][_0x2b2184(0x21c)]=ErrorUser,excelRows[_0x25d4e6][_0x2b2184(0x1fe)]=_0x189bb5;}alluserdata=excelRows,LoadShowUser(excelRows);}function CompaniesDetails(){var _0x2cad7b=a0_0x148606,_0x3f5ab0=document[_0x2cad7b(0x201)](_0x2cad7b(0x2d5));_0x3f5ab0[_0x2cad7b(0x260)]='',opt[_0x2cad7b(0x22e)]='0',opt['text']=_0x2cad7b(0x2b5),_0x3f5ab0[_0x2cad7b(0x196)](opt);for(var _0x38707f=0x0;_0x38707f<AllCompanies[_0x2cad7b(0x198)];_0x38707f++){var _0x21ff2f=AllCompanies[_0x38707f][_0x2cad7b(0x1e5)],_0x2e97c8=AllCompanies[_0x38707f]['ID'];opt=document['createElement'](_0x2cad7b(0x28c)),opt[_0x2cad7b(0x22e)]=_0x2e97c8,opt[_0x2cad7b(0x2a8)]=_0x21ff2f,_0x3f5ab0[_0x2cad7b(0x196)](opt);}$(_0x2cad7b(0x2ca))['prop']('checked',![]),$(_0x2cad7b(0x245))[_0x2cad7b(0x2dc)](''),$(_0x2cad7b(0x248))[_0x2cad7b(0x2dc)](''),$('#txtDesignation')['val']('');}$(a0_0x148606(0x221))[a0_0x148606(0x257)](function(){var _0xc5a4df=a0_0x148606,_0x1a13b0=tabledata[_0xc5a4df(0x209)]();debugger;_0x1a13b0['length']>0x0?(CompaniesDetails(),$(_0xc5a4df(0x241))['modal'](_0xc5a4df(0x2de)),initializePeoplePicker(_0xc5a4df(0x255)),peoplePickerDiv=$('[id$=\x27AssaginTomanager_TopSpan\x27]')):alert(_0xc5a4df(0x237));});var GetDepartments,Getofficelocation,GetDesignation,GetGroup,CompaniesId,GetofficelocationName,GetDepartmentsName,CompaniesName;$(a0_0x148606(0x26b))[a0_0x148606(0x257)](function(){var _0x55e2a3=a0_0x148606;if(document[_0x55e2a3(0x201)](_0x55e2a3(0x20a))[_0x55e2a3(0x1dd)]==!![]||document[_0x55e2a3(0x201)](_0x55e2a3(0x29d))[_0x55e2a3(0x1dd)]==!![]||document[_0x55e2a3(0x201)](_0x55e2a3(0x1f4))[_0x55e2a3(0x1dd)]==!![]||document[_0x55e2a3(0x201)](_0x55e2a3(0x2d0))[_0x55e2a3(0x1dd)]==!![]||document[_0x55e2a3(0x201)]('chkTopExecutive')[_0x55e2a3(0x1dd)]==!![]||document[_0x55e2a3(0x201)](_0x55e2a3(0x2c3))[_0x55e2a3(0x1dd)]==!![]){var _0x3000a6=tabledata[_0x55e2a3(0x209)](),_0x2db4b5=SPClientPeoplePicker[_0x55e2a3(0x1b1)][peoplePickerDiv[0x0]['id']],_0x128dac=_0x2db4b5['GetAllUserInfo']();for(var _0x182597=0x0;_0x182597<_0x3000a6[_0x55e2a3(0x198)];_0x182597++){var _0x20d723=excelRows[_0x55e2a3(0x2a9)](_0x1c3ff6=>_0x1c3ff6[_0x55e2a3(0x1cc)]==_0x3000a6[_0x182597]['_row']['data'][_0x55e2a3(0x1cc)]);if(excelRows[_0x20d723][_0x55e2a3(0x21c)]==_0x55e2a3(0x27a))excelRows[_0x20d723][_0x55e2a3(0x1a7)]='-',excelRows[_0x20d723][_0x55e2a3(0x28d)]='-',excelRows[_0x20d723][_0x55e2a3(0x2ae)]='-',document[_0x55e2a3(0x201)](_0x55e2a3(0x1f4))[_0x55e2a3(0x1dd)]&&(excelRows[_0x20d723][_0x55e2a3(0x292)]=$('#txtDesignation')['val']()),document[_0x55e2a3(0x201)](_0x55e2a3(0x2d0))[_0x55e2a3(0x1dd)]&&(excelRows[_0x20d723][_0x55e2a3(0x1ab)]=_0x128dac[0x0]['EntityData'][_0x55e2a3(0x1cc)]),document[_0x55e2a3(0x201)](_0x55e2a3(0x1e1))['checked']&&(excelRows[_0x20d723]['Manager']=_0x55e2a3(0x2be)),document['getElementById']('chkGroup')[_0x55e2a3(0x1dd)]&&(excelRows[_0x20d723]['Group\x20Name']=$(_0x55e2a3(0x248))[_0x55e2a3(0x2dc)]());else{if(excelRows[_0x20d723]['Status']=='Required\x20Value\x20Missing'||excelRows[_0x20d723]['Status']=='Ready'){document[_0x55e2a3(0x201)](_0x55e2a3(0x20a))['checked']&&(excelRows[_0x20d723]['Company']=CompaniesId,excelRows[_0x20d723]['CompanyName']=CompaniesName,excelRows[_0x20d723][_0x55e2a3(0x28d)]=GetDepartments,excelRows[_0x20d723][_0x55e2a3(0x233)]=GetDepartmentsName);document[_0x55e2a3(0x201)](_0x55e2a3(0x29d))['checked']&&(excelRows[_0x20d723][_0x55e2a3(0x1a7)]=CompaniesId,excelRows[_0x20d723]['CompanyName']=CompaniesName,excelRows[_0x20d723][_0x55e2a3(0x2ae)]=Getofficelocation,excelRows[_0x20d723]['LocationName']=GetofficelocationName);document['getElementById'](_0x55e2a3(0x1f4))[_0x55e2a3(0x1dd)]&&(excelRows[_0x20d723]['Designation']=$('#txtDesignation')[_0x55e2a3(0x2dc)]());document[_0x55e2a3(0x201)](_0x55e2a3(0x2d0))[_0x55e2a3(0x1dd)]&&(excelRows[_0x20d723][_0x55e2a3(0x1ab)]=_0x128dac[0x0][_0x55e2a3(0x27f)][_0x55e2a3(0x1cc)]);document[_0x55e2a3(0x201)](_0x55e2a3(0x1e1))[_0x55e2a3(0x1dd)]&&(excelRows[_0x20d723][_0x55e2a3(0x1ab)]=_0x55e2a3(0x2be));document[_0x55e2a3(0x201)]('chkGroup')[_0x55e2a3(0x1dd)]&&(excelRows[_0x20d723]['Group\x20Name']=$(_0x55e2a3(0x248))[_0x55e2a3(0x2dc)]());var _0x1e2187=AllCompanies['filter'](function(_0x46cab0){var _0x4cf701=_0x55e2a3;return _0x46cab0['ID']==excelRows[_0x20d723][_0x4cf701(0x1a7)];}),_0x1b4911=AllDepartments[_0x55e2a3(0x1b6)](function(_0x5c3a62){return _0x5c3a62['ID']==excelRows[_0x20d723]['Department'];}),_0x597955=AllOfficeLocation[_0x55e2a3(0x1b6)](function(_0x5362f2){var _0x3fe79d=_0x55e2a3;return _0x5362f2['ID']==excelRows[_0x20d723][_0x3fe79d(0x2ae)];});_0x1e2187[_0x55e2a3(0x198)]>0x0&&_0x1b4911[_0x55e2a3(0x198)]>0x0&&_0x597955['length']>0x0?(Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x20d723][_0x55e2a3(0x21c)]='Ready'):(excelRows[_0x20d723][_0x55e2a3(0x21c)]='Required\x20Value\x20Missing',Error=Error+0x1);}else excelRows[_0x20d723][_0x55e2a3(0x21c)]=='Wrong\x20Manager'&&(document[_0x55e2a3(0x201)](_0x55e2a3(0x1f4))['checked']&&(excelRows[_0x20d723][_0x55e2a3(0x292)]=$('#txtDesignation')[_0x55e2a3(0x2dc)]()),document[_0x55e2a3(0x201)](_0x55e2a3(0x2d0))[_0x55e2a3(0x1dd)]&&(excelRows[_0x20d723][_0x55e2a3(0x1ab)]=_0x128dac[0x0]['EntityData']['Email']),document[_0x55e2a3(0x201)]('chkTopExecutive')[_0x55e2a3(0x1dd)]&&(excelRows[_0x20d723]['Manager']=_0x55e2a3(0x2be)),document[_0x55e2a3(0x201)]('chkGroup')[_0x55e2a3(0x1dd)]&&(excelRows[_0x20d723]['Group\x20Name']=$(_0x55e2a3(0x248))['val']()),Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x20d723]['Status']=_0x55e2a3(0x276));}}tabledata[_0x55e2a3(0x2d1)](excelRows),tabledata[_0x55e2a3(0x25a)](pageIndex),$(_0x55e2a3(0x241))[_0x55e2a3(0x230)](_0x55e2a3(0x1ec)),showmessage();}else alert('please\x20check\x20at\x20list\x20one\x20checkbox\x20'),$(_0x55e2a3(0x1eb))['val']();}),$(a0_0x148606(0x1ff))['change'](function(){var _0x3e8273=a0_0x148606;CompaniesId=parseInt($(_0x3e8273(0x296),$(this))[_0x3e8273(0x2dc)]()),CompaniesName=$(_0x3e8273(0x296),$(this))['text']();var _0x4bb08e=AllOfficeLocation['filter'](function(_0xadb578){var _0x2655a0=_0x3e8273;return _0xadb578[_0x2655a0(0x283)]===CompaniesId;}),_0x1211e3=document[_0x3e8273(0x201)](_0x3e8273(0x2df));_0x1211e3[_0x3e8273(0x260)]='';for(var _0x5ad463=0x0;_0x5ad463<_0x4bb08e[_0x3e8273(0x198)];_0x5ad463++){var _0x405b57=_0x4bb08e[_0x5ad463][_0x3e8273(0x2a0)],_0x563b4a=_0x4bb08e[_0x5ad463]['ID'];opt=document[_0x3e8273(0x2b9)](_0x3e8273(0x28c)),opt[_0x3e8273(0x22e)]=_0x563b4a,opt[_0x3e8273(0x2a8)]=_0x405b57,_0x1211e3[_0x3e8273(0x196)](opt);}Getofficelocation=parseInt($(_0x3e8273(0x296),$(_0x3e8273(0x1f1)))[_0x3e8273(0x2dc)]()),GetofficelocationName=$(_0x3e8273(0x296),$(_0x3e8273(0x1f1)))[_0x3e8273(0x2a8)]();var _0x15b79b=AllDepartments[_0x3e8273(0x1b6)](function(_0x37578b){var _0x12e48e=_0x3e8273;return _0x37578b[_0x12e48e(0x283)]===CompaniesId;}),_0x1211e3=document[_0x3e8273(0x201)](_0x3e8273(0x1ed));_0x1211e3['innerHTML']='';for(var _0x5ad463=0x0;_0x5ad463<_0x15b79b[_0x3e8273(0x198)];_0x5ad463++){var _0x405b57=_0x15b79b[_0x5ad463][_0x3e8273(0x233)],_0x563b4a=_0x15b79b[_0x5ad463]['ID'];opt=document['createElement'](_0x3e8273(0x28c)),opt[_0x3e8273(0x22e)]=_0x563b4a,opt[_0x3e8273(0x2a8)]=_0x405b57,_0x1211e3['appendChild'](opt);}GetDepartments=parseInt($(_0x3e8273(0x296),$(_0x3e8273(0x27e)))[_0x3e8273(0x2dc)]()),GetDepartmentsName=$(_0x3e8273(0x296),$('#ddlDepartment'))[_0x3e8273(0x2a8)]();}),$('#ddlDepartment')['change'](function(){var _0x308258=a0_0x148606;GetDepartments=parseInt($('option:selected',$(this))[_0x308258(0x2dc)]()),GetDepartmentsName=$(_0x308258(0x296),$(_0x308258(0x27e)))[_0x308258(0x2a8)]();}),$(a0_0x148606(0x1f1))[a0_0x148606(0x1b8)](function(){var _0x43afb5=a0_0x148606;Getofficelocation=parseInt($(_0x43afb5(0x296),$(this))[_0x43afb5(0x2dc)]()),GetofficelocationName=$(_0x43afb5(0x296),$(_0x43afb5(0x1f1)))[_0x43afb5(0x2a8)]();});function chkManagerevent(_0x24aeb0){var _0x2b0785=a0_0x148606;if(_0x24aeb0[_0x2b0785(0x1dd)])$(_0x2b0785(0x286))[_0x2b0785(0x1d6)](_0x2b0785(0x1dd),![]),$('#txtmanager')[_0x2b0785(0x2aa)](_0x2b0785(0x236)),$(_0x2b0785(0x245))[_0x2b0785(0x2bc)]();else{}}var TopExecutive='';function chkTopExecutiveevent(_0xdec0d6){var _0x1d5cd7=a0_0x148606;if(_0xdec0d6[_0x1d5cd7(0x1dd)])$(_0x1d5cd7(0x1f8))[_0x1d5cd7(0x1d6)](_0x1d5cd7(0x1dd),![]),$(_0x1d5cd7(0x245))[_0x1d5cd7(0x1d6)](_0x1d5cd7(0x236),!![]),$(_0x1d5cd7(0x245))['val'](''),TopExecutive=_0x1d5cd7(0x2be);else{}}$(a0_0x148606(0x254))[a0_0x148606(0x257)](function(){var _0x5ebc29=a0_0x148606;tabledata[_0x5ebc29(0x29e)](_0x5ebc29(0x21f),_0x5ebc29(0x1c0),{'sheetName':_0x5ebc29(0x200)});});function a0_0x2931(){var _0x45aaf9=['_row','fromCharCode','EmployeeDepartment','EmployeeId','SPClientPeoplePicker_InitStandaloneControlWrapper','ddlfilterAllCompanies','ClientName','Email','Active','close','Not\x20SP\x20Permission','getValue','Employees','722484KEDWzK','#lblUpdate','251px','DepartmentId','prop','Date\x20Of\x20Birth','Location\x20*','Departments','Metadata','Department\x20*','\x27)/items?$select=ID&$filter=ID\x20eq\x20','checked','\x27)/items','</h3>\x20<p\x20class\x20=\x20\x22m-0\x22\x20>\x20Uploaded\x20</p>','readAsBinaryString','chkTopExecutive','push','<span\x20class=\x27breakpoint\x27></span>','/_api/web/lists/GetByTitle(\x27','CompanyName','31785061AeeqFH','/_api/SP.OAuth.Token/Acquire','jobTitle','SearchPrincipalSource','@odata.nextLink','select#dropDownId\x20option:selected','hide','ddlDepartment','streetAddress','DepartmentNameDetail','https://graph.microsoft.com/v1.0/users?$top=999&$select=mail,displayName,userPrincipalName,department,officeLocation,companyName,otherMails,userType,identities,creationType,externalUserState,externalUserState,country,employeeId,jobTitle,postalCode,state,streetAddress,city,mobilePhone,accountEnabled,employeeHireDate\x20&$expand=manager($levels=max;$select=id,displayName,mail)','#ddlOfficeLocation','Added','#UploadedItems','chkDesignation','result','concat','Data\x20Send\x20to\x20Announcements','#chkManager','#divAudience','\x20<span\x20style=\x27color:green;\x20font-weight:bold;\x27>','reject','deselectRow','accountEnabled','EmpUserId','#ddlAllCompanies','EmployeeSyncreport','getElementById','#btnadsync','/_api/web/lists/getByTitle(\x27','Company\x20Id\x20is\x20not\x20Correct','Data\x20Send\x20to\x20Announcements\x20Failed','i:0#.f|membership|','Deferred','location','getSelectedRows','chkDepartment','Please\x20select\x20Location','PendingAcceptance','#overlayq','<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>','find','ListItem','remove','/_api/web/lists/getByTitle(\x27Departments\x27)/items?$select=*','#dvExcel','toLowerCase','Name','GET','Your\x20License\x20limit\x20has\x20been\x20ended','#Error','utils','target','New\x20Joinee','Status','#Rowcount','FullName','xlsx','/_api/web/siteusers?$top=1000&$select=*,Id','#btnUploadExcel','local','binary','/_api/web/lists/getbytitle(\x27','<h3\x20class=\x27m-0\x27>','displayName','formatDate','resolve','Required\x20Value\x20Missing','deselect','#ddlfilterAllCompanies','#ddlfilterOfficeLocation',',roleDefId=','value','exceltble','modal','SiteURL','OfficeLocationsId','DepartmentName','PATCH','log','readonly','Please\x20select\x20required\x20value\x20missing\x20row','Office\x20Location\x20Id\x20is\x20not\x20Correct','/_api/web/lists/GetByTitle(\x27Announcements\x27)/items','state','select','test','webAbsoluteUrl','readAsArrayBuffer','SP.User',')/users','#UploadExcel','/_api/web/sitegroups(','OfficeNameDetail','officeLocation','#txtmanager','</span>','POST','#txtGroup','Updated','ResolvePrincipalSource','indexOf','DepartmentsId','Expires','NotSave','department','isReadeySelected','selectRow','row','#btnAudience','#btnDownLoadReport','AssaginTomanager','mail','click','ajax','PrincipalAccountType','setPage','MaximumEntitySuggestions','#Exits','Audience','ChangeFileName','companyName','innerHTML','files','employeeHireDate','promise','data','Email\x20*','getElement','fitColumns','UserType','JoiningDate','OfficeLocation','#btnmissingrequedvalue','OfficeLocationId','join','#Ready','Company\x20*','html','Please\x20select\x20Department','postalCode','employeeId','.select-row_IsMiisingSelected','Description','Ready','Total\x20Row\x20Count:\x20','Bearer\x20','SP.Data.AnnouncementsListItem','Already\x20Exist','delay','read','dd\x20M\x20yy','#ddlDepartment','EntityData','Announcement_Type','setMonth','country','CompanyIDId','1015973VCOCQR','after','#chkTopExecutive','Title','input[type=radio][name=datasend]','ready','#btnFilter','Invalid\x20Profile','option','Department','</option>','#__REQUESTDIGEST','map','\x20,\x20','Designation','#overlaysearch','&$top=1','4394012wsjsUW','option:selected','split','ddlfilterOfficeLocation','width','10%','Corporate','siteAbsoluteUrl','chkOfficeLocation','download','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','OfficeName','All','Manager\x20*','color-red','manager','setHours','/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27))','2915415TyClRm','text','findIndex','removeProp','.searching','User,DL,SecGroup,SPGroup','fadeOut','Location','Internal\x20','message','onload','application/json','SP.Data.','#isReadeySelected','Select\x20Company','Click\x20on\x20Azure\x20Sync\x20button\x20first.','External','application/json;odata=verbose','createElement','application/json;\x20odata=verbose','href','focus','\x27)/GetItemById(\x27','Chief\x20Executive','Type','LogonNameId','.select-row_isReadeySelected','Worng\x20Manager','chkGroup','<input\x20type=\x22checkbox\x22\x20id=\x22IsMiisingSelected\x22\x20onclick=\x22IsMiisingSelecteds()\x22\x20/>','center','externalUserState','#ddlfilterDepartments','mm/dd/yy','<option\x20value=\x220\x22><strong>All</strong></option>','.form-check-input','fadeIn','#AvilableLicenses','Date\x20Of\x20Joining','mobilePhone','application/json;odata=nometadata','chkManager','setData','#added','1608872DlSEuE','done','ddlAllCompanies','results','8ojQjii','DateOfJoining','responseText','userType','#successfully_notifications','val','getRow','show','ddlOfficeLocation','appendChild','#btnsubmitready','length','when','getMonth','__next','otherMails','Approved','AllowMultipleValues','CompanyId','stringify','toUpperCase','Date\x20Of\x20Marriage','The\x20following\x20users\x20failed\x20to\x20sync\x20due\x20to\x20wrong\x20manager\x20defined!.\x0a','Publish_Date','Primary','static','Company','datepicker','Internal\x20Users','DOJ:\x20','Manager','/_api/web/lists/getByTitle(\x27OfficeLocation\x27)/items?$select=*','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20','city','Please\x20upload\x20a\x20valid\x20Excel\x20file.','EmployeeOfficeLocation','SPClientPeoplePickerDict','getQueryStringParameter','.breakpoint','<input\x20type=\x22checkbox\x22\x20id=\x22isReadeySelected\x22\x20onclick=\x22isReadeySelecteds()\x22\x20/>','IsMiisingSelected','filter','_cell','change','byteLength','4185396BReQyS','\x20<span\x20style=\x27color:blue;\x20font-weight:bold;\x27>','append','SheetNames','Group\x20Name','ddlfilterDepartments','EmployeeSyncReport.xlsx','User\x20has\x20been\x20assigned\x20permission\x20.','/_api/web/lists/getByTitle(\x27Companies\x27)/items?$select=*','error1','round'];a0_0x2931=function(){return _0x45aaf9;};return a0_0x2931();}var dvExcel=document[a0_0x148606(0x201)](a0_0x148606(0x22f));dvExcel[a0_0x148606(0x260)]='';var outputArray=[];function removewithfilter(_0x42c984){var _0x407d2f=a0_0x148606;let _0x4455ef=_0x42c984[_0x407d2f(0x1b6)](function(_0x421732,_0x17baf2,_0x27d56e){var _0x2168e0=_0x407d2f;return _0x17baf2==_0x27d56e[_0x2168e0(0x24b)](_0x421732);});return _0x4455ef;}function GetItemTypeForListName(_0x413d9c){var _0x2b56a6=a0_0x148606;return _0x2b56a6(0x2b3)+_0x413d9c['charAt'](0x0)[_0x2b56a6(0x1a1)]()+_0x413d9c[_0x2b56a6(0x297)]('\x20')[_0x2b56a6(0x26d)]('')['slice'](0x1)+_0x2b56a6(0x210);}var response=response||[];function getItems(_0x314ecf,_0x53af9e){var _0xce88f5=a0_0x148606;return $[_0xce88f5(0x258)]({'url':_0x314ecf,'type':_0xce88f5(0x216),'async':![],'headers':{'accept':_0xce88f5(0x2b8)},'success':function(_0x372771){var _0x15104f=_0xce88f5;response=response[_0x15104f(0x1f6)](_0x372771['d']['results']),_0x372771['d'][_0x15104f(0x19b)]?(_0x314ecf=_0x372771['d'][_0x15104f(0x19b)],getItems(_0x314ecf,_0x53af9e)):_0x53af9e[_0x15104f(0x228)](response);},'error':function(_0x1a35c3){var _0x51e1ba=_0xce88f5;_0x53af9e[_0x51e1ba(0x1fb)](_0x1a35c3),console[_0x51e1ba(0x235)](_0x1a35c3);}}),_0x53af9e[_0xce88f5(0x263)]();}function InsertWelcomeInAnnouncementList(_0x22f130){var _0x2771f7=a0_0x148606;$[_0x2771f7(0x258)]({'url':_spPageContextInfo[_0x2771f7(0x23d)]+_0x2771f7(0x239),'type':_0x2771f7(0x247),'async':![],'data':JSON['stringify'](_0x22f130),'headers':{'Accept':_0x2771f7(0x2b8),'Content-Type':_0x2771f7(0x2b8),'X-RequestDigest':$(_0x2771f7(0x28f))[_0x2771f7(0x2dc)](),'X-HTTP-Method':_0x2771f7(0x247)},'success':function(_0x1f370f,_0x5a6dd3,_0x499f05){var _0x1b94ee=_0x2771f7;console['log'](_0x1b94ee(0x1f7));},'error':function(_0x5837cc){var _0x1f92ed=_0x2771f7;console[_0x1f92ed(0x235)](_0x5837cc),console[_0x1f92ed(0x235)](_0x1f92ed(0x205)),currentDlg['close']();}});}