var a0_0x3026c6=a0_0x456c;(function(_0x79a1a2,_0x1ef423){var _0x397ac0=a0_0x456c,_0x492356=_0x79a1a2();while(!![]){try{var _0x219f71=-parseInt(_0x397ac0(0x247))/0x1+parseInt(_0x397ac0(0x22a))/0x2*(parseInt(_0x397ac0(0x210))/0x3)+-parseInt(_0x397ac0(0x23f))/0x4*(parseInt(_0x397ac0(0x124))/0x5)+parseInt(_0x397ac0(0x201))/0x6+-parseInt(_0x397ac0(0x189))/0x7*(parseInt(_0x397ac0(0x13f))/0x8)+-parseInt(_0x397ac0(0x221))/0x9*(parseInt(_0x397ac0(0x1c7))/0xa)+-parseInt(_0x397ac0(0x187))/0xb*(-parseInt(_0x397ac0(0x20b))/0xc);if(_0x219f71===_0x1ef423)break;else _0x492356['push'](_0x492356['shift']());}catch(_0x1cf7b0){_0x492356['push'](_0x492356['shift']());}}}(a0_0x2737,0x99adc));var token,ClientId='',ClentSecret='',ClientUrl='',DeferredObj=$[a0_0x3026c6(0x186)](),color_red='',Error=0x0,Ready=0x0,Exits=0x0,lblUpdate=0x0,ErrorUser='',alluserdata,contributersGroupId='',counusers=0x0,excelRows,AllCompanies,AllDepartments,AllOfficeLocation,tabledata,pageIndex,UserEmailId,warningmessage='',userfullname='',AvilableLicenses,ReadySelected=[],MiisingSelected=[],AddedEmployeeList=[],IsMiisingSelect,isReadeySelect,peoplePickerDiv='',IsaddedNewEmployee=![],EmployeeId='',EmployeeDepartment='',EmployeeOfficeLocation='',checkedAudience='',IsNotification=![];$(document)[a0_0x3026c6(0x1af)](function(){var _0x54be3c=a0_0x3026c6;GraphAccessTokenTogetUserDetails(),GetCompanies(),GetOfficeLocation(),GetDepartments(),LoadShowUser([]),GetAllUserId(),GetEmployees(),AvilableLicenses==NaN&&GetEmployees(),$(_0x54be3c(0x259))[_0x54be3c(0x178)](AvilableLicenses);});function initializePeoplePicker(_0x283dc8){var _0x2de21a=a0_0x3026c6,_0x40441c={};_0x40441c['PrincipalAccountType']=_0x2de21a(0x1e0),_0x40441c[_0x2de21a(0x1a9)]=0xf,_0x40441c['ResolvePrincipalSource']=0xf,_0x40441c[_0x2de21a(0x1be)]=![],_0x40441c[_0x2de21a(0x24d)]=0x32,_0x40441c[_0x2de21a(0x21a)]='251px',this[_0x2de21a(0x15d)](_0x283dc8,null,_0x40441c),$(_0x2de21a(0x1d6))[_0x2de21a(0x1c8)](0xfa);}function GetSelectItem(){var _0x51c12f=a0_0x3026c6;IsaddedNewEmployee=![];if(contributersGroupId!==''){var _0x11cf92=tabledata[_0x51c12f(0x1d7)]();counusers=0x0;for(var _0x5d79b6=0x0;_0x5d79b6<_0x11cf92[_0x51c12f(0x1ef)];_0x5d79b6++){var _0x1391de=alluserdata['filter'](function(_0x553a7f){var _0xfe7bc1=_0x51c12f;return _0x553a7f[_0xfe7bc1(0x18e)]==_0x11cf92[_0x5d79b6][_0xfe7bc1(0x1b0)][_0xfe7bc1(0x1e1)]['Email\x20*'];});AvilableLicenses>0x0?_0x1391de[0x0][_0x51c12f(0x239)]==_0x51c12f(0x16c)?(AddNewEmployeeAllocated(_0x1391de,_0x51c12f(0x12a)),IsaddedNewEmployee=!![]):_0x1391de[0x0][_0x51c12f(0x239)]==_0x51c12f(0x12f)&&UpdateExistingEmployeeAllocated(_0x1391de,_0x51c12f(0x12a)):($(_0x51c12f(0x18c))[_0x51c12f(0x178)](counusers),alert('Your\x20License\x20limit\x20has\x20been\x20ended'),_0x5d79b6=_0x11cf92[_0x51c12f(0x1ef)]);}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$('#added')['text'](counusers),showmessage(),tabledata[_0x51c12f(0x23e)](excelRows),tabledata[_0x51c12f(0x1d2)](pageIndex),IsaddedNewEmployee&&($('#successfully_notifications')[_0x51c12f(0x161)]({'backdrop':_0x51c12f(0x1a6),'keyboard':![]},_0x51c12f(0x226)),AddedEmployeeList[_0x51c12f(0x1ef)]>0x0?$(_0x51c12f(0x151))[_0x51c12f(0x226)]():$(_0x51c12f(0x151))[_0x51c12f(0x209)]());}else GetGroupIDByGroupName(),GetSelectItem();}var Temparray=[];$('#btnFilter')[a0_0x3026c6(0x1e4)](function(){var _0x20be1d=a0_0x3026c6;debugger;Temparray=alluserdata;let _0x184d4e=[...new Set(Temparray[_0x20be1d(0x141)](_0x11149b=>_0x11149b['Company\x20*']))];var _0x490cbe=document[_0x20be1d(0x200)](_0x20be1d(0x164));_0x490cbe['innerHTML']='',opt['value']='0',opt[_0x20be1d(0x178)]=_0x20be1d(0x225),_0x490cbe['appendChild'](opt);for(var _0x593a22=0x0;_0x593a22<_0x184d4e['length'];_0x593a22++){opt=document['createElement'](_0x20be1d(0x1d9)),opt['value']=_0x184d4e[_0x593a22],opt[_0x20be1d(0x178)]=_0x184d4e[_0x593a22],_0x490cbe['appendChild'](opt);}Temparray=alluserdata;var _0x3b15bb=[...new Set(Temparray[_0x20be1d(0x141)](_0x592cc3=>_0x592cc3[_0x20be1d(0x184)]))],_0x490cbe=document[_0x20be1d(0x200)](_0x20be1d(0x258)),_0x509c7b=_0x20be1d(0x122);for(var _0x593a22=0x0;_0x593a22<_0x3b15bb[_0x20be1d(0x1ef)];_0x593a22++){_0x509c7b+=_0x20be1d(0x17e)+_0x3b15bb[_0x593a22]+'\x22>'+_0x3b15bb[_0x593a22]+_0x20be1d(0x180);}$(_0x20be1d(0x198))[_0x20be1d(0x138)](_0x509c7b),Temparray=alluserdata;let _0xadbf3=[...new Set(Temparray[_0x20be1d(0x141)](_0x190b91=>_0x190b91[_0x20be1d(0x12b)]))];var _0x490cbe=document[_0x20be1d(0x200)](_0x20be1d(0x120));_0x490cbe[_0x20be1d(0x1ff)]='',opt[_0x20be1d(0x1ad)]='0',opt[_0x20be1d(0x178)]=_0x20be1d(0x167),_0x490cbe[_0x20be1d(0x169)](opt);for(var _0x593a22=0x0;_0x593a22<_0xadbf3['length'];_0x593a22++){opt=document[_0x20be1d(0x183)](_0x20be1d(0x1d9)),opt[_0x20be1d(0x1ad)]=_0xadbf3[_0x593a22],opt[_0x20be1d(0x178)]=_0xadbf3[_0x593a22],_0x490cbe[_0x20be1d(0x169)](opt);}}),$(a0_0x3026c6(0x14b))[a0_0x3026c6(0x1e4)](function(){var _0x554e11=a0_0x3026c6;let _0x4da13d;var _0x14ec8f='',_0x82b761=!![];$('#ddlfilterAllCompanies')[_0x554e11(0x1df)]()!='0'&&(_0x82b761=![]);if($('#ddlfilterDepartments')[_0x554e11(0x1df)]()!='0')_0x82b761=![];else return alert(_0x554e11(0x20f)),![];if($(_0x554e11(0x198))[_0x554e11(0x1df)]()!='0')_0x82b761=![];else return alert(_0x554e11(0x25b)),![];_0x4da13d=alluserdata['filter'](function(_0x573dc1){var _0x11338b=_0x554e11;return _0x573dc1[_0x11338b(0x184)]==$('option:selected',$(_0x11338b(0x198)))[_0x11338b(0x1df)]()&&_0x573dc1[_0x11338b(0x12b)]==$(_0x11338b(0x244),$(_0x11338b(0x217)))[_0x11338b(0x1df)]()&&_0x573dc1[_0x11338b(0x179)]==$(_0x11338b(0x244),$(_0x11338b(0x23b)))[_0x11338b(0x1df)]();});var _0x49ab0a=alluserdata[_0x554e11(0x1f3)](_0x4514cc=>_0x4514cc[_0x554e11(0x184)]===$(_0x554e11(0x244),$('#ddlfilterOfficeLocation'))['val']()&&_0x4514cc[_0x554e11(0x12b)]==$(_0x554e11(0x244),$(_0x554e11(0x217)))[_0x554e11(0x1df)]()&&_0x4514cc[_0x554e11(0x179)]==$(_0x554e11(0x244),$(_0x554e11(0x23b)))[_0x554e11(0x1df)]());_0x82b761?LoadShowUser(alluserdata):LoadShowUser(_0x4da13d);}),$(a0_0x3026c6(0x20d))[a0_0x3026c6(0x1a0)](function(_0x5ef08f){var _0x3f5548=a0_0x3026c6;LoadShowUser(search($(_0x3f5548(0x20d))[_0x3f5548(0x1df)]()));});function search(_0x5a3a4c){return alluserdata['filter'](function(_0x1c1bfc){var _0x5352a6=a0_0x456c;return _0x1c1bfc[_0x5352a6(0x237)]['toLowerCase']()['indexOf'](_0x5a3a4c[_0x5352a6(0x1c0)]())>-0x1||_0x1c1bfc['Email\x20*'][_0x5352a6(0x1c0)]()[_0x5352a6(0x1c2)](_0x5a3a4c[_0x5352a6(0x1c0)]())>-0x1;});}$(a0_0x3026c6(0x1c4))[a0_0x3026c6(0x1de)](function(){checkedAudience=this['value'];}),$(a0_0x3026c6(0x234))['on'](a0_0x3026c6(0x1e4),function(){var _0x3aa80a=a0_0x3026c6;$[_0x3aa80a(0x21d)]({'cache':![],'beforeSend':function(){var _0x1feb37=_0x3aa80a;$(_0x1feb37(0x197))[_0x1feb37(0x1da)]();},'success':function(_0xba1d4e){var _0x15c912=_0x3aa80a;AddedEmployeeList=[],SubmitReady(),$(_0x15c912(0x197))[_0x15c912(0x15b)]();}});}),$('#btnAudience')['on'](a0_0x3026c6(0x1e4),function(){var _0x24bc41=a0_0x3026c6;$[_0x24bc41(0x21d)]({'cache':![],'beforeSend':function(){var _0x4251e8=_0x24bc41;$(_0x4251e8(0x197))[_0x4251e8(0x1da)]();},'success':function(_0x4d8ae6){var _0x52cab9=_0x24bc41;if(AddedEmployeeList[_0x52cab9(0x1ef)]>0x0&&checkedAudience!='NotSave')for(var _0x1376b7=0x0;_0x1376b7<AddedEmployeeList['length'];_0x1376b7++){var _0xa1599e=new Date(AddedEmployeeList[_0x1376b7][_0x52cab9(0x12c)][_0x52cab9(0x14f)]),_0x519f2d=new Date();_0x519f2d[_0x52cab9(0x133)](_0xa1599e['getMonth']()+0x3),_0xa1599e=$[_0x52cab9(0x142)][_0x52cab9(0x125)]('mm/dd/yy',_0xa1599e),_0x519f2d=$['datepicker']['formatDate'](_0x52cab9(0x14a),_0x519f2d);var _0x5990fc=new Date(AddedEmployeeList[_0x1376b7][_0x52cab9(0x12c)]['JoiningDate']);_0x5990fc=$[_0x52cab9(0x142)][_0x52cab9(0x125)](_0x52cab9(0x1d1),_0x5990fc);var _0xb6a6c1=[],_0x4fb8cb=[],_0x54f6b5=[];_0x54f6b5[_0x52cab9(0x211)](Logged_CompanyId);var _0x3ff3ac;_0x3ff3ac={'__metadata':{'type':_0x52cab9(0x25f)}},(_0x3ff3ac[_0x52cab9(0x25c)]=_0x52cab9(0x153),_0x3ff3ac[_0x52cab9(0x1b7)]=AddedEmployeeList[_0x1376b7][_0x52cab9(0x240)][_0x52cab9(0x188)](),_0x3ff3ac['Title']=_0x52cab9(0x1d8),_0x3ff3ac['EmployeeName']=AddedEmployeeList[_0x1376b7]['Metadata'][_0x52cab9(0x19e)],_0x3ff3ac['Designation']=AddedEmployeeList[_0x1376b7][_0x52cab9(0x12c)]['Designation'],_0x3ff3ac[_0x52cab9(0x21b)]=AddedEmployeeList[_0x1376b7][_0x52cab9(0x1b5)],_0x3ff3ac[_0x52cab9(0x14d)]=AddedEmployeeList[_0x1376b7][_0x52cab9(0x16f)],_0x3ff3ac[_0x52cab9(0x1cf)]=_0x52cab9(0x1ab),_0x3ff3ac[_0x52cab9(0x233)]=_0x52cab9(0x153),_0x3ff3ac['Audience']=checkedAudience,_0x3ff3ac[_0x52cab9(0x1b1)]='Approved',_0x3ff3ac[_0x52cab9(0x1db)]=_0xa1599e,_0x3ff3ac[_0x52cab9(0x204)]=_0x519f2d,_0x3ff3ac[_0x52cab9(0x24f)]=_0x52cab9(0x1a8)+_0x5990fc);if(checkedAudience==_0x52cab9(0x23c))_0x54f6b5=[0x0],_0xb6a6c1=[0x0],_0x4fb8cb=[0x0],_0x3ff3ac['CompanyId']={'results':_0x54f6b5},_0x3ff3ac[_0x52cab9(0x214)]={'results':_0x4fb8cb},_0x3ff3ac[_0x52cab9(0x1f7)]={'results':_0xb6a6c1};else{if(checkedAudience==_0x52cab9(0x1b3))_0x54f6b5['push'](AddedEmployeeList[_0x1376b7][_0x52cab9(0x12c)][_0x52cab9(0x135)]),_0xb6a6c1=[0x0],_0x4fb8cb=[0x0],_0x3ff3ac[_0x52cab9(0x135)]={'results':_0x54f6b5},_0x3ff3ac[_0x52cab9(0x214)]={'results':_0x4fb8cb},_0x3ff3ac[_0x52cab9(0x1f7)]={'results':_0xb6a6c1};else{if(checkedAudience=='Department')_0x54f6b5=[0x0],_0xb6a6c1=[0x0],_0x4fb8cb[_0x52cab9(0x211)](AddedEmployeeList[_0x1376b7]['Metadata'][_0x52cab9(0x1c6)]),_0x3ff3ac['CompanyId']={'results':_0x54f6b5},_0x3ff3ac['DepartmentsId']={'results':_0x4fb8cb},_0x3ff3ac[_0x52cab9(0x1f7)]={'results':_0xb6a6c1};else checkedAudience=='Location'&&(_0x54f6b5=[0x0],_0xb6a6c1[_0x52cab9(0x211)](AddedEmployeeList[_0x1376b7][_0x52cab9(0x12c)][_0x52cab9(0x194)]),_0x4fb8cb=[0x0],_0x3ff3ac['CompanyId']={'results':_0x54f6b5},_0x3ff3ac[_0x52cab9(0x214)]={'results':_0x4fb8cb},_0x3ff3ac[_0x52cab9(0x1f7)]={'results':_0xb6a6c1});}}InsertWelcomeInAnnouncementList(_0x3ff3ac);}$(_0x52cab9(0x197))[_0x52cab9(0x15b)]();}});});function SubmitReady(){var _0x5c1baa=a0_0x3026c6;if(contributersGroupId!==''){var _0x5f4ab2=tabledata['getSelectedRows']();counusers=0x0,IsaddedNewEmployee=![];for(var _0x5183bb=0x0;_0x5183bb<_0x5f4ab2[_0x5c1baa(0x1ef)];_0x5183bb++){var _0x266266=alluserdata['filter'](function(_0x39bc31){var _0x2e7616=_0x5c1baa;return _0x39bc31[_0x2e7616(0x18e)]==_0x5f4ab2[_0x5183bb][_0x2e7616(0x1b0)][_0x2e7616(0x1e1)]['Email\x20*'];});if(AvilableLicenses>0x0)_0x266266[0x0][_0x5c1baa(0x239)]=='Ready'?(AddNewEmployeeAllocated(_0x266266,_0x5c1baa(0x12a)),IsaddedNewEmployee=!![]):_0x266266[0x0][_0x5c1baa(0x239)]==_0x5c1baa(0x12f)&&UpdateExistingEmployeeAllocated(_0x266266,_0x5c1baa(0x12a));else return alert(_0x5c1baa(0x21e)),![];}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x5c1baa(0x18c))[_0x5c1baa(0x178)](counusers),showmessage(),tabledata[_0x5c1baa(0x23e)](excelRows),tabledata[_0x5c1baa(0x1d2)](pageIndex),IsaddedNewEmployee&&($(_0x5c1baa(0x249))[_0x5c1baa(0x161)]({'backdrop':_0x5c1baa(0x1a6),'keyboard':![]},_0x5c1baa(0x226)),AddedEmployeeList[_0x5c1baa(0x1ef)]>0x0?$(_0x5c1baa(0x151))[_0x5c1baa(0x226)]():$('#divAudience')[_0x5c1baa(0x209)]());}else GetGroupIDByGroupName(),GetSelectItem();}function isReadeySelecteds(){var _0x157ea0=a0_0x3026c6;isReadeySelect=document[_0x157ea0(0x200)](_0x157ea0(0x22f));if(isReadeySelect['checked']){tabledata[_0x157ea0(0x254)](MiisingSelected),$(_0x157ea0(0x22e))[_0x157ea0(0x202)](_0x157ea0(0x228),![]),$(_0x157ea0(0x245))[_0x157ea0(0x202)](_0x157ea0(0x228),![]),ReadySelected=[];for(var _0x2f4929=0x0;_0x2f4929<excelRows[_0x157ea0(0x1ef)];_0x2f4929++){(excelRows[_0x2f4929][_0x157ea0(0x239)]==_0x157ea0(0x16c)||excelRows[_0x2f4929]['Status']==_0x157ea0(0x12f))&&ReadySelected[_0x157ea0(0x211)](_0x2f4929);}$(_0x157ea0(0x1ed))[_0x157ea0(0x202)](_0x157ea0(0x228),!![]),tabledata[_0x157ea0(0x230)](ReadySelected);}else tabledata[_0x157ea0(0x254)](ReadySelected),$(_0x157ea0(0x1ed))[_0x157ea0(0x202)]('checked',![]);}function IsMiisingSelecteds(){var _0x112c7b=a0_0x3026c6;IsMiisingSelect=document[_0x112c7b(0x200)](_0x112c7b(0x19f));if(IsMiisingSelect[_0x112c7b(0x228)]){tabledata[_0x112c7b(0x254)](ReadySelected),$('#isReadeySelected')[_0x112c7b(0x202)]('checked',![]),$(_0x112c7b(0x1ed))[_0x112c7b(0x202)](_0x112c7b(0x228),![]),MiisingSelected=[];for(var _0x57d2b8=0x0;_0x57d2b8<excelRows[_0x112c7b(0x1ef)];_0x57d2b8++){(excelRows[_0x57d2b8][_0x112c7b(0x239)]==_0x112c7b(0x248)||excelRows[_0x57d2b8][_0x112c7b(0x239)]==_0x112c7b(0x12f)||excelRows[_0x57d2b8][_0x112c7b(0x239)]==_0x112c7b(0x16c))&&(MiisingSelected[_0x112c7b(0x211)](_0x57d2b8),$('.select-row_IsMiisingSelected')['prop'](_0x112c7b(0x228),!![]));}tabledata[_0x112c7b(0x230)](MiisingSelected);}else tabledata[_0x112c7b(0x254)](MiisingSelected),$(_0x112c7b(0x22e))[_0x112c7b(0x202)](_0x112c7b(0x228),![]);}function AssignPermissiononDMSLibary(_0x2feb3a,_0x403773,_0x49844d){var _0x45603=a0_0x3026c6,_0x1cb327={'Accept':_0x45603(0x23a),'content-Type':'application/json;odata=verbose','X-RequestDigest':jQuery(_0x45603(0x1a7))[_0x45603(0x1df)]()},_0x11db66=_0x49844d+'/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/roleassignments/addroleassignment(principalid='+_0x2feb3a+',roleDefId='+_0x403773+')';$[_0x45603(0x21d)]({'url':_0x11db66,'type':_0x45603(0x11e),'headers':_0x1cb327,'dataType':_0x45603(0x1ba),'async':![],'success':function(_0x3ac120){var _0x1a9072=_0x45603;console[_0x1a9072(0x159)]('User\x20has\x20been\x20assigned\x20permission\x20.');},'error':function(_0x5ef4cd){var _0x25789f=_0x45603;console[_0x25789f(0x159)](JSON[_0x25789f(0x1fc)](_0x5ef4cd)),Permissionloder[_0x25789f(0x1c5)]();}});}function GetGroupIDByGroupName(){var _0x3ff30b=a0_0x3026c6,_0x2a3e47=_spPageContextInfo[_0x3ff30b(0x1b4)]+_0x3ff30b(0x17a);$['ajax']({'url':_0x2a3e47,'method':_0x3ff30b(0x149),'async':![],'headers':{'Accept':_0x3ff30b(0x163)},'success':function(_0x5558f7){contributersGroupId=_0x5558f7['d']['Id'];},'error':function(_0xe5f53f){var _0x6e732a=_0x3ff30b;console[_0x6e732a(0x159)](_0xe5f53f);}});}function GetListItems(_0xc0474c,_0x5e996f){var _0x52216b=a0_0x3026c6,_0x58e005,_0x195e1d=_spPageContextInfo[_0x52216b(0x1b4)]+_0x52216b(0x257)+_0xc0474c+_0x52216b(0x20e)+_0x5e996f+'&$top=1';return $['ajax']({'url':_0x195e1d,'method':'GET','async':![],'headers':{'Accept':_0x52216b(0x163)},'success':function(_0x19105e){var _0x4111e6=_0x52216b;_0x19105e['d'][_0x4111e6(0x1e8)][_0x4111e6(0x1ef)]>0x0?_0x58e005=![]:_0x58e005=!![];},'error':function(_0x212102){var _0x55a9fc=_0x52216b;console[_0x55a9fc(0x159)](_0x212102);}}),_0x58e005;}function GetCompanies(){var _0x367f07=a0_0x3026c6,_0x2a5e98=_spPageContextInfo[_0x367f07(0x1b4)]+'/_api/web/lists/getByTitle(\x27Companies\x27)/items?$select=*&$top=4900';$[_0x367f07(0x21d)]({'url':_0x2a5e98,'method':_0x367f07(0x149),'async':![],'headers':{'Accept':_0x367f07(0x163)},'success':function(_0x150cf1){var _0x52ed9b=_0x367f07;AllCompanies=_0x150cf1['d'][_0x52ed9b(0x1e8)];},'error':function(_0x155a0d){var _0x460864=_0x367f07;console[_0x460864(0x159)](_0x155a0d);}});}function GetDepartments(){var _0x13adfc=a0_0x3026c6,_0x1c27cf=_spPageContextInfo[_0x13adfc(0x1b4)]+'/_api/web/lists/getByTitle(\x27Departments\x27)/items?$select=*&$top=4900';$[_0x13adfc(0x21d)]({'url':_0x1c27cf,'method':_0x13adfc(0x149),'async':![],'headers':{'Accept':_0x13adfc(0x163)},'success':function(_0xc520c9){var _0x483752=_0x13adfc;AllDepartments=_0xc520c9['d'][_0x483752(0x1e8)];},'error':function(_0x22aed8){var _0x5ec974=_0x13adfc;console[_0x5ec974(0x159)](_0x22aed8);}});}function GetOfficeLocation(){var _0x1baa62=a0_0x3026c6,_0x240f56=_spPageContextInfo[_0x1baa62(0x1b4)]+_0x1baa62(0x154);$['ajax']({'url':_0x240f56,'method':_0x1baa62(0x149),'async':![],'headers':{'Accept':_0x1baa62(0x163)},'success':function(_0x3a128b){var _0x138c1a=_0x1baa62;AllOfficeLocation=_0x3a128b['d'][_0x138c1a(0x1e8)];},'error':function(_0x56f9c6){console['log'](_0x56f9c6);}});}function GetSubSiteUrl(_0x3d85ce,_0x319534){var _0x1c10c5=a0_0x3026c6,_0x534933,_0xfb26f6=_spPageContextInfo[_0x1c10c5(0x1b4)]+_0x1c10c5(0x257)+_0x3d85ce+_0x1c10c5(0x173)+_0x319534+_0x1c10c5(0x193);return $[_0x1c10c5(0x21d)]({'url':_0xfb26f6,'method':_0x1c10c5(0x149),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x4d4498){var _0x478122=_0x1c10c5;_0x534933=_0x4d4498['d']['results'][0x0][_0x478122(0x190)];},'error':function(_0x1e70c1){var _0x400d20=_0x1c10c5;console[_0x400d20(0x159)](_0x1e70c1);}}),_0x534933;}function AddUserinSharePointGroup(_0x19f04e){var _0x2f3f59=a0_0x3026c6,_0x3adcb2=$[_0x2f3f59(0x186)](),_0x202648=_0x2f3f59(0x18a),_0x1452e1=_0x202648+_0x19f04e,_0x43296=_spPageContextInfo[_0x2f3f59(0x1b4)]+_0x2f3f59(0x206)+contributersGroupId+_0x2f3f59(0x20a);$[_0x2f3f59(0x21d)]({'url':_0x43296,'type':'POST','async':![],'data':JSON[_0x2f3f59(0x1fc)]({'__metadata':{'type':_0x2f3f59(0x1e9)},'LoginName':_0x1452e1}),'headers':{'accept':'application/json;odata=verbose','content-type':_0x2f3f59(0x23a),'X-RequestDigest':$(_0x2f3f59(0x1a7))[_0x2f3f59(0x1df)]()},'success':_0x2fcb03,'error':_0x51873f});function _0x2fcb03(_0xd8301f){var _0x27371d=_0x2f3f59;_0x3adcb2[_0x27371d(0x256)](_0xd8301f['d']['Id']),console[_0x27371d(0x159)](_0x27371d(0x1f6));}function _0x51873f(_0xb027bc){var _0x412486=_0x2f3f59;console[_0x412486(0x159)](JSON['stringify'](_0xb027bc));}return _0x3adcb2[_0x2f3f59(0x160)]();}function GetUserId(_0x5a1152){var _0x7682ef=a0_0x3026c6,_0x43166a='',_0x4f2d8f=_0x7682ef(0x18a),_0x34e904=_spPageContextInfo[_0x7682ef(0x195)],_0x1df492=_0x4f2d8f+_0x5a1152;return $[_0x7682ef(0x21d)]({'url':_0x34e904+_0x7682ef(0x16e)+encodeURIComponent(_0x1df492)+'\x27','method':_0x7682ef(0x149),'headers':{'Accept':_0x7682ef(0x163)},'async':![],'success':function(_0x4e832b){_0x43166a=_0x4e832b['d']['Id'];},'error':function(_0x57e645){var _0x42d228=_0x7682ef;console[_0x42d228(0x159)](JSON[_0x42d228(0x1fc)](_0x57e645));}}),_0x43166a;}var GetAllGroupsUser=[],GroupUrl=_spPageContextInfo[a0_0x3026c6(0x195)]+a0_0x3026c6(0x128);function GetAllUserId(){var _0x507a89=a0_0x3026c6;$[_0x507a89(0x21d)]({'url':GroupUrl,'method':_0x507a89(0x149),'headers':{'Accept':_0x507a89(0x163)},'async':![],'success':function(_0x1baf18){var _0x330560=_0x507a89;GetAllGroupsUser=GetAllGroupsUser[_0x330560(0x1f5)](_0x1baf18['d'][_0x330560(0x1e8)]),_0x1baf18['d']['__next']!=null&&(GroupUrl=_0x1baf18['d'][_0x330560(0x170)],GetAllUserId());},'error':function(_0x3a46ae){var _0x41bab5=_0x507a89;console['log'](JSON[_0x41bab5(0x1fc)](_0x3a46ae));}});}function a0_0x2737(){var _0x257e30=['join','click','#ddlDepartment','application/json;odata=nometadata','readAsArrayBuffer','results','SP.User','byteLength','xlsx','Active','.select-row_isReadeySelected','SheetNames','length','#txtmanager','result','access_token','find','Date\x20Of\x20Birth','concat','User\x20Added','OfficeLocationsId','getElement','application/json','EmployeeSyncreport','Updated','stringify','Companies','readAsBinaryString','innerHTML','getElementById','4622484mEkGkm','prop','#ddlAllCompanies','Expires','\x27)/items','/_api/web/sitegroups(','getRow','Type','hide',')/users','551388fKZaZI','#txtDesignation','.searching','\x27)/items?$select=ID&$filter=ID\x20eq\x20','Please\x20select\x20Department','1227AdmMOt','push','Department\x20Id\x20is\x20not\x20Correct','\x27)/GetItemById(\x27','DepartmentsId','fitColumns','Postal\x20Address','#ddlfilterDepartments','binary','Please\x20upload\x20a\x20valid\x20Excel\x20file.','Width','Department','error1','ajax','Your\x20License\x20limit\x20has\x20been\x20ended','10%','files','46935HIlKPi','sheet_to_row_object_array','Chief\x20Executive','#Rowcount','Select\x20Company','show','</h3>\x20<p\x20class\x20=\x20\x22m-0\x22\x20>\x20Uploaded\x20</p>','checked','chkDesignation','1216dZgVZI','GetAllUserInfo','\x20<span\x20style=\x27color:red;\x20font-weight:bold;\x27>','Date\x20Of\x20Joining','.select-row_IsMiisingSelected','isReadeySelected','selectRow','#Error','#upload','WebPartName','#btnsubmitready','<span\x20class=\x27breakpoint\x27></span>','15%','Name','City','Status','application/json;odata=verbose','#ddlfilterAllCompanies','Corporate','toUpperCase','setData','66476TNAZhD','EmployeeId','Added','test','PIN/ZIP','option:selected','#IsMiisingSelected','https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27','998707IUeSpU','Required\x20Value\x20Missing','#successfully_notifications','#UploadedItems','<input\x20type=\x22checkbox\x22\x20id=\x22isReadeySelected\x22\x20onclick=\x22isReadeySelecteds()\x22\x20/>','ListItem','MaximumEntitySuggestions','please\x20check\x20at\x20list\x20one\x20checkbox\x20','Description','undefined','.form-check-input','#dvExcel','Not\x20SP\x20Permission','deselectRow','Invalid\x20Profile','resolve','/_api/web/lists/getByTitle(\x27','ddlfilterOfficeLocation','#AvilableLicenses','readonly','Please\x20select\x20Location','Announcement_Type','Worng\x20Manager','#ddlOfficeLocation','SP.Data.AnnouncementsListItem','displayName','CompanyName','fileUpload','#btnmissingrequedvalue','POST','#Ready','ddlfilterDepartments','mail','<option\x20value=\x220\x22><strong>All</strong></option>','Mobile','205wfdGGL','formatDate','Email','OfficeNameDetail','/_api/web/siteusers?$top=1000&$select=*,Id','filter','Employees','Department\x20*','Metadata','slice','after','Already\x20Exist','round','Designation','This\x20browser\x20does\x20not\x20support\x20HTML5.','setMonth','ddlDepartment','CompanyId','#chkTopExecutive','#lblUpdate','html','ddlOfficeLocation','onload','<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>','chkTopExecutive','when','getValue','4472EGuRvO','target','map','datepicker','<h3\x20class=\x27m-0\x27>','Data\x20Send\x20to\x20Announcements','center','Please\x20upload\x20xlsx\x20file','Company\x20Id\x20is\x20not\x20Correct','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20','GET','mm/dd/yy','#btnfiltervalue','/_api/SP.OAuth.Token/Acquire','OfficeLocation','\x27)\x20and\x20(Status\x20eq\x20\x27Active\x27)','JoiningDate','_cell','#divAudience','Please\x20select\x20required\x20value\x20missing\x20row','Welcome','/_api/web/lists/getByTitle(\x27OfficeLocation\x27)/items?$select=*&$top=4900','done','#Exits','DepartmentName','row','log','EmployeeSyncReport.xlsx','fadeOut','select#dropDownId\x20option:selected','SPClientPeoplePicker_InitStandaloneControlWrapper','client_credentials','removeProp','promise','modal','getQueryStringParameter','application/json;\x20odata=verbose','ddlfilterAllCompanies','read','Office\x20Location\x20Id\x20is\x20not\x20Correct','All','findIndex','appendChild','ClientName','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','Ready','chkDepartment','/_api/web/siteusers(@v)?@v=\x27','EmployeeOfficeLocation','__next','EntityData','chkManager','\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20','utils','fromCharCode','\x20<span\x20style=\x27color:blue;\x20font-weight:bold;\x27>','Location','text','Company\x20*','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','/_api/web/lists/GetByTitle(\x27','left','Data\x20Send\x20to\x20Announcements\x20Failed','<option\x20value=\x22','onchange','</option>','SP.Data.','Wrong\x20Manager','createElement','Location\x20*','.breakpoint','Deferred','385nUZjRG','toString','126ZmbuBB','i:0#.f|membership|','Home\x20Address','#added','chkGroup','Email\x20*','#UploadExcel','SiteURL','Designation\x20*','1073741826','&$top=1','OfficeLocationId','siteAbsoluteUrl','Manager\x20*','#overlaysearch','#ddlfilterOfficeLocation','<input\x20type=\x22checkbox\x22\x20class=\x22select-row_isReadeySelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>','local','split','Email(Other)','Country','FullName','IsMiisingSelected','keyup','@odata.nextLink','append','setHours','/_api/web/lists/getbytitle(\x27','<input\x20type=\x22checkbox\x22\x20class=\x22select-row_IsMiisingSelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>','static','#__REQUESTDIGEST','DOJ:\x20','SearchPrincipalSource','chkOfficeLocation','Internal\x20Users','#btnUploadExcel','value','download','ready','_row','ApprovalStatus','EnvironmentalSettings','Company','webAbsoluteUrl','EmployeeDepartment','Sheets','EmployeeID','ddlAllCompanies','focus','json','PATCH','deselect','Group\x20Name','AllowMultipleValues','OfficeName','toLowerCase','#txtGroup','indexOf','reject','input[type=radio][name=datasend]','close','DepartmentId','590yqVjyb','width','Manager','exceltble','Home\x20Phone','select','Departments','DepartmentNameDetail','UserType','EmpUserId','dd\x20M\x20yy','setPage','Sate','CompanyIDId','message','.sp-peoplepicker-editorInput','getSelectedRows','New\x20Joinee','option','fadeIn','Publish_Date','remove','Total\x20Row\x20Count:\x20','change','val','User,DL,SecGroup,SPGroup','data','\x20<span\x20style=\x27color:green;\x20font-weight:bold;\x27>'];a0_0x2737=function(){return _0x257e30;};return a0_0x2737();}var LoginName;function UpdateExistingEmployeeAllocated(_0x4990fa,_0x459dad){var _0x3373f2=a0_0x3026c6;try{UserEmailId=_0x4990fa[0x0][_0x3373f2(0x18e)],LoginName='i:0#.f|membership|'+_0x4990fa[0x0][_0x3373f2(0x18e)];var _0x571c77,_0x2cd23c,_0x51918c=GetAllGroupsUser[_0x3373f2(0x129)](function(_0x22e7d0){var _0x313b79=_0x3373f2;return _0x22e7d0[_0x313b79(0x126)][_0x313b79(0x1c0)]()==_0x4990fa[0x0][_0x313b79(0x18e)][_0x313b79(0x1c0)]();});if(_0x51918c[_0x3373f2(0x1ef)]>0x0)var _0x9d3b5e=_0x51918c[0x0]['Id'];else{}if(TopExecutive==_0x3373f2(0x223)||_0x4990fa[0x0][_0x3373f2(0x196)]==undefined)_0x4990fa[0x0]['Manager\x20*']=_0x3373f2(0x223),_0x571c77=-0x1;else{var _0x23b80f=EmployeeListUsers[_0x3373f2(0x129)](function(_0x5424cd){var _0x17a1e9=_0x3373f2,_0x1fc0c3;if(_0x5424cd[_0x17a1e9(0x1c9)]!=null)return _0x1fc0c3=_0x5424cd[_0x17a1e9(0x126)][_0x17a1e9(0x1c0)](),_0x1fc0c3==_0x4990fa[0x0][_0x17a1e9(0x196)][_0x17a1e9(0x1c0)]();});if(_0x23b80f['length']>0x0){_0x2cd23c=_0x23b80f[0x0][_0x3373f2(0x19e)];var _0x51918c=GetAllGroupsUser[_0x3373f2(0x129)](function(_0x1a0fe5){var _0x31e41a=_0x3373f2;return _0x1a0fe5[_0x31e41a(0x126)][_0x31e41a(0x1c0)]()==_0x4990fa[0x0]['Manager\x20*'][_0x31e41a(0x1c0)]();});if(_0x51918c[_0x3373f2(0x1ef)]>0x0)_0x571c77=_0x51918c[0x0]['Id'];else{}}else{IsManager=![],_0x571c77='';var _0x4da8f7=excelRows['findIndex'](_0x15f81f=>_0x15f81f[_0x3373f2(0x18e)][_0x3373f2(0x1c0)]()==_0x4990fa[0x0][_0x3373f2(0x18e)][_0x3373f2(0x1c0)]());excelRows[_0x4da8f7][_0x3373f2(0x239)]='Worng\x20Manager';}}var _0x58e025,_0x486354=GetItemTypeForListName(_0x459dad);_0x58e025={'__metadata':{'type':_0x486354},'Designation':_0x4990fa[0x0][_0x3373f2(0x191)],'GroupName':_0x4990fa[0x0][_0x3373f2(0x1bd)],'Manager':_0x2cd23c,'ManagerLoginNameId':_0x571c77},$[_0x3373f2(0x13d)](updateItemExitUser(_0x459dad,_0x58e025,_0x4990fa[0x0][_0x3373f2(0x1d0)]))[_0x3373f2(0x155)](function(_0x16f2d0){var _0x8d7208=_0x3373f2,_0x2f2305=_0x16f2d0;if(_0x2f2305){lblUpdate=lblUpdate+0x1,Exits=Exits-0x1;var _0x403387=excelRows[_0x8d7208(0x168)](_0x288fb6=>_0x288fb6[_0x8d7208(0x18e)]==UserEmailId);excelRows[_0x403387]['Status']=_0x8d7208(0x1fb),showmessage();}});}catch(_0x25d554){console[_0x3373f2(0x159)](_0x25d554[_0x3373f2(0x1d5)]);}}var IsManager=!![];function AddNewEmployeeAllocated(_0x5ca660,_0x1ebc67){var _0x7fe75c=a0_0x3026c6;try{if(GetListItems('Departments',parseInt(_0x5ca660[0x0][_0x7fe75c(0x12b)])))return alert(_0x7fe75c(0x212)),![];if(GetListItems(_0x7fe75c(0x1fd),parseInt(_0x5ca660[0x0][_0x7fe75c(0x179)])))return alert(_0x7fe75c(0x147)),![];else{if(GetListItems(_0x7fe75c(0x14d),parseInt(_0x5ca660[0x0][_0x7fe75c(0x184)])))return alert(_0x7fe75c(0x166)),![];else{LoginName=_0x5ca660[0x0][_0x7fe75c(0x18e)][_0x7fe75c(0x1c0)]();var _0x24179d,_0x1d3930,_0x20b73c=GetAllGroupsUser[_0x7fe75c(0x129)](function(_0x1755c1){var _0x1cd3fc=_0x7fe75c;return _0x1755c1[_0x1cd3fc(0x126)][_0x1cd3fc(0x1c0)]()==_0x5ca660[0x0]['Email\x20*'][_0x1cd3fc(0x1c0)]();}),_0x2a3930;if(_0x20b73c[_0x7fe75c(0x1ef)]>0x0)var _0x2a3930=_0x20b73c[0x0]['Id'];else $['when'](AddUserinSharePointGroup(LoginName))[_0x7fe75c(0x155)](function(_0x4b4e20){_0x2a3930=_0x4b4e20;});if(TopExecutive==_0x7fe75c(0x223)||_0x5ca660[0x0][_0x7fe75c(0x196)]==undefined)_0x5ca660[0x0][_0x7fe75c(0x196)]=_0x7fe75c(0x223),_0x24179d=-0x1;else{var _0x78564a=EmployeeListUsers[_0x7fe75c(0x129)](function(_0xa4d0da){var _0x223b68=_0x7fe75c,_0x256627;if(_0xa4d0da[_0x223b68(0x126)]!=null)return _0x256627=_0xa4d0da[_0x223b68(0x126)][_0x223b68(0x1c0)](),_0x256627==_0x5ca660[0x0][_0x223b68(0x196)][_0x223b68(0x1c0)]();});if(_0x78564a[_0x7fe75c(0x1ef)]>0x0){_0x1d3930=_0x78564a[0x0][_0x7fe75c(0x19e)];var _0x20b73c=GetAllGroupsUser[_0x7fe75c(0x129)](function(_0x564bc8){var _0x1353c6=_0x7fe75c;return _0x564bc8[_0x1353c6(0x126)][_0x1353c6(0x1c0)]()==_0x5ca660[0x0][_0x1353c6(0x196)][_0x1353c6(0x1c0)]();});_0x20b73c[_0x7fe75c(0x1ef)]>0x0?_0x24179d=_0x20b73c[0x0]['Id']:_0x24179d=AddUserinSharePointGroup(_0x5ca660[0x0][_0x7fe75c(0x196)][_0x7fe75c(0x1c0)]());}else{IsManager=![],_0x24179d='';var _0x45a27c=excelRows[_0x7fe75c(0x168)](_0x3d44e3=>_0x3d44e3[_0x7fe75c(0x18e)][_0x7fe75c(0x1c0)]()==LoginName);excelRows[_0x45a27c][_0x7fe75c(0x239)]=_0x7fe75c(0x182);}}var _0xecfe62,_0x45b93a=GetItemTypeForListName(_0x1ebc67);_0xecfe62={'__metadata':{'type':_0x45b93a},'CompanyId':parseInt(_0x5ca660[0x0][_0x7fe75c(0x179)]),'DepartmentId':parseInt(_0x5ca660[0x0][_0x7fe75c(0x12b)]),'FullName':_0x5ca660[0x0]['Name'],'Title':_0x5ca660[0x0][_0x7fe75c(0x237)],'ParentId':'-1','Email':_0x5ca660[0x0][_0x7fe75c(0x18e)],'LogonNameId':_0x2a3930,'Manager':_0x5ca660[0x0][_0x7fe75c(0x196)],'ManagerLoginNameId':_0x24179d,'OfficeLocationId':parseInt(_0x5ca660[0x0][_0x7fe75c(0x184)]),'MobileNumber':_0x5ca660[0x0][_0x7fe75c(0x123)],'DateOfBirth':_0x5ca660[0x0][_0x7fe75c(0x1f4)],'Gender':_0x5ca660[0x0]['Gender'],'DateOfAnniversary':_0x5ca660[0x0]['Date\x20Of\x20Marriage'],'JoiningDate':_0x5ca660[0x0][_0x7fe75c(0x22d)],'Designation':_0x5ca660[0x0][_0x7fe75c(0x191)],'PrimaryCompany':'Primary','EmployeeID':_0x5ca660[0x0]['Employee\x20Code'],'GroupName':_0x5ca660[0x0][_0x7fe75c(0x1bd)],'Status':_0x7fe75c(0x1ec),'PostalAddresses':_0x5ca660[0x0][_0x7fe75c(0x216)],'City':_0x5ca660[0x0][_0x7fe75c(0x238)],'StateProvince':_0x5ca660[0x0][_0x7fe75c(0x1d3)],'ZIPPostalCode':_0x5ca660[0x0][_0x7fe75c(0x243)],'Country':_0x5ca660[0x0][_0x7fe75c(0x19d)],'HomePhone':_0x5ca660[0x0][_0x7fe75c(0x1cb)],'OtherEMailAddress':_0x5ca660[0x0][_0x7fe75c(0x19c)],'HomeAddress':_0x5ca660[0x0][_0x7fe75c(0x18b)]},AddItemToList(_0x1ebc67,_0xecfe62);var _0x1f17e3=new Date(),_0x25f32d=new Date(_0x5ca660[0x0][_0x7fe75c(0x22d)]),_0x2fec1c=daysDifference(_0x25f32d,_0x1f17e3);if(_0x2fec1c<=0xf)AddedEmployeeList[_0x7fe75c(0x211)]({'Metadata':_0xecfe62,'EmployeeId':EmployeeId,'EmployeeOfficeLocation':_0x5ca660[0x0][_0x7fe75c(0x127)],'EmployeeDepartment':_0x5ca660[0x0][_0x7fe75c(0x1ce)]});else{}}}}catch(_0xa38dd7){console[_0x7fe75c(0x159)](_0xa38dd7[_0x7fe75c(0x1d5)]);}}function daysDifference(_0x153d84,_0x26f7f9){var _0x37cc2b=a0_0x3026c6,_0xef39ef=new Date(+_0x26f7f9)['setHours'](0xc)-new Date(+_0x153d84)[_0x37cc2b(0x1a3)](0xc);return Math[_0x37cc2b(0x130)](_0xef39ef/0x5265c00);}function updateItemExitUser(_0x30e126,_0x32d9f8,_0x32bbb1){var _0x39613d=a0_0x3026c6,_0x28bd59=$[_0x39613d(0x186)]();return $[_0x39613d(0x21d)]({'url':_spPageContextInfo[_0x39613d(0x1b4)]+_0x39613d(0x1a4)+_0x30e126+_0x39613d(0x213)+_0x32bbb1+'\x27)','type':_0x39613d(0x11e),'headers':{'accept':_0x39613d(0x23a),'X-RequestDigest':$(_0x39613d(0x1a7))[_0x39613d(0x1df)](),'content-Type':'application/json;odata=verbose','X-Http-Method':_0x39613d(0x1bb),'If-Match':'*'},'data':JSON[_0x39613d(0x1fc)](_0x32d9f8),'async':![],'success':function(_0x2a59de){var _0x57b56e=_0x39613d;_0x28bd59[_0x57b56e(0x256)](!![]);},'error':function(_0x4c6d4a){_0x28bd59['reject'](_0x4c6d4a);}}),_0x28bd59[_0x39613d(0x160)]();}function AddItemToList(_0x4b874a,_0x57e7c6){var _0x5ce1c7=a0_0x3026c6;UserEmailId=_0x57e7c6[_0x5ce1c7(0x126)];var _0x2793e0=_0x57e7c6[_0x5ce1c7(0x19e)];EmployeeId='';var _0x1b8e3e=$['Deferred']();return $[_0x5ce1c7(0x21d)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x5ce1c7(0x1a4)+_0x4b874a+_0x5ce1c7(0x205),'type':_0x5ce1c7(0x11e),'async':![],'headers':{'accept':_0x5ce1c7(0x23a),'X-RequestDigest':$(_0x5ce1c7(0x1a7))[_0x5ce1c7(0x1df)](),'content-Type':_0x5ce1c7(0x23a)},'data':JSON['stringify'](_0x57e7c6),'success':function(_0x31aadc){var _0x56dd92=_0x5ce1c7;EmployeeId=_0x31aadc['d']['Id'],counusers=counusers+0x1,AvilableLicenses=AvilableLicenses-0x1,Ready=Ready-0x1;var _0x4e68a2=excelRows['findIndex'](_0x578995=>_0x578995['Email\x20*']==UserEmailId);excelRows[_0x4e68a2][_0x56dd92(0x239)]=_0x56dd92(0x241),showmessage();var _0x3ae541=GetSubSiteUrl(_0x56dd92(0x1cd),_0x31aadc['d'][_0x56dd92(0x1c6)]);AssignPermissiononDMSLibary(_0x31aadc['d']['LogonNameId'],_0x56dd92(0x192),_0x3ae541),_0x1b8e3e[_0x56dd92(0x256)](_0x31aadc);},'error':function(_0x542f8c){var _0xab6a4e=_0x5ce1c7;if(IsManager){var _0x4c3dbf=excelRows['findIndex'](_0x3e5025=>_0x3e5025['Email\x20*']==UserEmailId);excelRows[_0x4c3dbf][_0xab6a4e(0x239)]=_0xab6a4e(0x253);}userfullname==''?(userfullname+=_0x2793e0,warningmessage='The\x20following\x20users\x20failed\x20to\x20sync\x20due\x20to\x20wrong\x20manager\x20defined!.\x0a'):userfullname+='\x20,\x20'+_0x2793e0,Ready=Ready-0x1,Error=Error+0x1,console[_0xab6a4e(0x159)](JSON['stringify'](_0x542f8c)),_0x1b8e3e['reject'](JSON[_0xab6a4e(0x1fc)](_0x542f8c));}}),_0x1b8e3e[_0x5ce1c7(0x160)]();}function LoadShowUser(_0x347709){var _0x40d5cc=a0_0x3026c6;tabledata=new Tabulator('#example-table',{'height':'','pagination':_0x40d5cc(0x19a),'paginationSize':0xa,'layout':_0x40d5cc(0x215),'paginationSizeSelector':[0xa,0x19,0x32,0x64],'placeholder':_0x40d5cc(0x146),'data':_0x347709,'pageLoaded':function(_0x59b4e4){var _0x22deff=_0x40d5cc;_0x59b4e4>=0x1?pageIndex=_0x59b4e4:pageIndex=_0x59b4e4,IsMiisingSelect=document[_0x22deff(0x200)]('IsMiisingSelected'),IsMiisingSelect['checked']&&$(_0x22deff(0x22e))[_0x22deff(0x202)](_0x22deff(0x228),!![]),isReadeySelect=document[_0x22deff(0x200)](_0x22deff(0x22f)),isReadeySelect[_0x22deff(0x228)]&&$(_0x22deff(0x1ed))['prop']('checked',!![]);},'columns':[{'formatter':function(_0x5866da,_0x4b4b42){var _0x48c0f7=_0x40d5cc,_0x19a35d=_0x5866da['_cell'][_0x48c0f7(0x158)][_0x48c0f7(0x1e1)][_0x48c0f7(0x239)];return _0x19a35d=='Invalid\x20Profile'||_0x19a35d==_0x48c0f7(0x248)||_0x19a35d==_0x48c0f7(0x241)||_0x19a35d==_0x48c0f7(0x1fb)?_0x48c0f7(0x13b):_0x48c0f7(0x199);},'title':_0x40d5cc(0x24b),'field':'ID','width':'1%','headerSort':![],'cellClick':function(_0x32d48f,_0x2095b8){var _0x4b9973=_0x40d5cc,_0x292d7b=$(_0x2095b8['getElement']()),_0x3c506b=_0x292d7b['find']('.select-row_isReadeySelected');_0x3c506b[0x0][_0x4b9973(0x228)]==![]&&$(_0x2095b8[_0x4b9973(0x207)]()['getElement']())['find']('.select-row_IsMiisingSelected')[0x0][_0x4b9973(0x228)]==![]?_0x2095b8[_0x4b9973(0x207)]()[_0x4b9973(0x1bc)]():_0x2095b8[_0x4b9973(0x207)]()[_0x4b9973(0x1cc)]();}},{'formatter':function(_0xe3519d,_0x49b486){var _0x278029=_0x40d5cc,_0x11ce58=_0xe3519d[_0x278029(0x150)]['row']['data'][_0x278029(0x239)];return _0x11ce58==_0x278029(0x248)||_0x11ce58=='Already\x20Exist'||_0x11ce58=='Ready'?_0x278029(0x1a5):'<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>';},'title':'<input\x20type=\x22checkbox\x22\x20id=\x22IsMiisingSelected\x22\x20onclick=\x22IsMiisingSelecteds()\x22\x20/>','hozAlign':_0x40d5cc(0x145),'field':'ID','headerSort':![],'width':'1%','cellClick':function(_0x41bfa3,_0x4610c7){var _0x3c88dc=_0x40d5cc,_0x240919=$(_0x4610c7[_0x3c88dc(0x1f8)]()),_0x3e23d8=_0x240919[_0x3c88dc(0x1f3)](_0x3c88dc(0x22e));_0x3e23d8[0x0][_0x3c88dc(0x228)]==![]&&$(_0x4610c7[_0x3c88dc(0x207)]()[_0x3c88dc(0x1f8)]())[_0x3c88dc(0x1f3)](_0x3c88dc(0x1ed))[0x0]['checked']==![]?_0x4610c7['getRow']()[_0x3c88dc(0x1bc)]():_0x4610c7[_0x3c88dc(0x207)]()['select']();}},{'title':_0x40d5cc(0x239),'field':_0x40d5cc(0x239),'width':'8%','formatter':function(_0x4d797d,_0x2b1d7b){var _0x2a5bb3=_0x40d5cc,_0xa6e961=_0x4d797d[_0x2a5bb3(0x13e)]();if(_0xa6e961==_0x2a5bb3(0x255)||_0xa6e961=='Required\x20Value\x20Missing'||_0xa6e961=='Not\x20SP\x20Permission'||_0xa6e961==_0x2a5bb3(0x25d))return _0x2a5bb3(0x22c)+_0xa6e961+'</span>';else return _0xa6e961==_0x2a5bb3(0x12f)?_0x2a5bb3(0x176)+_0xa6e961+'</span>':_0x2a5bb3(0x1e2)+_0xa6e961+'</span>';}},{'title':_0x40d5cc(0x208),'field':_0x40d5cc(0x208),'width':_0x40d5cc(0x21f)},{'title':'Name','field':_0x40d5cc(0x237),'width':'10%'},{'title':_0x40d5cc(0x126),'field':_0x40d5cc(0x18e),'align':_0x40d5cc(0x17c),'width':_0x40d5cc(0x236)},{'title':_0x40d5cc(0x1b3),'field':_0x40d5cc(0x179),'width':_0x40d5cc(0x21f),'align':'center'},{'title':'Department','field':_0x40d5cc(0x12b),'width':_0x40d5cc(0x21f),'align':_0x40d5cc(0x145)},{'title':_0x40d5cc(0x177),'field':'Location\x20*','width':'8%','align':_0x40d5cc(0x145)},{'title':_0x40d5cc(0x131),'field':_0x40d5cc(0x191),'width':'10%'},{'title':_0x40d5cc(0x1c9),'field':'Manager\x20*','width':'10%'},{'title':_0x40d5cc(0x22d),'field':_0x40d5cc(0x22d),'width':'10%'},{'title':_0x40d5cc(0x1bd),'field':_0x40d5cc(0x1bd),'width':'10%'}]}),showmessage(),$(_0x40d5cc(0x224))[_0x40d5cc(0x138)](_0x40d5cc(0x1dd)),$(_0x40d5cc(0x185))[_0x40d5cc(0x1dc)](),$('.tabulator-page-size')[_0x40d5cc(0x12e)](_0x40d5cc(0x235));}function showmessage(){var _0x282e14=a0_0x3026c6;$('#Ready')[_0x282e14(0x178)](Ready),$('#Error')[_0x282e14(0x178)](Error),$('#Exits')[_0x282e14(0x178)](Exits),$(_0x282e14(0x137))[_0x282e14(0x178)](lblUpdate),$(_0x282e14(0x259))[_0x282e14(0x178)](AvilableLicenses);}function requestToken(){var _0x381dcd=a0_0x3026c6;$[_0x381dcd(0x21d)]({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':'POST','headers':{'content-type':'application/x-www-form-urlencoded'},'data':{'grant_type':_0x381dcd(0x15e),'client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':'https://graph.microsoft.com/.default'},'success':function(_0x6719a8){var _0x257c80=_0x381dcd;console[_0x257c80(0x159)](_0x6719a8),token=_0x6719a8[_0x257c80(0x1f2)];},'error':function(_0x44e73c){var _0x241a7a=_0x381dcd;console[_0x241a7a(0x159)](JSON[_0x241a7a(0x1fc)](_0x44e73c));}});}function GraphAccessTokenTogetUserDetails(){var _0x637855=a0_0x3026c6,_0xe0520=new jQuery[(_0x637855(0x186))](),_0x239ce0={'X-RequestDigest':$(_0x637855(0x1a7))['val'](),'accept':_0x637855(0x1e6),'content-type':_0x637855(0x1e6)},_0x46cf8e={'resource':'https://graph.microsoft.com'};return $['ajax']({'url':_spPageContextInfo[_0x637855(0x1b4)]+_0x637855(0x14c),'headers':_0x239ce0,'type':'POST','async':![],'data':JSON[_0x637855(0x1fc)](_0x46cf8e),'success':function(_0x443aef){var _0x488b44=_0x637855;token=_0x443aef[_0x488b44(0x1f2)],_0xe0520['resolve'](token);},'error':function(_0x36c820,_0x1117fb,_0x9a02c2){var _0x1740ae=_0x637855;console[_0x1740ae(0x159)](_0x36c820['responseText']),_0xe0520[_0x1740ae(0x1c3)](_0x36c820['responseText']);}}),_0xe0520['promise']();}var employeehtml='',userName='',AzureUsrlist=[],AdusersUrl='https://graph.microsoft.com/beta/users?$top=100&$select=mail,displayName,userPrincipalName';function GetAzureUsrlist(_0x220822,_0x4dc15d){var _0x16893c=a0_0x3026c6;return DeferredObj=$[_0x16893c(0x186)](),$[_0x16893c(0x21d)]({'method':_0x16893c(0x149),'url':_0x220822,'headers':{'Authorization':'Bearer\x20'+_0x4dc15d,'Content-Type':_0x16893c(0x1f9)},'async':![],'success':function(_0x4a82e3){var _0x536ad3=_0x16893c;AzureUsrlist=AzureUsrlist[_0x536ad3(0x1f5)](_0x4a82e3[_0x536ad3(0x1ad)]),_0x4a82e3[_0x536ad3(0x1a1)]!=null&&(AdusersUrl=_0x4a82e3[_0x536ad3(0x1a1)],GetAzureUsrlist(AdusersUrl,_0x4dc15d));},'error':function(_0x174ed0){var _0x4b460d=_0x16893c;DeferredObj[_0x4b460d(0x1c3)](_0x174ed0),alert(_0x4b460d(0x21c)+JSON[_0x4b460d(0x1fc)](_0x174ed0));}}),DeferredObj['promise']();}function getEmployee(_0x35b171){var _0x29fe4e=a0_0x3026c6,_0x140f66=_0x29fe4e(0x246)+_0x35b171+'\x27';return DeferredObj=$[_0x29fe4e(0x186)](),$[_0x29fe4e(0x21d)]({'method':_0x29fe4e(0x149),'url':_0x140f66,'headers':{'Authorization':'Bearer\x20'+token,'Content-Type':_0x29fe4e(0x1f9)},'async':![],'success':function(_0x5cbaab){var _0x2a08b2=_0x29fe4e;_0x5cbaab[_0x2a08b2(0x1ad)]['length']>0x0?DeferredObj[_0x2a08b2(0x256)](_0x5cbaab[_0x2a08b2(0x1ad)][0x0][_0x2a08b2(0x260)]):DeferredObj[_0x2a08b2(0x256)](_0x2a08b2(0x255));},'error':function(_0x22c349){var _0x32a592=_0x29fe4e;DeferredObj[_0x32a592(0x1c3)](_0x22c349),alert(_0x32a592(0x21c)+JSON['stringify'](_0x22c349));}}),DeferredObj[_0x29fe4e(0x160)]();}function ClientCredentials(){var _0x1aa6fe=a0_0x3026c6,_0x4dee37=_0x1aa6fe(0x1b2),_0xa4a7f1=titanForWork[_0x1aa6fe(0x162)](_0x1aa6fe(0x135)),_0x167927=_spPageContextInfo['webAbsoluteUrl']+_0x1aa6fe(0x17b)+_0x4dee37+_0x1aa6fe(0x16b);$[_0x1aa6fe(0x21d)]({'url':_0x167927,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x147004){var _0x43b1af=_0x1aa6fe,_0x4cd32a=_0x147004['d'][_0x43b1af(0x1e8)];ClientId=_0x4cd32a[0x0][_0x43b1af(0x16a)],ClentSecret=_0x4cd32a[0x0]['ChangeFileName'],ClientUrl=_0x4cd32a[0x0][_0x43b1af(0x24f)];},'error':function(_0x44cb6f){var _0x3463ae=_0x1aa6fe;console[_0x3463ae(0x159)](_0x44cb6f);}});}var EmployeeListUsers=[],GetQueryURL=_spPageContextInfo[a0_0x3026c6(0x1b4)]+a0_0x3026c6(0x148);function GetEmployees(){var _0x18515a=a0_0x3026c6;$['ajax']({'url':GetQueryURL,'headers':{'Accept':_0x18515a(0x23a)},'async':![],'beforeSend':function(){},'success':function(_0x524e77){var _0xcf1464=_0x18515a;EmployeeListUsers=EmployeeListUsers[_0xcf1464(0x1f5)](_0x524e77['d'][_0xcf1464(0x1e8)]);if(_0x524e77['d'][_0xcf1464(0x170)]!=null)GetQueryURL=_0x524e77['d']['__next'],GetEmployees();else{GetQueryURL=_spPageContextInfo[_0xcf1464(0x1b4)]+_0xcf1464(0x148);var _0x319ddd=0x0,_0x1ab020=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=(ValidUpto\x20ge\x20\x27'+new Date()['toISOString']()+_0xcf1464(0x14e);extdfds=$[_0xcf1464(0x186)](),$[_0xcf1464(0x13d)](getItems(_0x1ab020,extdfds))['done'](function(_0x1893f5){var _0x1e319a=_0xcf1464;response=[],_0x319ddd=_0x1893f5[_0x1e319a(0x1ef)];});}_0x319ddd!=undefined?AvilableLicenses=parseInt(UsersLicenceRequired)-(parseInt(EmployeeListUsers['length'])+parseInt(_0x319ddd)):AvilableLicenses=parseInt(UsersLicenceRequired)-parseInt(EmployeeListUsers[_0xcf1464(0x1ef)]);},'error':function(_0x283286){var _0x57009a=_0x18515a;console[_0x57009a(0x159)](_0x283286);}});}var fileUploadevent=document[a0_0x3026c6(0x200)](a0_0x3026c6(0x11c));fileUploadevent['onclick']=function(){EmployeeListUsers=[],AvilableLicenses=0x0,this['value']=null;},fileUploadevent[a0_0x3026c6(0x17f)]=function(){var _0x289efc=a0_0x3026c6;$[_0x289efc(0x21d)]({'cache':![],'beforeSend':function(){var _0x3acf47=_0x289efc;$(_0x3acf47(0x197))[_0x3acf47(0x1da)]();},'success':function(_0x46c509){var _0x191509=_0x289efc,_0x33fe40=document[_0x191509(0x200)]('fileUpload');AzureUsrlist[_0x191509(0x1ef)]==0x0&&GetAzureUsrlist(AdusersUrl,token);AvilableLicenses=0x0,GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,lblUpdate=0x0,counusers=0x0,Exits=0x0,$(_0x191509(0x11f))['text'](0x0),$(_0x191509(0x231))[_0x191509(0x178)](0x0),$(_0x191509(0x18c))[_0x191509(0x178)](0x0),$(_0x191509(0x137))[_0x191509(0x178)](0x0),$(_0x191509(0x156))[_0x191509(0x178)](0x0);var _0x114995=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x114995['test'](_0x33fe40[_0x191509(0x1ad)][_0x191509(0x1c0)]())){if(typeof FileReader!=_0x191509(0x250)){var _0x45deda=new FileReader();_0x45deda[_0x191509(0x1fe)]?(_0x45deda['onload']=function(_0x144f9d){var _0x31fdb9=_0x191509;ProcessExcel(_0x144f9d[_0x31fdb9(0x140)]['result']);},_0x45deda['readAsBinaryString'](_0x33fe40[_0x191509(0x220)][0x0])):(_0x45deda[_0x191509(0x13a)]=function(_0x4af7d1){var _0x15d1a9=_0x191509,_0x596d20='',_0x5441d6=new Uint8Array(_0x4af7d1[_0x15d1a9(0x140)][_0x15d1a9(0x1f1)]);for(var _0x2e115c=0x0;_0x2e115c<_0x5441d6['byteLength'];_0x2e115c++){_0x596d20+=String[_0x15d1a9(0x175)](_0x5441d6[_0x2e115c]);}ProcessExcel(_0x596d20);},_0x45deda[_0x191509(0x1e7)](_0x33fe40[_0x191509(0x220)][0x0]));}else alert('This\x20browser\x20does\x20not\x20support\x20HTML5.');}else alert(_0x191509(0x219));$(_0x191509(0x197))['fadeOut']();}});},$(function(){var _0x16420b=a0_0x3026c6;$(_0x16420b(0x232))[_0x16420b(0x1e4)](function(){var _0x52f9cb=_0x16420b,_0x1ed6a2=document[_0x52f9cb(0x200)]('fileUpload');GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,counusers=0x0;var _0x281549=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x281549[_0x52f9cb(0x242)](_0x1ed6a2[_0x52f9cb(0x1ad)][_0x52f9cb(0x1c0)]())){if(typeof FileReader!=_0x52f9cb(0x250)){var _0x91ed69=new FileReader();_0x91ed69[_0x52f9cb(0x1fe)]?(_0x91ed69[_0x52f9cb(0x13a)]=function(_0x2a4674){var _0x41b9f8=_0x52f9cb;ProcessExcel(_0x2a4674['target'][_0x41b9f8(0x1f1)]);},_0x91ed69[_0x52f9cb(0x1fe)](_0x1ed6a2[_0x52f9cb(0x220)][0x0])):(_0x91ed69[_0x52f9cb(0x13a)]=function(_0x1ac339){var _0x2cd0ef=_0x52f9cb,_0x3f419f='',_0x52b913=new Uint8Array(_0x1ac339[_0x2cd0ef(0x140)][_0x2cd0ef(0x1f1)]);for(var _0x5e8622=0x0;_0x5e8622<_0x52b913[_0x2cd0ef(0x1ea)];_0x5e8622++){_0x3f419f+=String[_0x2cd0ef(0x175)](_0x52b913[_0x5e8622]);}ProcessExcel(_0x3f419f);},_0x91ed69[_0x52f9cb(0x1e7)](_0x1ed6a2[_0x52f9cb(0x220)][0x0]));}else alert(_0x52f9cb(0x132));}else alert(_0x52f9cb(0x219));});});function ProcessExcel(_0x46d61d){var _0x195428=a0_0x3026c6,_0x524a20=XLSX[_0x195428(0x165)](_0x46d61d,{'type':_0x195428(0x218)}),_0x48690a=_0x524a20[_0x195428(0x1ee)][0x0];excelRows=XLSX[_0x195428(0x174)][_0x195428(0x222)](_0x524a20[_0x195428(0x1b6)][_0x48690a]),$(_0x195428(0x24a))['empty'](),$(_0x195428(0x24a))[_0x195428(0x1a2)](_0x195428(0x143)+excelRows[_0x195428(0x1ef)]+_0x195428(0x227)),$(_0x195428(0x252))[_0x195428(0x138)]('');for(var _0x110e4a=0x0;_0x110e4a<excelRows[_0x195428(0x1ef)];_0x110e4a++){var _0x88eed2='';ErrorUser='';var _0x1081de=EmployeeListUsers['filter'](function(_0x554436){var _0x2f5947=_0x195428,_0x17e1a2=_0x554436[_0x2f5947(0x126)][_0x2f5947(0x1c0)]();return _0x17e1a2==excelRows[_0x110e4a]['Email\x20*'][_0x2f5947(0x1c0)]();});if(_0x1081de['length']>0x0){_0x88eed2=_0x1081de[0x0]['FullName'],color_red='color-red',ErrorUser=_0x195428(0x12f),Exits=Exits+0x1;var _0x4f1923=_0x1081de[0x0]['ID'];excelRows[_0x110e4a][_0x195428(0x179)]='-',excelRows[_0x110e4a][_0x195428(0x12b)]='-',excelRows[_0x110e4a][_0x195428(0x184)]='-';}else{var _0x22fc08=AzureUsrlist['filter'](function(_0x355761){var _0x3eeea8=_0x195428;if(_0x355761[_0x3eeea8(0x121)]!=null){var _0x2e1226=_0x355761[_0x3eeea8(0x121)][_0x3eeea8(0x1c0)]();return _0x2e1226==excelRows[_0x110e4a][_0x3eeea8(0x18e)][_0x3eeea8(0x1c0)]();}});if(_0x22fc08['length']>0x0){_0x88eed2=_0x22fc08[0x0][_0x195428(0x260)];var _0x132878=AllCompanies[_0x195428(0x129)](function(_0x45e016){return _0x45e016['ID']==excelRows[_0x110e4a]['Company\x20*'];}),_0x4c370c=AllDepartments[_0x195428(0x129)](function(_0x30c9e0){var _0x207cab=_0x195428;return _0x30c9e0['ID']==excelRows[_0x110e4a][_0x207cab(0x12b)];}),_0x5d7856=AllOfficeLocation[_0x195428(0x129)](function(_0xcba07b){var _0x23b76e=_0x195428;return _0xcba07b['ID']==excelRows[_0x110e4a][_0x23b76e(0x184)];});_0x132878['length']>0x0&&_0x4c370c['length']>0x0&&_0x5d7856[_0x195428(0x1ef)]>0x0?(Ready=Ready+0x1,ErrorUser=_0x195428(0x16c),excelRows[_0x110e4a][_0x195428(0x1ce)]=_0x4c370c[0x0][_0x195428(0x157)],excelRows[_0x110e4a][_0x195428(0x127)]=_0x5d7856[0x0][_0x195428(0x1bf)]):(ErrorUser=_0x195428(0x248),Error=Error+0x1);}else ErrorUser='Invalid\x20Profile',color_red='color-red',Error=Error+0x1;}excelRows[_0x110e4a]['Name']=_0x88eed2,excelRows[_0x110e4a]['id']=_0x110e4a,excelRows[_0x110e4a][_0x195428(0x239)]=ErrorUser,excelRows[_0x110e4a]['EmpUserId']=_0x4f1923;}alluserdata=excelRows,LoadShowUser(excelRows);}function CompaniesDetails(){var _0x3425f6=a0_0x3026c6,_0x278928=document[_0x3425f6(0x200)](_0x3425f6(0x1b8));_0x278928[_0x3425f6(0x1ff)]='',opt[_0x3425f6(0x1ad)]='0',opt[_0x3425f6(0x178)]='Select\x20Company',_0x278928['appendChild'](opt);for(var _0x386b05=0x0;_0x386b05<AllCompanies[_0x3425f6(0x1ef)];_0x386b05++){var _0x261e33=AllCompanies[_0x386b05][_0x3425f6(0x11b)],_0x1c61c6=AllCompanies[_0x386b05]['ID'];opt=document[_0x3425f6(0x183)](_0x3425f6(0x1d9)),opt[_0x3425f6(0x1ad)]=_0x1c61c6,opt[_0x3425f6(0x178)]=_0x261e33,_0x278928[_0x3425f6(0x169)](opt);}$(_0x3425f6(0x251))[_0x3425f6(0x202)](_0x3425f6(0x228),![]),$(_0x3425f6(0x1f0))[_0x3425f6(0x1df)](''),$(_0x3425f6(0x1c1))[_0x3425f6(0x1df)](''),$(_0x3425f6(0x20c))['val']('');}$(a0_0x3026c6(0x1ac))[a0_0x3026c6(0x1e4)](function(){var _0x5317b8=a0_0x3026c6,_0x2db2e2=tabledata[_0x5317b8(0x1d7)]();debugger;_0x2db2e2[_0x5317b8(0x1ef)]>0x0?(CompaniesDetails(),$('#UploadExcel')[_0x5317b8(0x161)]('show'),initializePeoplePicker('AssaginTomanager'),peoplePickerDiv=$('[id$=\x27AssaginTomanager_TopSpan\x27]')):alert(_0x5317b8(0x152));});var GetDepartments,Getofficelocation,GetDesignation,GetGroup,CompaniesId;$(a0_0x3026c6(0x11d))[a0_0x3026c6(0x1e4)](function(){var _0x1c18d3=a0_0x3026c6;if(document['getElementById']('chkDepartment')['checked']==!![]||document['getElementById'](_0x1c18d3(0x1aa))[_0x1c18d3(0x228)]==!![]||document[_0x1c18d3(0x200)]('chkDesignation')[_0x1c18d3(0x228)]==!![]||document['getElementById']('chkManager')[_0x1c18d3(0x228)]==!![]||document[_0x1c18d3(0x200)](_0x1c18d3(0x13c))[_0x1c18d3(0x228)]==!![]||document[_0x1c18d3(0x200)](_0x1c18d3(0x18d))[_0x1c18d3(0x228)]==!![]){var _0x2ebc33=tabledata[_0x1c18d3(0x1d7)](),_0x18e337=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDiv[0x0]['id']],_0x11120c=_0x18e337[_0x1c18d3(0x22b)]();for(var _0x4ba5cf=0x0;_0x4ba5cf<_0x2ebc33['length'];_0x4ba5cf++){var _0x52bc27=excelRows['findIndex'](_0x15eee2=>_0x15eee2[_0x1c18d3(0x18e)]==_0x2ebc33[_0x4ba5cf][_0x1c18d3(0x1b0)][_0x1c18d3(0x1e1)]['Email\x20*']);if(excelRows[_0x52bc27][_0x1c18d3(0x239)]==_0x1c18d3(0x12f))excelRows[_0x52bc27]['Company\x20*']='-',excelRows[_0x52bc27][_0x1c18d3(0x12b)]='-',excelRows[_0x52bc27][_0x1c18d3(0x184)]='-',document[_0x1c18d3(0x200)](_0x1c18d3(0x229))[_0x1c18d3(0x228)]&&(excelRows[_0x52bc27]['Designation\x20*']=$(_0x1c18d3(0x20c))[_0x1c18d3(0x1df)]()),document[_0x1c18d3(0x200)](_0x1c18d3(0x172))[_0x1c18d3(0x228)]&&(excelRows[_0x52bc27][_0x1c18d3(0x196)]=_0x11120c[0x0][_0x1c18d3(0x171)][_0x1c18d3(0x126)]),document['getElementById'](_0x1c18d3(0x13c))[_0x1c18d3(0x228)]&&(excelRows[_0x52bc27][_0x1c18d3(0x196)]='Chief\x20Executive'),document[_0x1c18d3(0x200)](_0x1c18d3(0x18d))['checked']&&(excelRows[_0x52bc27]['Group\x20Name']=$(_0x1c18d3(0x1c1))['val']());else{if(excelRows[_0x52bc27]['Status']=='Required\x20Value\x20Missing'||excelRows[_0x52bc27]['Status']=='Ready'){document[_0x1c18d3(0x200)](_0x1c18d3(0x16d))[_0x1c18d3(0x228)]&&(excelRows[_0x52bc27][_0x1c18d3(0x179)]=CompaniesId,excelRows[_0x52bc27][_0x1c18d3(0x12b)]=GetDepartments);document['getElementById'](_0x1c18d3(0x1aa))[_0x1c18d3(0x228)]&&(excelRows[_0x52bc27][_0x1c18d3(0x179)]=CompaniesId,excelRows[_0x52bc27][_0x1c18d3(0x184)]=Getofficelocation);document[_0x1c18d3(0x200)]('chkDesignation')[_0x1c18d3(0x228)]&&(excelRows[_0x52bc27]['Designation\x20*']=$(_0x1c18d3(0x20c))['val']());document[_0x1c18d3(0x200)](_0x1c18d3(0x172))[_0x1c18d3(0x228)]&&(excelRows[_0x52bc27][_0x1c18d3(0x196)]=_0x11120c[0x0][_0x1c18d3(0x171)][_0x1c18d3(0x126)]);document[_0x1c18d3(0x200)](_0x1c18d3(0x13c))[_0x1c18d3(0x228)]&&(excelRows[_0x52bc27][_0x1c18d3(0x196)]=_0x1c18d3(0x223));document[_0x1c18d3(0x200)](_0x1c18d3(0x18d))[_0x1c18d3(0x228)]&&(excelRows[_0x52bc27][_0x1c18d3(0x1bd)]=$(_0x1c18d3(0x1c1))[_0x1c18d3(0x1df)]());var _0x17c171=AllCompanies[_0x1c18d3(0x129)](function(_0x2eefca){var _0x4722c1=_0x1c18d3;return _0x2eefca['ID']==excelRows[_0x52bc27][_0x4722c1(0x179)];}),_0x3e113b=AllDepartments[_0x1c18d3(0x129)](function(_0x2532ce){var _0x57d27a=_0x1c18d3;return _0x2532ce['ID']==excelRows[_0x52bc27][_0x57d27a(0x12b)];}),_0x443c81=AllOfficeLocation[_0x1c18d3(0x129)](function(_0x17aef6){return _0x17aef6['ID']==excelRows[_0x52bc27]['Location\x20*'];});_0x17c171['length']>0x0&&_0x3e113b['length']>0x0&&_0x443c81[_0x1c18d3(0x1ef)]>0x0?(Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x52bc27][_0x1c18d3(0x239)]=_0x1c18d3(0x16c)):(excelRows[_0x52bc27][_0x1c18d3(0x239)]=_0x1c18d3(0x248),Error=Error+0x1);}else excelRows[_0x52bc27]['Status']==_0x1c18d3(0x182)&&(document[_0x1c18d3(0x200)](_0x1c18d3(0x229))['checked']&&(excelRows[_0x52bc27][_0x1c18d3(0x191)]=$(_0x1c18d3(0x20c))[_0x1c18d3(0x1df)]()),document[_0x1c18d3(0x200)](_0x1c18d3(0x172))[_0x1c18d3(0x228)]&&(excelRows[_0x52bc27]['Manager\x20*']=_0x11120c[0x0][_0x1c18d3(0x171)]['Email']),document[_0x1c18d3(0x200)](_0x1c18d3(0x13c))[_0x1c18d3(0x228)]&&(excelRows[_0x52bc27][_0x1c18d3(0x196)]=_0x1c18d3(0x223)),document[_0x1c18d3(0x200)](_0x1c18d3(0x18d))[_0x1c18d3(0x228)]&&(excelRows[_0x52bc27][_0x1c18d3(0x1bd)]=$(_0x1c18d3(0x1c1))[_0x1c18d3(0x1df)]()),Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x52bc27]['Status']=_0x1c18d3(0x16c));}}tabledata['setData'](excelRows),tabledata[_0x1c18d3(0x1d2)](pageIndex),$(_0x1c18d3(0x18f))[_0x1c18d3(0x161)](_0x1c18d3(0x209)),showmessage();}else alert(_0x1c18d3(0x24e)),$(_0x1c18d3(0x15c))[_0x1c18d3(0x1df)]();}),$(a0_0x3026c6(0x203))['change'](function(){var _0x59a752=a0_0x3026c6;CompaniesId=parseInt($(_0x59a752(0x244),$(this))['val']());var _0x55b2d4=AllOfficeLocation[_0x59a752(0x129)](function(_0x3fb1db){var _0x3ed6f6=_0x59a752;return _0x3fb1db[_0x3ed6f6(0x1d4)]===CompaniesId;}),_0x4fde2a=document[_0x59a752(0x200)](_0x59a752(0x139));_0x4fde2a[_0x59a752(0x1ff)]='';for(var _0x3f952c=0x0;_0x3f952c<_0x55b2d4['length'];_0x3f952c++){var _0x4966b8=_0x55b2d4[_0x3f952c][_0x59a752(0x1bf)],_0x378f04=_0x55b2d4[_0x3f952c]['ID'];opt=document['createElement'](_0x59a752(0x1d9)),opt[_0x59a752(0x1ad)]=_0x378f04,opt[_0x59a752(0x178)]=_0x4966b8,_0x4fde2a[_0x59a752(0x169)](opt);}Getofficelocation=parseInt($(_0x59a752(0x244),$(_0x59a752(0x25e)))[_0x59a752(0x1df)]());var _0x23ad3a=AllDepartments[_0x59a752(0x129)](function(_0x16508b){var _0x2bb443=_0x59a752;return _0x16508b[_0x2bb443(0x1d4)]===CompaniesId;}),_0x4fde2a=document[_0x59a752(0x200)](_0x59a752(0x134));_0x4fde2a[_0x59a752(0x1ff)]='';for(var _0x3f952c=0x0;_0x3f952c<_0x23ad3a[_0x59a752(0x1ef)];_0x3f952c++){var _0x4966b8=_0x23ad3a[_0x3f952c]['DepartmentName'],_0x378f04=_0x23ad3a[_0x3f952c]['ID'];opt=document[_0x59a752(0x183)]('option'),opt[_0x59a752(0x1ad)]=_0x378f04,opt[_0x59a752(0x178)]=_0x4966b8,_0x4fde2a['appendChild'](opt);}GetDepartments=parseInt($(_0x59a752(0x244),$(_0x59a752(0x1e5)))[_0x59a752(0x1df)]());}),$(a0_0x3026c6(0x1e5))[a0_0x3026c6(0x1de)](function(){var _0x111456=a0_0x3026c6;GetDepartments=parseInt($(_0x111456(0x244),$(this))[_0x111456(0x1df)]());}),$(a0_0x3026c6(0x25e))[a0_0x3026c6(0x1de)](function(){var _0x43b078=a0_0x3026c6;Getofficelocation=parseInt($(_0x43b078(0x244),$(this))[_0x43b078(0x1df)]());});function chkManagerevent(_0xb7978f){var _0x4e376f=a0_0x3026c6;if(_0xb7978f[_0x4e376f(0x228)])$(_0x4e376f(0x136))['prop'](_0x4e376f(0x228),![]),$(_0x4e376f(0x1f0))[_0x4e376f(0x15f)](_0x4e376f(0x25a)),$('#txtmanager')[_0x4e376f(0x1b9)]();else{}}var TopExecutive='';function chkTopExecutiveevent(_0x393377){var _0x35e241=a0_0x3026c6;if(_0x393377[_0x35e241(0x228)])$('#chkManager')['prop']('checked',![]),$(_0x35e241(0x1f0))['prop'](_0x35e241(0x25a),!![]),$(_0x35e241(0x1f0))[_0x35e241(0x1df)](''),TopExecutive=_0x35e241(0x223);else{}}$('#btnDownLoadReport')[a0_0x3026c6(0x1e4)](function(){var _0x1a5c20=a0_0x3026c6;tabledata[_0x1a5c20(0x1ae)](_0x1a5c20(0x1eb),_0x1a5c20(0x15a),{'sheetName':_0x1a5c20(0x1fa)});});var dvExcel=document['getElementById'](a0_0x3026c6(0x1ca));dvExcel[a0_0x3026c6(0x1ff)]='';var outputArray=[];function removewithfilter(_0x5ce73f){var _0x332d73=a0_0x3026c6;let _0x23a7ea=_0x5ce73f[_0x332d73(0x129)](function(_0x4f3996,_0x2fb0f3,_0x4da533){var _0x53189f=_0x332d73;return _0x2fb0f3==_0x4da533[_0x53189f(0x1c2)](_0x4f3996);});return _0x23a7ea;}function GetItemTypeForListName(_0x177489){var _0x50d342=a0_0x3026c6;return _0x50d342(0x181)+_0x177489['charAt'](0x0)[_0x50d342(0x23d)]()+_0x177489[_0x50d342(0x19b)]('\x20')[_0x50d342(0x1e3)]('')[_0x50d342(0x12d)](0x1)+_0x50d342(0x24c);}function a0_0x456c(_0x1b2d68,_0x193429){var _0x2737c9=a0_0x2737();return a0_0x456c=function(_0x456c21,_0x56ac3f){_0x456c21=_0x456c21-0x11b;var _0x435ef3=_0x2737c9[_0x456c21];return _0x435ef3;},a0_0x456c(_0x1b2d68,_0x193429);}var response=response||[];function getItems(_0x413018,_0x2ae885){var _0x223e4a=a0_0x3026c6;return $['ajax']({'url':_0x413018,'type':_0x223e4a(0x149),'async':![],'headers':{'accept':_0x223e4a(0x23a)},'success':function(_0x5da728){var _0x1d362d=_0x223e4a;response=response[_0x1d362d(0x1f5)](_0x5da728['d'][_0x1d362d(0x1e8)]),_0x5da728['d'][_0x1d362d(0x170)]?(_0x413018=_0x5da728['d'][_0x1d362d(0x170)],getItems(_0x413018,_0x2ae885)):_0x2ae885[_0x1d362d(0x256)](response);},'error':function(_0x216edd){var _0x5b9560=_0x223e4a;_0x2ae885['reject'](_0x216edd),console[_0x5b9560(0x159)](_0x216edd);}}),_0x2ae885['promise']();}function ConvertddmmyyTommddyy(_0x18253a){var _0x164b77=a0_0x3026c6;return _0x18253a[_0x164b77(0x19b)]('/')[0x1]+'/'+_0x18253a[_0x164b77(0x19b)]('/')[0x0]+'/'+_0x18253a[_0x164b77(0x19b)]('/')[0x2];}function InsertWelcomeInAnnouncementList(_0x262c5f){var _0x567133=a0_0x3026c6;$[_0x567133(0x21d)]({'url':_spPageContextInfo[_0x567133(0x1b4)]+'/_api/web/lists/GetByTitle(\x27Announcements\x27)/items','type':_0x567133(0x11e),'async':![],'data':JSON[_0x567133(0x1fc)](_0x262c5f),'headers':{'Accept':'application/json;odata=verbose','Content-Type':_0x567133(0x23a),'X-RequestDigest':$(_0x567133(0x1a7))['val'](),'X-HTTP-Method':'POST'},'success':function(_0x13706d,_0x5dcc86,_0x343d51){var _0x252ed0=_0x567133;console[_0x252ed0(0x159)](_0x252ed0(0x144));},'error':function(_0x44cf1c){var _0x54d5ba=_0x567133;console[_0x54d5ba(0x159)](_0x44cf1c),console[_0x54d5ba(0x159)](_0x54d5ba(0x17d)),currentDlg[_0x54d5ba(0x1c5)]();}});}