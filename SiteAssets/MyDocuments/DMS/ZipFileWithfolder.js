var a0_0x2717ba=a0_0x5b8c;(function(_0x1a5cca,_0x4bb504){var _0x37b695=a0_0x5b8c,_0x3aa65c=_0x1a5cca();while(!![]){try{var _0x5224d1=-parseInt(_0x37b695(0xf6))/0x1+parseInt(_0x37b695(0xe8))/0x2*(-parseInt(_0x37b695(0xee))/0x3)+-parseInt(_0x37b695(0xd3))/0x4*(-parseInt(_0x37b695(0xec))/0x5)+-parseInt(_0x37b695(0xb4))/0x6*(parseInt(_0x37b695(0xfa))/0x7)+-parseInt(_0x37b695(0xf0))/0x8*(-parseInt(_0x37b695(0xb3))/0x9)+-parseInt(_0x37b695(0xe2))/0xa*(-parseInt(_0x37b695(0xab))/0xb)+parseInt(_0x37b695(0xe7))/0xc*(parseInt(_0x37b695(0xf4))/0xd);if(_0x5224d1===_0x4bb504)break;else _0x3aa65c['push'](_0x3aa65c['shift']());}catch(_0x2757da){_0x3aa65c['push'](_0x3aa65c['shift']());}}}(a0_0x5d8a,0x78a14));const selectedFolders=[];var zip,listName=a0_0x2717ba(0xc7),folderName=[];const myTimeout='';function a0_0x5b8c(_0x59b357,_0x2a018f){var _0x5d8a9b=a0_0x5d8a();return a0_0x5b8c=function(_0x5b8c3e,_0xc78301){_0x5b8c3e=_0x5b8c3e-0xa5;var _0x25c9be=_0x5d8a9b[_0x5b8c3e];return _0x25c9be;},a0_0x5b8c(_0x59b357,_0x2a018f);}var messagetext='',Ismessage=![],IsleftRestritcfile=![];async function downloadSelectedFilesAsZip(_0x1adbac){var _0x269206=a0_0x2717ba;$[_0x269206(0xb0)](_0x269206(0xa9),function(){var _0x659b80=_0x269206;_0x1adbac[0x0][_0x659b80(0xf1)]==undefined?(listName=_0x1adbac[0x0][_0x659b80(0xfb)],SiteUrl=_0x1adbac[0x0][_0x659b80(0x104)]):listName=_0x1adbac[0x0][_0x659b80(0xf1)];var _0x444d44=[];Ismessage=![],folderName=[],messagetext='';var _0xadc5dd=_0x1adbac['map'](function(_0x508942){var _0x649391=_0x659b80;folderName[_0x649391(0xd6)](_0x508942[_0x649391(0xc1)]),_0x508942['IsBlock']!=_0x649391(0xae)?_0x508942['fileserverrelativeurl']==undefined?$[_0x649391(0xa6)](getFolderFilesAndSubFolders(_0x508942[_0x649391(0xb5)],_0x444d44))[_0x649391(0xbb)](function(_0x1ab073){return _0xadc5dd=_0x1ab073;}):$[_0x649391(0xa6)](getFolderFilesAndSubFolders(_0x508942[_0x649391(0xe0)],_0x444d44))['done'](function(_0x377262){return _0xadc5dd=_0x377262;}):(Ismessage=!![],messagetext='\x20Files/folders\x20with\x20restricted\x20view\x20permission\x20can\x27t\x20be\x20downloaded.');}),_0x12eed7='';_0x444d44[_0x659b80(0x103)]>0x0?Promise[_0x659b80(0xe1)](_0xadc5dd)[_0x659b80(0xf8)](function(){var _0x16f2ba=_0x659b80;zip=new JSZip();var _0x3377ea=_0x444d44[_0x16f2ba(0xdb)](function(_0x23b847){var _0x339bc3=_0x16f2ba,_0x53c13c=_spPageContextInfo[_0x339bc3(0xcb)]+_0x23b847;return fetch(_0x53c13c)[_0x339bc3(0xf8)](function(_0x315dba){var _0x363189=_0x339bc3;if(!_0x315dba['ok'])throw new Error(_0x363189(0xc8));return _0x315dba[_0x363189(0xd1)]();})[_0x339bc3(0xf8)](function(_0x116467){var _0x1e9b34=_0x339bc3,_0x307d68=_0x23b847[_0x1e9b34(0x105)](_0x23b847['indexOf'](listName)+listName[_0x1e9b34(0x103)]+0x1);zip[_0x1e9b34(0xf9)](_0x307d68,_0x116467);})[_0x339bc3(0xf7)](_0x418cce=>{var _0x5a590b=_0x339bc3;console[_0x5a590b(0xdd)]('There\x20was\x20a\x20problem\x20with\x20the\x20fetch\x20operation:',_0x418cce);});});Promise[_0x16f2ba(0xe1)](_0x3377ea)[_0x16f2ba(0xf8)](function(){dowloadZip();});}):(Ismessage?alert(messagetext):alert(_0x659b80(0xd0)),IsleftRestritcfile=![],waitingDialog[_0x659b80(0xf5)]());});}function dowloadZip(){var _0x5a508a=a0_0x2717ba;zip['generateAsync']({'type':_0x5a508a(0xd1)})[_0x5a508a(0xf8)](function(_0x16412a){var _0x1bbe88=_0x5a508a,_0x1b5f96=document[_0x1bbe88(0xde)]('a');_0x1b5f96[_0x1bbe88(0xaf)]=URL[_0x1bbe88(0xd2)](_0x16412a),_0x1b5f96['download']=_0x1bbe88(0xa7)+new Date()[_0x1bbe88(0xb9)]()[_0x1bbe88(0xf3)](0x0,0x14)+'.zip',_0x1b5f96[_0x1bbe88(0xe3)](),waitingDialog[_0x1bbe88(0xf5)](),IsleftRestritcfile&&(alert(_0x1bbe88(0xef)),IsleftRestritcfile=![]),$('.chkFileFolder')[_0x1bbe88(0xbc)](_0x1bbe88(0xdc),![]),$(_0x1bbe88(0xac))['prop'](_0x1bbe88(0xdc),![]),arrFileFolder=[];});}function getFilesFromLibrary(_0x10b82a){var _0x393510=a0_0x2717ba,_0x4905f2=_0x10b82a+_0x393510(0xdf);$[_0x393510(0xeb)]({'url':_0x4905f2,'type':_0x393510(0xe4),'headers':{'Accept':_0x393510(0x101)},'beforeSend':function(){var _0x378e30=_0x393510;$(_0x378e30(0xca))[_0x378e30(0xb1)]();},'success':function(_0x4f7e5f){var _0x16babe=_0x393510,_0x4bbde1=_0x4f7e5f['d']['results'],_0x5578f3=[];_0x4bbde1[_0x16babe(0xe9)](function(_0x1fa582){var _0x6b45e0=_0x16babe,_0x356e63=_0x1fa582[_0x6b45e0(0xbd)][_0x6b45e0(0x105)](_0x1fa582[_0x6b45e0(0xbd)][_0x6b45e0(0xbf)]('/')+0x1),_0x1cf241={'name':_0x356e63,'url':_0x1fa582[_0x6b45e0(0xbd)],'checkbox':'<input\x20type=\x27checkbox\x27\x20name=\x27files\x27\x20value=\x27'+_0x1fa582['FileRef']+'\x27>'};_0x5578f3[_0x6b45e0(0xd6)](_0x1cf241);});var _0x5ea654='<table>';_0x5ea654+=_0x16babe(0xc3),_0x5578f3[_0x16babe(0xe9)](function(_0x16971a){var _0x2118e2=_0x16babe;_0x5ea654+=_0x2118e2(0xad)+_0x16971a[_0x2118e2(0xc0)]+_0x2118e2(0xbe)+_0x16971a['name']+_0x2118e2(0xc2);}),_0x5ea654+=_0x16babe(0xd5),$(_0x16babe(0xc6))[_0x16babe(0xd8)](_0x5ea654);},'error':function(_0x3f1720){console['log'](_0x3f1720);}});}function getFolderFilesAndSubFolders(_0x1253f2,_0x2556e2){var _0x353c80=a0_0x2717ba,_0x3c9408=SiteUrl+'/_api/web/GetFolderByServerRelativeUrl(\x27'+_0x1253f2+_0x353c80(0xa8);return jQuery[_0x353c80(0xeb)]({'url':_0x3c9408,'type':_0x353c80(0xe4),'async':![],'headers':{'accept':_0x353c80(0x101)},'beforeSend':function(){},'success':function(_0x3caa0e){var _0x26a597=_0x353c80,_0x3c495f=parseBasePermissionss(_0x3caa0e['d'][_0x26a597(0xa5)]['EffectiveBasePermissions']);if(_0x3c495f!=![]){var _0x360183=_0x3caa0e['d'][_0x26a597(0xd4)][_0x26a597(0xd9)];_0x360183[_0x26a597(0xe9)](function(_0x5adf50){var _0x2b9097=_0x26a597;parseBasePermissionss(_0x5adf50[_0x2b9097(0xa5)][_0x2b9097(0xfe)])!=![]?_0x2556e2[_0x2b9097(0xd6)](_0x5adf50[_0x2b9097(0xc5)]):IsleftRestritcfile=!![];});var _0x5f3928=_0x3caa0e['d']['Folders'][_0x26a597(0xd9)],_0x386407=_0x5f3928['map'](function(_0x55a69c){var _0x4e2347=_0x26a597;getFolderFilesAndSubFolders(_0x55a69c[_0x4e2347(0xc5)],_0x2556e2);});}else IsleftRestritcfile=!![];},'error':function(_0x1efd5e){var _0x6dac47=_0x353c80;console[_0x6dac47(0x102)](_0x1efd5e);}}),_0x2556e2;}function parseBasePermissionss(_0x4bbe0b){var _0x22d54d=a0_0x2717ba,_0x3f2843=new SP[(_0x22d54d(0xaa))]();return _0x3f2843['initPropertiesFromJson'](_0x4bbe0b),_0x3f2843[_0x22d54d(0xda)](SP[_0x22d54d(0xb7)][_0x22d54d(0xcc)]);}var Isnotpermission=![];function a0_0x5d8a(){var _0x50d0a6=['length','SiteURL','substring','ListItemAllFields','when','files_','\x27)?$expand=Folders,Files,\x20ListItemAllFields/EffectiveBasePermissions,\x20Files/ListItemAllFields/EffectiveBasePermissions','https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js','BasePermissions','88121kApBcc','.chkShareToMe','<tr><td>','Yes','href','getScript','fadeIn','&$skiptoken=','769977ZBMuIG','6ARhteC','ServerURL','stringify','PermissionKind','application/json;\x20odata=verbose','toJSON','__next','done','prop','FileRef','</td><td>','lastIndexOf','checkbox','FileFolderName','</td></tr>','<tr><th>Select</th><th>Name</th></tr>','promise','ServerRelativeUrl','#fileList','DemoLibrary','Network\x20response\x20was\x20not\x20ok','&$filter=FileDirRef\x20eq\x20\x27','#overlaysearch','portalUrl','openItems','apply','Deferred','resolve','This\x20is\x20an\x20empty\x20folder\x20&\x20can\x27t\x20be\x20downloaded.','blob','createObjectURL','4qjSFWO','Files','</table>','push','skiptoken=','html','results','has','map','checked','error','createElement','/_api/web/lists/getByTitle(\x27DemoLibrary\x27)/items?$select=FileRef&$orderby=FileLeafRef&$filter=FSObjType\x20eq\x201','fileserverrelativeurl','all','20qXDFYD','click','GET','webAbsoluteUrl','/_api/web/lists/getbytitle(\x27','12wjIMNO','10khOQAd','forEach','concat','ajax','3539050FTbaaL','fail','356415SWsSGT','Restricted\x20file(s)\x20are\x20skipped\x20to\x20download','56tPuEbm','SelectedLibrary','reject','slice','2659891NOYoVQ','hide','214976kKVodK','catch','then','file','1569463JIzlGP','LibraryName','Error\x20checking\x20file\x20permissions:\x20','/_api/web/GetFolderByServerRelativePath(\x27','EffectiveBasePermissions','\x27)/GetFolderByServerRelativeUrl(\x27','\x27)?$select=ID,EncodedAbsUrl,File_x0020_Type&$expand=Folders,Folders/ListItemAllFields/HasUniqueRoleAssignments,Files/ModifiedBy/Title,Files/ListItemAllFields/HasUniqueRoleAssignments,Folders/ListItemAllFields,Files,Files/ListItemAllFields,Files/ListItemAllFields/FileSizeDisplay&$orderby=Modified\x20desc','application/json;odata=verbose','log'];a0_0x5d8a=function(){return _0x50d0a6;};return a0_0x5d8a();}function checkFilePermission(_0x3a9c77){var _0x541f3f=a0_0x2717ba;Isnotpermission=![];var _0x483e3b=SiteUrl+_0x541f3f(0xfd)+_0x3a9c77+_0x541f3f(0x100);return $[_0x541f3f(0xeb)]({'url':_0x483e3b,'type':'GET','async':![],'headers':{'accept':_0x541f3f(0x101)},'success':function(_0x101195){debugger;},'error':function(_0xa6bdd){var _0x5c8040=_0x541f3f;console[_0x5c8040(0x102)](_0x5c8040(0xfc)+JSON[_0x5c8040(0xb6)](_0xa6bdd));}}),Isnotpermission;}function retrieveAllItemsFromFolder(_0x52fb61,_0x1d08f9){var _0x244b5f=a0_0x2717ba,_0x16d553=$[_0x244b5f(0xce)](),_0x3b61d3=[];_0x25d692(_0x52fb61,_0x1d08f9,null,_0x3b61d3);function _0x25d692(_0x49b0b9,_0x2a5581,_0x1447ad,_0x27892e){var _0x4f89d7=_0x244b5f,_0x8b36cd=_spPageContextInfo[_0x4f89d7(0xe5)]+_0x4f89d7(0xe6)+_0x49b0b9+'\x27)/items?$top=5000';_0x2a5581&&(_0x8b36cd+=_0x4f89d7(0xc9)+_0x2a5581+'\x27'),_0x1447ad&&(_0x8b36cd+=_0x4f89d7(0xb2)+encodeURIComponent(_0x1447ad)),$[_0x4f89d7(0xeb)]({'url':_0x8b36cd,'method':_0x4f89d7(0xe4),'headers':{'Accept':_0x4f89d7(0xb8)},'success':function(_0x337cc4){var _0x52cb6e=_0x4f89d7;_0x27892e=_0x27892e[_0x52cb6e(0xea)](_0x337cc4['d'][_0x52cb6e(0xd9)]);if(_0x337cc4['d'][_0x52cb6e(0xba)]){var _0x3025d5=_0x337cc4['d']['__next'],_0x499aa0=_0x3025d5[_0x52cb6e(0x105)](_0x3025d5['indexOf'](_0x52cb6e(0xd7))+0xa);_0x25d692(_0x49b0b9,_0x2a5581,_0x499aa0,_0x27892e);}else _0x2f0c11(_0x49b0b9,_0x2a5581,_0x27892e)[_0x52cb6e(0xf8)](function(_0x3a92d4){var _0x532299=_0x52cb6e;_0x16d553[_0x532299(0xcf)](_0x3a92d4);})[_0x52cb6e(0xed)](function(_0x13da04){_0x16d553['reject'](_0x13da04);});},'error':function(_0x3bbd77){var _0x1d2589=_0x4f89d7;_0x16d553[_0x1d2589(0xf2)](_0x3bbd77);}});}function _0x2f0c11(_0x48e0f8,_0x835fc4,_0x1214e0){var _0x4f84b5=_0x244b5f,_0x6fe703=$[_0x4f84b5(0xce)](),_0x3ea525=_spPageContextInfo[_0x4f84b5(0xe5)]+'/_api/web/lists/getbytitle(\x27'+_0x48e0f8+_0x4f84b5(0xff)+_0x835fc4+'\x27)/folders';return $[_0x4f84b5(0xeb)]({'url':_0x3ea525,'method':_0x4f84b5(0xe4),'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x5efe56){var _0x434444=_0x4f84b5,_0x4a1c65=_0x5efe56['d'][_0x434444(0xd9)],_0x317843=$[_0x434444(0xdb)](_0x4a1c65,function(_0x4520b8){var _0x1df8f6=_0x434444,_0x50ef62=_0x4520b8[_0x1df8f6(0xc5)];return _0x25d692(_0x48e0f8,_0x50ef62,null,_0x1214e0);});$['when'][_0x434444(0xcd)]($,_0x317843)[_0x434444(0xbb)](function(){var _0x188f5d=_0x434444,_0x2ea753=[];for(var _0xd773c7=0x0;_0xd773c7<arguments[_0x188f5d(0x103)];_0xd773c7++){_0x2ea753=_0x2ea753[_0x188f5d(0xea)](arguments[_0xd773c7]);}var _0x1371eb=_0x1214e0[_0x188f5d(0xea)](_0x2ea753);_0x6fe703[_0x188f5d(0xcf)](_0x1371eb);})[_0x434444(0xed)](function(_0x422b07){var _0x500964=_0x434444;_0x6fe703[_0x500964(0xf2)](_0x422b07);});},'error':function(_0x3435a3){var _0x27a339=_0x4f84b5;_0x6fe703[_0x27a339(0xf2)](_0x3435a3);}}),_0x6fe703[_0x4f84b5(0xc4)]();}return _0x16d553[_0x244b5f(0xc4)]();}