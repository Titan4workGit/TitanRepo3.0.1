var a0_0x17d305=a0_0x29f1;(function(_0x5511ff,_0x22070c){var _0x195cd8=a0_0x29f1,_0x34809b=_0x5511ff();while(!![]){try{var _0x2da3a5=parseInt(_0x195cd8(0x10f))/0x1*(-parseInt(_0x195cd8(0xc1))/0x2)+parseInt(_0x195cd8(0xb2))/0x3+-parseInt(_0x195cd8(0x139))/0x4*(parseInt(_0x195cd8(0x99))/0x5)+-parseInt(_0x195cd8(0x133))/0x6*(parseInt(_0x195cd8(0xae))/0x7)+parseInt(_0x195cd8(0x150))/0x8+parseInt(_0x195cd8(0xa2))/0x9*(-parseInt(_0x195cd8(0xea))/0xa)+parseInt(_0x195cd8(0x17e))/0xb;if(_0x2da3a5===_0x22070c)break;else _0x34809b['push'](_0x34809b['shift']());}catch(_0x394789){_0x34809b['push'](_0x34809b['shift']());}}}(a0_0x3550,0x68cb6));var clientContext='',oNewWebsite='',departmentID='',companyID='',siteURLProjects='',siteUrl='',siteclientContext='',projectInternalName='';stackToUsers='',sponsorToUsers='',alluser='',projecttouser='';function a0_0x29f1(_0x4dbca0,_0x118e7f){var _0x355055=a0_0x3550();return a0_0x29f1=function(_0x29f13f,_0x361277){_0x29f13f=_0x29f13f-0x82;var _0x100ba8=_0x355055[_0x29f13f];return _0x100ba8;},a0_0x29f1(_0x4dbca0,_0x118e7f);}var IsProjectAdmin=![],IsdeptAdmin=![];$(document)[a0_0x17d305(0xda)](function(){var _0x56f126=a0_0x17d305;$[_0x56f126(0xf9)](getProjectRights())[_0x56f126(0xe1)](function(_0x103f21){var _0x21b648=_0x56f126;if(_0x103f21)SP[_0x21b648(0xe4)][_0x21b648(0x18a)](Initialization_ProjectSite,_0x21b648(0xa1));else IsDepartmentAdmin()==!![]?SP[_0x21b648(0xe4)][_0x21b648(0x18a)](Initialization_ProjectSite,'sp.js'):(alert('Unauthorized\x20access!'),window[_0x21b648(0x153)][_0x21b648(0x132)]=_0x21b648(0xfe)+titanForWork['getQueryStringParameter']('CompanyId')+'');});}),$(document)[a0_0x17d305(0xda)](function(){var _0x2cabf8=a0_0x17d305;companyID=titanForWork[_0x2cabf8(0x112)](_0x2cabf8(0xfd)),$('.dropdown\x20dt\x20a')['on'](_0x2cabf8(0x18f),function(){var _0x4df5c8=_0x2cabf8;$(_0x4df5c8(0x148))[_0x4df5c8(0x9e)](_0x4df5c8(0x84));}),$(_0x2cabf8(0x164))['on'](_0x2cabf8(0x18f),function(){var _0x5c7d51=_0x2cabf8;$('.dropdown\x20dd\x20ul')[_0x5c7d51(0x8d)]();});function _0x4132a0(_0x3e14b6){var _0x19a724=_0x2cabf8;return $('#'+_0x3e14b6)[_0x19a724(0x18d)]('dt\x20a\x20span.value')[_0x19a724(0x137)]();}$(document)[_0x2cabf8(0x14b)]('click',function(_0x41e98a){var _0x1e1664=_0x2cabf8,_0x303ba9=$(_0x41e98a[_0x1e1664(0x177)]);if(!_0x303ba9[_0x1e1664(0xb0)]()[_0x1e1664(0x12f)](_0x1e1664(0xad)))$(_0x1e1664(0x148))[_0x1e1664(0x8d)]();}),$('#ProjectStatus')[_0x2cabf8(0x104)](_0x2cabf8(0xf4),!![]),$(_0x2cabf8(0x179))[_0x2cabf8(0x8d)](),$('.txtPlannedStartDate')[_0x2cabf8(0x11d)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x2cabf8(0x90)}),$(_0x2cabf8(0xcc))[_0x2cabf8(0x11d)]('option',_0x2cabf8(0x8c),_0x2cabf8(0xfc)),$(_0x2cabf8(0xfb))[_0x2cabf8(0x11d)]({'changeMonth':!![],'changeYear':!![],'yearRange':'-50:+50'}),$('.txtPlannedEndDate')[_0x2cabf8(0x11d)](_0x2cabf8(0xd9),'dateFormat',_0x2cabf8(0xfc)),$(_0x2cabf8(0x87))[_0x2cabf8(0x11d)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x2cabf8(0x90)}),$('.txtActualStartDate')[_0x2cabf8(0x11d)]('option','dateFormat','dd/mm/yy'),$(_0x2cabf8(0xa6))['datepicker']({'changeMonth':!![],'changeYear':!![],'yearRange':'-50:+50'}),$(_0x2cabf8(0xa6))[_0x2cabf8(0x11d)](_0x2cabf8(0xd9),_0x2cabf8(0x8c),'dd/mm/yy'),$('#txtProjectName')['blur'](function(){var _0x1a6aa4=_0x2cabf8,_0x33ad0b=$(_0x1a6aa4(0x17c))[_0x1a6aa4(0x173)]();$[_0x1a6aa4(0xb9)]($('#txtProjectName')[_0x1a6aa4(0x173)]())!=''&&CheckProjectCodeExistOrNot(_0x1a6aa4(0x147),_0x33ad0b);}),$(_0x2cabf8(0xd7))[_0x2cabf8(0x8e)](function(){var _0x59e68f=_0x2cabf8,_0x353c31=$(_0x59e68f(0xd7))['val']();$['trim']($(_0x59e68f(0xd7))['val']())!=''&&CheckProjectCodeExistOrNot(_0x59e68f(0xb3),_0x353c31);});var _0x2b446b=new Array();_0x2b446b[_0x2cabf8(0x9d)](0x8),_0x2b446b[_0x2cabf8(0x9d)](0x9),_0x2b446b['push'](0x2e),_0x2b446b[_0x2cabf8(0x9d)](0x24),_0x2b446b['push'](0x23),_0x2b446b['push'](0x25),_0x2b446b['push'](0x27),_0x2b446b[_0x2cabf8(0x9d)](0x20),$(_0x2cabf8(0x17c))[_0x2cabf8(0x181)](function(_0x14e7b2){var _0x9b9ff3=_0x2cabf8,_0x176b53=_0x14e7b2['keyCode']==0x0?_0x14e7b2[_0x9b9ff3(0x115)]:_0x14e7b2[_0x9b9ff3(0xc3)],_0x3ede45=_0x176b53==0x2d||_0x176b53==0x26||_0x176b53==0x5f||_0x176b53>=0x30&&_0x176b53<=0x39||_0x176b53>=0x41&&_0x176b53<=0x5a||_0x176b53>=0x61&&_0x176b53<=0x7a||_0x2b446b[_0x9b9ff3(0xa8)](_0x14e7b2[_0x9b9ff3(0xc3)])!=-0x1&&_0x14e7b2[_0x9b9ff3(0x115)]!=_0x14e7b2[_0x9b9ff3(0xc3)]||_0x14e7b2[_0x9b9ff3(0xc3)]==0x20;return _0x3ede45;});});function getmultiselctValue(){var _0xbfef49=a0_0x17d305;$(_0xbfef49(0x178))['on'](_0xbfef49(0x18f),function(){var _0xe22477=_0xbfef49,_0x4f5412=$(this)[_0xe22477(0x111)](_0xe22477(0xd5))[_0xe22477(0x18d)]('input[type=\x22checkbox\x22]')[_0xe22477(0x173)](),_0x4f5412=$(this)[_0xe22477(0x173)]()+',';if($(this)['is'](_0xe22477(0x9c))){var _0x311686='<span\x20title=\x22'+_0x4f5412+'\x22>'+_0x4f5412+'</span>';$(_0xe22477(0x13c))[_0xe22477(0x93)](_0x311686),$(_0xe22477(0x109))[_0xe22477(0x8d)]();}else{$(_0xe22477(0x127)+_0x4f5412+'\x22]')['remove']();var _0x360831=$(_0xe22477(0x109));$(_0xe22477(0x13b))[_0xe22477(0x93)](_0x360831);}});}function Initialization_ProjectSite(){var _0x5e0dee=a0_0x17d305;InitializePeoplePicker('ProjectManagerEmployeePicker',![]),InitializePeoplePicker(_0x5e0dee(0x18c),!![]),InitializePeoplePicker('StackeholderTeamEmployeePicker',!![]),departmentID=titanForWork[_0x5e0dee(0x112)](_0x5e0dee(0x110)),companyID=titanForWork[_0x5e0dee(0x112)](_0x5e0dee(0xfd)),companyID>0x0&&getCurrentURL_EventCreateProjectSite(_0x5e0dee(0x131),companyID),$('#cancelNewProject')[_0x5e0dee(0x18f)](function(){RedirectToListViewPage();});}function getCurrentURL_EventCreateProjectSite(_0x4a21ab,_0xeceed3){var _0x254db2=a0_0x17d305;siteURLProjects=_spPageContextInfo['webAbsoluteUrl']+_0x254db2(0x130)+_0x4a21ab+_0x254db2(0x163)+_0xeceed3+'\x27',$[_0x254db2(0x162)]({'url':siteURLProjects,'headers':{'Accept':_0x254db2(0x89)},'async':![],'success':function(_0x305217){var _0x4552b8=_0x254db2,_0x23d19a=_0x305217['d'][_0x4552b8(0x10d)];_0x23d19a['length']>0x0&&(siteURL=_0x23d19a[0x0][_0x4552b8(0xed)],siteclientContext=new SP[(_0x4552b8(0x96))](siteURL),siteURLProjects=_0x23d19a[0x0]['SiteURL'],siteURLProjects=siteURLProjects+_0x4552b8(0x106),clientContext=new SP['ClientContext'](siteURLProjects),getConsultantDetails(siteclientContext),officeLocation(),getClientMaster(),getDepartment(),bindProjectType());},'eror':function(_0x220394){var _0x73e932=_0x254db2;console[_0x73e932(0x102)]($('#txtSomethingWentWrong')[_0x73e932(0x173)]());}});}function getDepartment(){var _0x258e7a=a0_0x17d305,_0x238bee=titanForWork['getQueryStringParameter'](_0x258e7a(0xfd)),_0xa4fa74=new SP['ClientContext'](),_0x5c0612=_0xa4fa74[_0x258e7a(0x125)]()[_0x258e7a(0x149)]()[_0x258e7a(0xa9)](_0x258e7a(0x98)),_0x47e287=new SP[(_0x258e7a(0x13d))](),_0x4f06a3=_0x258e7a(0xc0)+_0x238bee+_0x258e7a(0x15a);_0x47e287['set_viewXml'](_0x4f06a3);var _0x33cd8c=_0x5c0612['getItems'](_0x47e287);_0xa4fa74[_0x258e7a(0x14d)](_0x33cd8c),_0xa4fa74[_0x258e7a(0x144)](function(){var _0x1df2d9=_0x258e7a,_0x760aa4=_0x33cd8c[_0x1df2d9(0x154)](),_0x20b77e=0x1,_0x4e2a2b=_0x1df2d9(0x176);_0x4e2a2b+=_0x1df2d9(0xa4);while(_0x760aa4[_0x1df2d9(0x11f)]()){var _0x8ba410=_0x760aa4['get_current'](),_0x2589c7=_0x8ba410[_0x1df2d9(0x128)]('ID'),_0x2b5c14=_0x8ba410['get_item'](_0x1df2d9(0xc2));_0x4e2a2b+='<option\x20value=\x22'+_0x2589c7+'\x22>'+_0x2b5c14+_0x1df2d9(0x189),_0x20b77e++;}_0x4e2a2b+=_0x1df2d9(0x18e),$(_0x1df2d9(0x141))[_0x1df2d9(0x93)](_0x4e2a2b),IsdeptAdmin==!![]&&($(_0x1df2d9(0xb6))['val'](Logged_DepartmentId),$(_0x1df2d9(0xb6))[_0x1df2d9(0x10a)](_0x1df2d9(0xf4),!![]));},function(){var _0x1f3fa8=_0x258e7a;console[_0x1f3fa8(0x102)](_0x1f3fa8(0xf0));});}function a0_0x3550(){var _0x2e2179=['disabled','Role','#txtTechnology','GET','&ProjectName=','when','#TaskTeamDetails','.txtPlannedEndDate','dd/mm/yy','CompanyId','../Pages/Default.aspx?WebAppId=','json','replace','#clientNameDiv','log','#SponsorTeam','attr','DocumentPermission','/DMS','ListItem','Width','.hida','prop','dd/MM/yyyy','-Select-','results','Project\x20Manager','2sxJsVx','DepartmentId','closest','getQueryStringParameter','webAbsoluteUrl','error','charCode','TaskPermission','</Value></Eq><Eq><FieldRef\x20Name=\x27OfficeLocationId\x27\x20/><Value\x20Type=\x27Text\x27>0</Value></Eq></And></Where><OrderBy><FieldRef\x20Name=\x27OfficeName\x27/></OrderBy></Query></View>','set_language','TeamPermission','{{ProjectCode}}','set_description','select#officeLocationDetails\x20option:selected','datepicker','SP.User','moveNext','ProcessApprovers','DepartmentName','Employee\x20is\x20not\x20active\x20','ClientName','MultipleSponsor','get_web','SP.Utilities.EmailProperties','span[title=\x22','get_item','{{PlannedStartDate}}','userId','PlanedStartDate','select2','\x27\x20and\x20(WebPartName\x20eq\x20\x27Project\x27)','{{ProjectClientName}}','hasClass','/_api/web/lists/getbytitle(\x27','Companies','href','234TstuKb','ProjectSiteURL','\x27)/items','i:0#.f|membership|','html','CompanySiteUrl','1014116MaEGjT','UserName','.dropdown\x20dt\x20a','.multiSel','CamlQuery','please\x20insert\x20only\x201\x20Manager','<option\x20value=\x22','onQueryFailed_CreateProjectSite','#departmentDiv','ManagerName','siteAbsoluteUrl','executeQueryAsync','promise','\x27\x20and\x20ProjectName\x20eq\x20\x27','True','.dropdown\x20dd\x20ul','get_lists','ProjectManagerEmployeePicker','bind','<option\x20value=\x220\x22>Select\x20Customer</option>','load','CatogeryName','Project\x20site\x20created\x20Successfully','5827840vZuCnZ','MaximumEntitySuggestions','show','location','getEnumerator','<select\x20name=\x22ClientName\x22\x20id=\x22clientName\x22\x20class=\x22form-control\x22>','GetAllUserInfo','Please\x20fill\x20all\x20required\x20fields.','add','<View><Query><Where><And><Eq><FieldRef\x20Name=\x27CompanyID\x27\x20/><Value\x20Type=\x27Lookup\x27>','</Value></Eq></Where><OrderBy><FieldRef\x20Name=\x27Title\x27/></OrderBy></Query></View>','/_api/web/siteusers(@v)?@v=\x27','Select\x20Customer','.multiSel\x20span','ProjectDetails','EngageDate','#__REQUESTDIGEST','SP.Data.','ajax','\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20\x27','.dropdown\x20dd\x20ul\x20li\x20a','MultipleStackeholder','empty','</li>','Consultant_List','\x27)/items?$select=*&$filter=CompanyId\x20eq\x20\x27','get','Please\x20Fill\x20the\x20Manager','ClientMaster','formatDate','OfficeLocation','message','<li><input\x20type=\x22checkbox\x22\x20value=','set_title','Request\x20failed.\x20','val','yyyy','1073741829','<select\x20name=\x22officeLocation\x22\x20id=\x22departmentDetails\x22\x20class=\x22form-control\x22>','target','.mutliSelect\x20input[type=\x22checkbox\x22]','.ActualEndDate','concat','set_webTemplate','#txtProjectName','#txtSomethingWentWrong','6742483wEkhTM','Permission\x20has\x20been\x20breaked\x20successfully!','getTime','keypress','get_stackTrace','#officeLocation','join','Deferred','length','?$select=*,LogonName/EMail,LogonName/Id,LogonName/FirstName,LogonName/LastName,LogonName/EMail&$expand=LogonName\x20&$filter=\x20Status\x20eq\x20\x27Active\x27\x20and\x20Company/ID\x20eq\x20','/_api/web/lists/getByTitle(\x27Documents\x27)/roleassignments/addroleassignment(principalid=','</option>','executeOrDelayUntilScriptLoaded','reject','SponsorTeamEmployeePicker','find','</select>','click','{{Projectlink}}','Permission\x20has\x20been\x20assigned\x20successfully!','/_api/web/lists/getByTitle(\x27Documents\x27)/breakroleinheritance(copyRoleAssignments=false,\x20clearSubscopes=true)','{{ProjectManager}}','toLowerCase','/_api/web/Lists/GetByTitle(\x27EmailTemplate\x27)/Items?$select=ID,Body,Subject,EmailType,Title&$filter=Title\x20eq\x20\x27','/_api/lists/getbytitle(\x27ProjectDetails\x27)/items?$select=*,ManagerName/Title,ManagerName/UserName,MultipleStackeholder/Title,MultipleStackeholder/UserName,MultipleSponsor/Title,MultipleSponsor/UserName&$Expand=ManagerName,MultipleStackeholder,MultipleSponsor&$Filter=ID\x20eq\x20\x27','createDelegate','toISOString','charAt','fast','SPClientPeoplePickerDict','#officeLocationDetails','.txtActualStartDate','toUpperCase','application/json;odata=verbose','POST','\x20and\x20LogonNameId\x20eq\x20','dateFormat','hide','blur','/DMS/','-50:+50','SearchPrincipalSource','focus','append','\x20/>','stringify','ClientContext','forEach','Departments','5oUcweb','STS#0','text',':checked','push','slideToggle','webServerRelativeUrl','/_api/Web/Lists/GetByTitle(\x27ProjectDetails\x27)/Items?$select=Title&$filter=ProjectCode\x20eq\x20\x27','sp.js','1632240YkkvbB','get_webs','<option\x20value=\x220\x22>-Select-</option>','ProjectInternalName','.txtActualEndDate','sponsorToUsers','indexOf','getByTitle','User','\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27','{{ProjectName}}','dropdown','87878xEUucz','getItems','parents','\x27\x20and\x20ContributorsId\x20eq\x20\x27','1125438gaXkwI','False','resolve','Subject','#departmentDetails','User\x20has\x20been\x20assigned\x20permission\x20.','&ProjectID=','trim','ProjectCode','#txtDescription','Consultant_Comp','toString','</Value></Eq><Eq><FieldRef\x20Name=\x27IsActive\x27\x20/><Value\x20Type=\x27Boolean\x27>1</Value></Eq></And></Where><OrderBy><FieldRef\x20Name=\x27Title\x27/></OrderBy></Query></View>','userEmail','<View><Query><Where><Eq><FieldRef\x20Name=\x27CompanyID\x27\x20/><Value\x20Type=\x27Lookup\x27>','181486QfJcMn','Title','keyCode','appendTo','100%','/_api/web/lists/getbytitle(\x27CategoryMaster\x27)/items?$select=CategoryType,CatogeryName&$filter=CategoryType\x20eq\x20\x27Project\x20Type\x27\x20and\x20Status\x20eq\x20\x27Yes\x27','/Pages/ViewProjectGrid.aspx?WebAppId=','getItemsWithQueryItem','Project\x20site\x20created\x20successfully','ProjectName','/_api/Web/Lists/GetByTitle(\x27ProjectDetails\x27)/Items?$select=Title&$filter=CompanyId\x20eq\x20\x27','.txtPlannedStartDate','CloseWaitDialog','dd-M-yy','set_viewXml','{{Location}}','PlanedEndDate','#txtDomain','/_api/web/roleassignments/addroleassignment(principalid=','split','.mutliSelect','{{Department}}','#txtProjectCode','{{PlannedEndDate}}','option','ready','#select2-clientName-container','Message\x20has\x20been\x20sent.','\x27\x20and\x20CompanyId\x20eq\x20\x27','ProjectTeamDetails','xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx','application/json;\x20odata=verbose','done','get_message','set_url','SOD','/_api/web/sitegroups/getbyname(\x27Owners\x27)/users','responseJSON','Project\x20Manager\x20Added\x20As\x20A\x20Default\x20Team\x20Member.','set_useSamePermissionsAsParentSite','Key','20swRYAE',',roleDefId=','OfficeName','SiteURL','SendEmailSharedNotification\x20\x20','#clientName','error\x20:\x20Project\x20Details\x20web\x20part','<View><OrderBy><FieldRef\x20Name=\x27ID\x27\x20Ascending=\x27False\x27/></OrderBy></View>','#ProjectStatus','projecttouser'];a0_0x3550=function(){return _0x2e2179;};return a0_0x3550();}function officeLocation(){var _0x29bcfd=a0_0x17d305,_0x1d4a6a=titanForWork[_0x29bcfd(0x112)]('CompanyId'),_0x4e5646=new SP['ClientContext'](),_0x540f41=_0x4e5646[_0x29bcfd(0x125)]()[_0x29bcfd(0x149)]()[_0x29bcfd(0xa9)](_0x29bcfd(0x16e)),_0x4ec19e=new SP[(_0x29bcfd(0x13d))](),_0x4202cf=_0x29bcfd(0x159)+_0x1d4a6a+_0x29bcfd(0x117);_0x4ec19e[_0x29bcfd(0xcf)](_0x4202cf);var _0x282e2a=_0x540f41['getItems'](_0x4ec19e);_0x4e5646[_0x29bcfd(0x14d)](_0x282e2a),_0x4e5646['executeQueryAsync'](function(){var _0x3247a6=_0x29bcfd,_0x332f8a=_0x282e2a[_0x3247a6(0x154)](),_0xc8e39=0x1,_0x4124dd='<select\x20name=\x22officeLocation\x22\x20id=\x22officeLocationDetails\x22\x20class=\x22form-control\x22>';_0x4124dd+='<option\x20value=\x220\x22>-Select-</option>';while(_0x332f8a[_0x3247a6(0x11f)]()){var _0x667849=_0x332f8a['get_current'](),_0x2831b3=_0x667849[_0x3247a6(0x128)]('ID'),_0x467888=_0x667849['get_item'](_0x3247a6(0xec));_0x4124dd+=_0x3247a6(0x13f)+_0x2831b3+'\x22>'+_0x467888+_0x3247a6(0x189),_0xc8e39++;}_0x4124dd+=_0x3247a6(0x18e),$(_0x3247a6(0x183))[_0x3247a6(0x93)](_0x4124dd);},function(){var _0x569ea9=_0x29bcfd;console[_0x569ea9(0x102)]('error\x20:\x20Project\x20Details\x20web\x20part');});}function getClientMaster(){var _0x5c47de=a0_0x17d305,_0x5b0015=titanForWork[_0x5c47de(0x112)]('CompanyId'),_0x1610b7=new SP[(_0x5c47de(0x96))](),_0xdb5ebb=_0x1610b7[_0x5c47de(0x125)]()[_0x5c47de(0x149)]()['getByTitle'](_0x5c47de(0x16c)),_0x13ce63=new SP[(_0x5c47de(0x13d))](),_0xcdf88f=_0x5c47de(0x159)+_0x5b0015+_0x5c47de(0xbe);_0x13ce63[_0x5c47de(0xcf)](_0xcdf88f);var _0x4f146a=_0xdb5ebb[_0x5c47de(0xaf)](_0x13ce63);_0x1610b7[_0x5c47de(0x14d)](_0x4f146a),_0x1610b7[_0x5c47de(0x144)](function(){var _0x276329=_0x5c47de;debugger;var _0x1fd5d4=_0x4f146a[_0x276329(0x154)](),_0x17d945=0x1,_0x32e0ff=_0x276329(0x155);_0x32e0ff+=_0x276329(0x14c);while(_0x1fd5d4[_0x276329(0x11f)]()){var _0x5a4ba5=_0x1fd5d4['get_current'](),_0x2d2b6f=_0x5a4ba5[_0x276329(0x128)]('ID'),_0x1019ca=_0x5a4ba5[_0x276329(0x128)](_0x276329(0xc2));_0x32e0ff+=_0x276329(0x13f)+_0x2d2b6f+'\x22>'+_0x1019ca+'</option>',_0x17d945++;}_0x32e0ff+=_0x276329(0x18e),$(_0x276329(0x101))[_0x276329(0x93)](_0x32e0ff),$(_0x276329(0xef))[_0x276329(0x12c)]({'placeholder':'Select\x20Customer','allowClear':![]});},function(){var _0x4a813a=_0x5c47de;console[_0x4a813a(0x102)](_0x4a813a(0xf0));});}function getConsultantDetails(_0x4b2225){var _0x575949=a0_0x17d305,_0x4fe4e6=_0x4b2225[_0x575949(0x125)]()[_0x575949(0x149)]()[_0x575949(0xa9)](_0x575949(0x168)),_0x29fe77=new SP['CamlQuery']();_0x29fe77[_0x575949(0xcf)](_0x575949(0xf1));var _0x57c409=_0x4fe4e6[_0x575949(0xaf)](_0x29fe77);_0x4b2225[_0x575949(0x14d)](_0x57c409),_0x4b2225[_0x575949(0x144)](function(){var _0x40f17f=_0x575949,_0x22c063='<ul>',_0xffa217=_0x57c409[_0x40f17f(0x154)](),_0x18465e=_0x57c409['get_count'](),_0x5c5e21=0x1;if(_0x18465e>0x0){while(_0xffa217[_0x40f17f(0x11f)]()){var _0x29d330=_0xffa217['get_current'](),_0x120c22=_0x29d330[_0x40f17f(0x128)](_0x40f17f(0xbc));_0x22c063+=_0x40f17f(0x170)+_0x120c22+_0x40f17f(0x94)+_0x120c22+_0x40f17f(0x167),_0x5c5e21++;}_0x22c063+='</ul>',$('.mutliSelect')[_0x40f17f(0x93)](_0x22c063),getmultiselctValue();}},function(){});}function getConsultantValue(){var _0x19517e=a0_0x17d305,_0x53f949='';return $(_0x19517e(0x15d))['each'](function(){var _0x41ebee=_0x19517e;_0x53f949+=$(this)[_0x41ebee(0x137)]();}),_0x53f949;}$(function(){bindButtonClick();});function bindButtonClick(){var _0xfdfed3=a0_0x17d305;$('#createNewProjectSite')['on'](_0xfdfed3(0x18f),function(){var _0x2382fd=_0xfdfed3;debugger;var _0x47d848=$(_0x2382fd(0x17c))[_0x2382fd(0x173)](),_0x49cd33=$('#txtProjectCode')[_0x2382fd(0x173)](),_0x28f9ee=$('#departmentDiv')[_0x2382fd(0x18d)]('#departmentDetails')[_0x2382fd(0x173)](),_0x271744=$(_0x2382fd(0x183))[_0x2382fd(0x18d)](_0x2382fd(0x86))[_0x2382fd(0x173)](),_0x3e0c0e=$(_0x2382fd(0xcc))[_0x2382fd(0x173)](),_0x515823=$(_0x2382fd(0xfb))['val'](),_0x2d30f8=getPeopleUserInfoGroups(_0x2382fd(0x14a));if(_0x2d30f8[_0x2382fd(0x186)]==0x0)return alert(_0x2382fd(0x16b)),![];if(_0x2d30f8[_0x2382fd(0x186)]==0x1){var _0xd55ec9=IsMangerActive(_0x2d30f8);if(!_0xd55ec9)return alert(_0x2382fd(0x122)),_0xd55ec9='',![];else var _0x574bda=_0x2d30f8[0x0];}if(_0x2d30f8[_0x2382fd(0x186)]>0x1)return alert(_0x2382fd(0x13e)),![];var _0x528b7d=$(_0x2382fd(0xbb))[_0x2382fd(0x173)](),_0x282559=$(_0x2382fd(0xdb))['text'](),_0x1440b0='';projectInternalName=GenerateGUID();_0x3e0c0e!=null&&_0x3e0c0e!=''&&(_0x1440b0=GetDateStandardFormat(_0x3e0c0e));var _0x9a5a69='';_0x515823!=null&&_0x515823!=''&&(_0x9a5a69=GetDateStandardFormat(_0x515823));if(_0x47d848[_0x2382fd(0xb9)]()==''||_0x3e0c0e==''||_0x515823==''||$(_0x2382fd(0xb6))[_0x2382fd(0x173)]()=='0'||_0x282559==_0x2382fd(0x15c))alert(_0x2382fd(0x157));else _0x9a5a69>_0x1440b0?(waitingDialog[_0x2382fd(0x152)](),createSite()):alert('Planned\x20End\x20Date\x20can\x20not\x20less\x20than\x20Planned\x20Start\x20Date.');});}function createSite(){var _0x39a3ca=a0_0x17d305,_0xd457c4=$('#txtProjectName')[_0x39a3ca(0x173)](),_0x4c53fa=$(_0x39a3ca(0xbb))[_0x39a3ca(0x173)]();siteUrl=projectInternalName;var _0x3ec1c1=clientContext[_0x39a3ca(0x125)]()[_0x39a3ca(0xa3)](),_0x43a2e7=new SP['WebCreationInformation']();_0x43a2e7['set_title'](_0xd457c4),_0x43a2e7['set_description'](_0x4c53fa),_0x43a2e7[_0x39a3ca(0x118)](0x409),_0x43a2e7[_0x39a3ca(0xe3)](siteUrl),_0x43a2e7[_0x39a3ca(0xe8)](!![]),_0x43a2e7[_0x39a3ca(0x17b)](_0x39a3ca(0x9a)),_0x3ec1c1['add'](_0x43a2e7),clientContext['executeQueryAsync'](Function[_0x39a3ca(0x197)](this,this['onQuerySucceeded_CreateProjectSite']),Function[_0x39a3ca(0x197)](this,this[_0x39a3ca(0x140)]));}function createSite2(){var _0x59702b=a0_0x17d305,_0x39bb8e=$(_0x59702b(0x17c))[_0x59702b(0x173)](),_0x417693=$('#txtDescription')[_0x59702b(0x173)]();siteUrl=_0x39bb8e['replace'](/\s/g,'');var _0x110ee2=clientContext[_0x59702b(0x125)]()['get_webs'](),_0xf583b4=new SP['WebCreationInformation']();_0xf583b4[_0x59702b(0x171)](_0x39bb8e),_0xf583b4[_0x59702b(0x11b)](_0x417693),_0xf583b4['set_language'](0x409),_0xf583b4['set_url'](siteUrl),_0xf583b4[_0x59702b(0xe8)](!![]),_0xf583b4[_0x59702b(0x17b)](_0x59702b(0x9a)),oNewWebsite=_0x110ee2[_0x59702b(0x158)](_0xf583b4),clientContext[_0x59702b(0x144)](Function[_0x59702b(0x197)](this,onQuerySucceeded_CreateProjectSite),Function[_0x59702b(0x197)](this,this[_0x59702b(0x140)]));}function onQuerySucceeded_CreateProjectSite(){createListItem();}function onQueryFailed_CreateProjectSite(_0x2201c2,_0x24976c){var _0x44daf9=a0_0x17d305;alert(_0x44daf9(0x172)+_0x24976c[_0x44daf9(0xe2)]()+'\x0a'+_0x24976c[_0x44daf9(0x182)]());}function GenerateGUID(){var _0x125f71=a0_0x17d305;return _0x125f71(0xdf)[_0x125f71(0x100)](/[xy]/g,function(_0x5cffa7){var _0x2497a5=_0x125f71,_0x22c4d9=parseFloat('0.'+Math['random']()[_0x2497a5(0xbd)]()[_0x2497a5(0x100)]('0.','')+new Date()[_0x2497a5(0x180)]())*0x10|0x0,_0x51596d=_0x5cffa7=='x'?_0x22c4d9:_0x22c4d9&0x3|0x8;return _0x51596d['toString'](0x10);});}function CheckProjectCodeExistOrNot(_0x3d8cb7,_0x5ebc71){var _0x314aa7=a0_0x17d305,_0x5e3589=titanForWork['getQueryStringParameter'](_0x314aa7(0xfd)),_0x81af3a=_0x314aa7(0xf7),_0x3b3ac4={},_0x56e9ef=![],_0x5f3461='';if(_0x3d8cb7==_0x314aa7(0x147))_0x5f3461=_spPageContextInfo[_0x314aa7(0x113)]+_0x314aa7(0xcb)+_0x5e3589+_0x314aa7(0x146)+_0x5ebc71+'\x27';else _0x3d8cb7=='False'&&(_0x5f3461=_spPageContextInfo[_0x314aa7(0x113)]+_0x314aa7(0xa0)+_0x5ebc71+_0x314aa7(0xdd)+_0x5e3589+'\x27');return $[_0x314aa7(0x162)]({'url':_0x5f3461,'type':_0x81af3a,'data':_0x3b3ac4,'async':![],'headers':{'Accept':_0x314aa7(0x89),'Content-Type':_0x314aa7(0x89),'X-RequestDigest':$(_0x314aa7(0x160))[_0x314aa7(0x173)](),'IF-MATCH':'*','X-HTTP-Method':null},'cache':![],'success':function(_0xfecd88){var _0x4e67ef=_0x314aa7,_0x2b087d,_0x2e5e76=_0xfecd88['d'][_0x4e67ef(0x10d)],_0x2892a1=_0xfecd88['d'][_0x4e67ef(0x10d)]['length'];_0x2892a1>0x0&&(alert('Project\x20code\x20or\x20Project\x20name\x20already\x20exist.'),$(_0x4e67ef(0xd7))[_0x4e67ef(0x173)](''),$(_0x4e67ef(0xd7))[_0x4e67ef(0x92)](),$(_0x4e67ef(0x17c))['val'](''),$(_0x4e67ef(0x17c))[_0x4e67ef(0x92)]());},'error':function(_0x57ba00){var _0x531944=_0x314aa7;Helper[_0x531944(0xcd)]();}}),_0x56e9ef;}function getPeopleUserInfoGroups(_0x1e3e39){var _0x42e29f=a0_0x17d305,_0x27a93d=new Array(),_0x21f617=$('[id^=\x27'+_0x1e3e39+'\x27]'),_0x38780d=SPClientPeoplePicker[_0x42e29f(0x85)][_0x21f617[0x1]['id']],_0x308ac9=_0x38780d[_0x42e29f(0x156)]();if(_0x308ac9[_0x42e29f(0x186)]>0x0)for(var _0x463896=0x0;_0x463896<_0x308ac9[_0x42e29f(0x186)];_0x463896++){_0x27a93d[_0x42e29f(0x9d)](GetUserIdGroups(_0x308ac9[_0x463896][_0x42e29f(0xe9)]));}return _0x27a93d;}function GetUserIdGroups(_0x4dfc41){var _0x40d22d=a0_0x17d305,_0x36c1d6='',_0x3be601=_0x40d22d(0x136),_0x240661=_spPageContextInfo[_0x40d22d(0x143)],_0x4e66a1=_0x4dfc41;return $[_0x40d22d(0x162)]({'url':_0x240661+_0x40d22d(0x15b)+encodeURIComponent(_0x4e66a1)+'\x27','method':_0x40d22d(0xf7),'headers':{'Accept':_0x40d22d(0xe0)},'async':![],'success':function(_0x3eb01b){_0x36c1d6=_0x3eb01b['d']['Id'];},'error':function(_0x215dbb){var _0x3f413e=_0x40d22d;console[_0x3f413e(0x102)](JSON[_0x3f413e(0x95)](_0x215dbb));}}),_0x36c1d6;}function createListItem(){var _0x207f8d=a0_0x17d305,_0x198f3c=new Array();_0x198f3c=getPeopleUserInfoGroups('StackeholderTeamEmployeePicker');if(_0x198f3c[_0x207f8d(0x186)]==0x0){}var _0x11d5dd=new Array();_0x11d5dd=getPeopleUserInfoGroups(_0x207f8d(0x18c));if(_0x11d5dd[_0x207f8d(0x186)]==0x0){}var _0x215e21=$('#txtProjectCode')[_0x207f8d(0x173)](),_0x393544=$(_0x207f8d(0x17c))[_0x207f8d(0x173)](),_0x582a32=$(_0x207f8d(0xef))[_0x207f8d(0x173)](),_0x1b9ca5=$(_0x207f8d(0xcc))[_0x207f8d(0x173)](),_0x4019fc='';_0x1b9ca5!=null&&_0x1b9ca5!=''&&(_0x4019fc=GetDateStandardFormat(_0x1b9ca5));var _0x5aff54=$(_0x207f8d(0xfb))[_0x207f8d(0x173)](),_0x270e5a='';_0x5aff54!=null&&_0x5aff54!=''&&(_0x270e5a=GetDateStandardFormat(_0x5aff54));var _0x13650f=$(_0x207f8d(0x87))[_0x207f8d(0x173)](),_0x415966='';_0x13650f!=null&&_0x13650f!=''&&(_0x415966=GetDateStandardFormat(_0x13650f));txtDepartmentID=$('#departmentDiv')[_0x207f8d(0x18d)]('#departmentDetails')[_0x207f8d(0x173)](),DepartmentFullName=$('#departmentDiv')[_0x207f8d(0x18d)]('select#departmentDetails\x20option:selected')[_0x207f8d(0x9b)](),txtofficeLocationID=$(_0x207f8d(0x183))['find'](_0x207f8d(0x86))[_0x207f8d(0x173)](),OfficeFullName=$(_0x207f8d(0x183))[_0x207f8d(0x18d)](_0x207f8d(0x11c))['text']();var _0x6c742a=getPeopleUserInfoGroups(_0x207f8d(0x14a));if(_0x6c742a[_0x207f8d(0x186)]==0x0)return alert(_0x207f8d(0x16b)),![];_0x6c742a[_0x207f8d(0x186)]==0x1&&(txtManagerTeam=_0x6c742a[0x0]);txtStackeholderTeam=$('#StackeholderTeam')[_0x207f8d(0x18d)](_0x207f8d(0xfa))[_0x207f8d(0x173)](),txtSponsorTeam=$(_0x207f8d(0x103))[_0x207f8d(0x18d)](_0x207f8d(0xfa))[_0x207f8d(0x173)](),txtProjectStatus=$(_0x207f8d(0xf2))[_0x207f8d(0x173)](),txtDomain=$(_0x207f8d(0xd2))[_0x207f8d(0x173)]();var _0x2bb3d8=$('#txtTechnology')[_0x207f8d(0x173)](),_0x3da9f7=$(_0x207f8d(0xbb))[_0x207f8d(0x173)](),_0x30a15e=siteURLProjects+'/'+siteUrl,_0x194912=getConsultantValue();AddNewTak(_0x207f8d(0x15e),_0x215e21,_0x393544,_0x582a32,_0x4019fc,_0x270e5a,_0x415966,txtDepartmentID,DepartmentFullName,txtofficeLocationID,OfficeFullName,txtManagerTeam,txtStackeholderTeam,txtSponsorTeam,txtProjectStatus,_0x2bb3d8,_0x3da9f7,txtDomain,_0x194912,_0x30a15e,_0x198f3c,_0x11d5dd);}function AddNewTak(_0x2aee01,_0x3fe537,_0x2d327d,_0x152f0e,_0x9db275,_0x5c00ee,_0x4aa958,_0x52e97e,_0x45e394,_0xa92b82,_0x4cff0d,_0x3397e6,_0x46e76d,_0x27db0d,_0x2117c5,_0x3d37d9,_0x1b49eb,_0x3c4bb3,_0x1df089,_0x29dbd5,_0x2fc9c6,_0x58bf79){var _0x13ffc8=a0_0x17d305;try{var _0x57ef98=titanForWork[_0x13ffc8(0x112)](_0x13ffc8(0xfd)),_0x2e049c,_0x26a5a5=GetItemTypeForListName(_0x2aee01);_0x2e049c={'__metadata':{'type':_0x26a5a5},'Title':_0x2d327d,'ProjectCode':_0x3fe537,'ProjectName':_0x2d327d,'ProjectDescription':_0x1b49eb,'ProjectSiteURL':_0x29dbd5,'DepartmentId':_0x52e97e,'Department_IDId':_0x52e97e,'ActualStartDate':_0x4aa958,'PlanedStartDate':_0x9db275,'PlanedEndDate':_0x5c00ee,'TechnologyUsed':_0x3d37d9,'Status':_0x2117c5,'DepartmentName':_0x45e394,'ConsultantName':_0x1df089,'ManagerNameId':_0x3397e6,'OfficeLocation':_0x4cff0d,'Domain':_0x3c4bb3,'OfficeLocationID':_0xa92b82,'Office_Location_IdId':_0xa92b82,'CompanyId':_0x57ef98,'MultipleStackeholderId':{'results':_0x2fc9c6},'MultipleSponsorId':{'results':_0x58bf79},'ProjectInternalName':projectInternalName,'ClientIDId':_0x152f0e},(_0x4aa958==null||_0x4aa958=='')&&delete _0x2e049c['ActualStartDate'],(_0x5c00ee==null||_0x5c00ee=='')&&delete _0x2e049c[_0x13ffc8(0xd1)],(_0x9db275==null||_0x9db275=='')&&delete _0x2e049c[_0x13ffc8(0x12b)],AddItemToList(_0x2aee01,_0x2e049c,_0x3397e6,_0x29dbd5,_0x9db275,_0x5c00ee);}catch(_0x119f58){console[_0x13ffc8(0x102)](_0x119f58[_0x13ffc8(0x16f)]);}}function AddItemToList(_0x451c1b,_0x37bb37,_0x1b228a,_0x34ebb8,_0x28d7c2,_0x4e9cb0){var _0x455870=a0_0x17d305,_0x35f375=$[_0x455870(0x185)]();return $[_0x455870(0x162)]({'url':_spPageContextInfo[_0x455870(0x113)]+_0x455870(0x130)+_0x451c1b+_0x455870(0x135),'type':_0x455870(0x8a),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x455870(0x173)](),'content-Type':_0x455870(0x89)},'data':JSON[_0x455870(0x95)](_0x37bb37),'success':function(_0x4533ca){var _0x3b7b8c=_0x455870,_0x22bce6=_0x4533ca['d']['ID'],_0x20f86e='';_0x4533ca['d'][_0x3b7b8c(0xa5)]==null||_0x4533ca['d'][_0x3b7b8c(0xa5)]==''?_0x20f86e=items[0x0]['ProjectName']:_0x20f86e=_0x4533ca['d']['ProjectInternalName'],_0x35f375['resolve'](_0x4533ca),console['log']('User\x20has\x20been\x20assigned\x20permission.'),alert(_0x3b7b8c(0xc9)),waitingDialog['hide'](),$['when'](BreakInheritePermissionDMSLibrary(_0x1b228a,_0x3b7b8c(0x175),_0x20f86e))['done'](function(_0x4c5a84){AddProjectManagerAsADefaultMemeber(_0x1b228a,_0x28d7c2,_0x4e9cb0,parseInt(_0x22bce6)),GetTaskEmailTemplate(0x6),GetProjectDetails(_0x22bce6),SendTaskEmail(),RedirectToListViewPage();});},'error':function(_0x122ea3){var _0x23e065=_0x455870;console['log'](JSON[_0x23e065(0x95)](_0x122ea3)),_0x35f375[_0x23e065(0x18b)](_0x122ea3);}}),_0x35f375['promise']();}function AddProjectManagerAsADefaultMemeber(_0x43bb94,_0x5b5749,_0x528a4b,_0x5aefb0){var _0x3c3c80=a0_0x17d305,_0x355e2d=$[_0x3c3c80(0x185)](),_0x1b4c48=_0x3c3c80(0xde),_0x5ae281=CreateMetadataForAddingProjectManager(_0x1b4c48,_0x43bb94,_0x5b5749,_0x528a4b,_0x5aefb0),_0x470806=_spPageContextInfo[_0x3c3c80(0x113)]+'/_api/web/lists/getbytitle(\x27'+_0x1b4c48+_0x3c3c80(0x135),_0xeb74d1={'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x3c3c80(0x160))[_0x3c3c80(0x173)](),'content-Type':_0x3c3c80(0x89)};return $[_0x3c3c80(0x162)]({'url':_0x470806,'type':_0x3c3c80(0x8a),'async':![],'headers':_0xeb74d1,'data':JSON['stringify'](_0x5ae281),'success':function(_0x47b3b2){var _0xa7ddfd=_0x3c3c80;console[_0xa7ddfd(0x102)](_0xa7ddfd(0xe7));},'error':function(_0x2ec43f){var _0x3e0214=_0x3c3c80;console[_0x3e0214(0x102)](data),_0x355e2d[_0x3e0214(0x18b)](_0x2ec43f);}}),_0x355e2d[_0x3c3c80(0x145)]();}function CreateMetadataForAddingProjectManager(_0x42eddc,_0x593e9b,_0x414827,_0xa845f3,_0x3ff6c6,_0x34c579){var _0x36360c=a0_0x17d305,_0x652d1e=GetItemTypeForListName(_0x42eddc),_0x21ff55;return _0x21ff55={'__metadata':{'type':_0x652d1e}},_0x21ff55['ProjectId']=_0x3ff6c6,_0x21ff55['TeamMemberId']=_0x593e9b,_0x21ff55[_0x36360c(0xf5)]=_0x36360c(0x10e),_0x21ff55[_0x36360c(0x15f)]=_0x414827,_0x21ff55['ExpectedReleseDate']=_0xa845f3,_0x21ff55[_0x36360c(0x119)]=!![],_0x21ff55[_0x36360c(0x105)]=!![],_0x21ff55[_0x36360c(0x116)]=!![],_0x21ff55['CompanyId']=titanForWork[_0x36360c(0x112)]('CompanyId'),_0x21ff55;}function addManagerToSiteAdmin(_0x4c01a9,_0x42535f,_0x5a8766){var _0x2bfb99=a0_0x17d305,_0x213d17={'Accept':_0x2bfb99(0x89),'content-Type':_0x2bfb99(0x89),'X-RequestDigest':jQuery(_0x2bfb99(0x160))[_0x2bfb99(0x173)]()},_0x35783d=_0x42535f+_0x2bfb99(0xd3)+_0x4c01a9+',roleDefId='+_0x5a8766+')';$[_0x2bfb99(0x162)]({'url':_0x35783d,'type':_0x2bfb99(0x8a),'headers':_0x213d17,'dataType':_0x2bfb99(0xff),'async':![],'success':function(_0x2fbed7){var _0x18dcd2=_0x2bfb99;console['log'](_0x18dcd2(0xb7)),alert(_0x18dcd2(0x14f)),waitingDialog[_0x18dcd2(0x8d)](),RedirectToListViewPage();},'error':function(_0x4b6534){var _0x1da5ce=_0x2bfb99;console[_0x1da5ce(0x102)](JSON[_0x1da5ce(0x95)](_0x4b6534));}});}function GetItemTypeForListName(_0x3886d5){var _0x2edf09=a0_0x17d305;return _0x2edf09(0x161)+_0x3886d5[_0x2edf09(0x83)](0x0)[_0x2edf09(0x88)]()+_0x3886d5[_0x2edf09(0xd4)]('\x20')[_0x2edf09(0x184)]('')['slice'](0x1)+_0x2edf09(0x107);}function GetDateStandardFormat(_0x456488){var _0x604eb=a0_0x17d305,_0x3c0e4d=ConvertDateFormatToddMMyyyy(_0x456488),_0x2cf86a=new Date(_0x3c0e4d),_0x3891fd=0x3c*0x3c*0x18*0x3e8,_0xe5ac6b=new Date(_0x2cf86a[_0x604eb(0x180)]()),_0x2cd088=_0xe5ac6b[_0x604eb(0x82)]();return _0x2cd088;}function ConvertDateFormatToddMMyyyy(_0x378766){var _0x431dbe=a0_0x17d305,_0xfd9676=stringToDate(_0x378766,_0x431dbe(0x10b),'/');return _0xfd9676;}function stringToDate(_0x40e3e7,_0x1d6880,_0x1e37c7){var _0x210684=a0_0x17d305,_0xbb4296=_0x1d6880[_0x210684(0x194)](),_0xa322c4=_0xbb4296[_0x210684(0xd4)](_0x1e37c7),_0x4c905b=_0x40e3e7['split'](_0x1e37c7),_0x2665f1=_0xa322c4[_0x210684(0xa8)]('mm'),_0x13f36b=_0xa322c4['indexOf']('dd'),_0x263c8f=_0xa322c4[_0x210684(0xa8)](_0x210684(0x174)),_0x1a5340=parseInt(_0x4c905b[_0x2665f1]);_0x1a5340-=0x1;var _0x564eb3=new Date(_0x4c905b[_0x263c8f],_0x1a5340,_0x4c905b[_0x13f36b]);return _0x564eb3;}function RedirectToListViewPage(){var _0x1b41b1=a0_0x17d305;companyID=titanForWork[_0x1b41b1(0x112)](_0x1b41b1(0xfd)),location[_0x1b41b1(0x132)]=_spPageContextInfo[_0x1b41b1(0x113)]+_0x1b41b1(0xc7)+companyID;}function InitializePeoplePicker(_0x6faef2,_0x4e4292){var _0x35f629=a0_0x17d305;_0x4e4292==null&&(_0x4e4292=![]);var _0x114f09={};_0x114f09['PrincipalAccountType']=_0x35f629(0xaa),_0x114f09[_0x35f629(0x91)]=0xf,_0x114f09['ResolvePrincipalSource']=0xf,_0x114f09['AllowMultipleValues']=_0x4e4292,_0x114f09[_0x35f629(0x151)]=0x32,_0x114f09[_0x35f629(0x108)]=_0x35f629(0xc5),SPClientPeoplePicker_InitStandaloneControlWrapper(_0x6faef2,null,_0x114f09);}function GetProjectDetails(_0x520451){var _0x260641=a0_0x17d305;projectManage=[],StakeHolders=[],ProjectSponsors=[],projectItemDetails=[];var _0x7bb855=_spPageContextInfo[_0x260641(0x113)]+_0x260641(0x196)+_0x520451+'\x27';$[_0x260641(0x162)]({'url':_0x7bb855,'method':_0x260641(0xf7),'headers':{'Accept':_0x260641(0xe0)},'async':![],'success':function(_0x285adc){var _0x231887=_0x260641,_0x49cb88=_0x285adc,_0x4f4e95='';for(var _0x343d76=0x0;_0x343d76<_0x49cb88['d'][_0x231887(0x10d)][_0x231887(0x186)];_0x343d76++){_0x49cb88['d'][_0x231887(0x10d)][_0x343d76][_0x231887(0x142)]!=null&&(projectManage[_0x231887(0x9d)](_0x49cb88['d'][_0x231887(0x10d)][_0x343d76][_0x231887(0x142)][_0x231887(0x13a)]),projecttouser+=_0x49cb88['d'][_0x231887(0x10d)][_0x343d76][_0x231887(0x142)][_0x231887(0xc2)]+',',projecttouser=projecttouser[_0x231887(0x100)](/,(\s+)?$/,''));if(_0x49cb88['d'][_0x231887(0x10d)][_0x343d76][_0x231887(0x165)][_0x231887(0x10d)]!=null){for(var _0x5cc2b1=0x0;_0x5cc2b1<_0x49cb88['d'][_0x231887(0x10d)][_0x343d76][_0x231887(0x165)][_0x231887(0x10d)][_0x231887(0x186)];_0x5cc2b1++){StakeHolders[_0x231887(0x9d)](_0x49cb88['d'][_0x231887(0x10d)][_0x343d76][_0x231887(0x165)][_0x231887(0x10d)][_0x5cc2b1][_0x231887(0x13a)]),stackToUsers+=_0x49cb88['d'][_0x231887(0x10d)][_0x343d76]['MultipleStackeholder'][_0x231887(0x10d)][_0x5cc2b1][_0x231887(0xc2)]+',';}stackToUsers=stackToUsers[_0x231887(0x100)](/,(\s+)?$/,'');}if(_0x49cb88['d'][_0x231887(0x10d)][_0x343d76][_0x231887(0x124)][_0x231887(0x10d)]!=null){for(var _0x5cc2b1=0x0;_0x5cc2b1<_0x49cb88['d'][_0x231887(0x10d)][_0x343d76][_0x231887(0x124)]['results']['length'];_0x5cc2b1++){ProjectSponsors[_0x231887(0x9d)](_0x49cb88['d'][_0x231887(0x10d)][_0x343d76][_0x231887(0x124)]['results'][_0x5cc2b1]['UserName']),sponsorToUsers+=_0x49cb88['d'][_0x231887(0x10d)][_0x343d76]['MultipleSponsor']['results'][_0x5cc2b1][_0x231887(0xc2)]+',';}sponsorToUsers=sponsorToUsers[_0x231887(0x100)](/,(\s+)?$/,'');}alluser=StakeHolders[_0x231887(0x17a)](ProjectSponsors,projectManage),projectItemDetails[_0x231887(0x9d)](TaskMetadata(_0x49cb88['d'][_0x231887(0x10d)][_0x343d76],projecttouser,stackToUsers,sponsorToUsers));}},'error':function(_0x196c25){var _0x773b7d=_0x260641;console['log'](JSON[_0x773b7d(0x95)](_0x196c25));}});}function GetTaskEmailTemplate(_0x26384f){var _0x34c9e3=a0_0x17d305,_0x58606b=_spPageContextInfo[_0x34c9e3(0x143)]+_0x34c9e3(0x195)+_0x26384f+'\x27';$[_0x34c9e3(0x162)]({'url':_0x58606b,'headers':{'accept':'application/json;odata=verbose','content-type':'application/json;odata=verbose','X-RequestDigest':$(_0x34c9e3(0x160))[_0x34c9e3(0x173)]()},'async':![],'success':function(_0x4fd40f){var _0x22509c=_0x34c9e3,_0x7b30a7=_0x4fd40f['d'][_0x22509c(0x10d)];for(var _0x2eed69=0x0;_0x2eed69<_0x7b30a7[_0x22509c(0x186)];_0x2eed69++){_0x7b30a7[_0x2eed69]['Body']!=null&&(emailBodyContent=_0x7b30a7[_0x2eed69]['Body']),_0x7b30a7[_0x2eed69][_0x22509c(0xb5)]!=null&&(taskEmailSubject=_0x7b30a7[_0x2eed69][_0x22509c(0xb5)]);}},'eror':function(_0x50fdc8){var _0x5cdada=_0x34c9e3;console['log'](_0x5cdada(0x114));}});}function SendTaskEmail(){var _0x22f105=a0_0x17d305,_0x35fd45=emailBodyContent,_0x5bff85=taskEmailSubject;projectItemDetails[_0x22f105(0x97)](function(_0x4650f0){var _0x43dfdf=_0x22f105;_0x35fd45=_0x35fd45[_0x43dfdf(0x100)](_0x43dfdf(0x193),_0x4650f0[_0x43dfdf(0xf3)]),_0x35fd45=_0x35fd45[_0x43dfdf(0x100)](_0x43dfdf(0x11a),_0x4650f0[_0x43dfdf(0xba)]),_0x35fd45=_0x35fd45[_0x43dfdf(0x100)](_0x43dfdf(0xac),_0x4650f0['ProjectName']),_0x35fd45=_0x35fd45[_0x43dfdf(0x100)](_0x43dfdf(0x12e),_0x4650f0['ClientName']),_0x4650f0[_0x43dfdf(0x121)]=='-Select-'?_0x35fd45=_0x35fd45[_0x43dfdf(0x100)](_0x43dfdf(0xd6),''):_0x35fd45=_0x35fd45['replace'](_0x43dfdf(0xd6),_0x4650f0[_0x43dfdf(0x121)]),_0x4650f0[_0x43dfdf(0x16e)]==_0x43dfdf(0x10c)?_0x35fd45=_0x35fd45[_0x43dfdf(0x100)](_0x43dfdf(0xd0),''):_0x35fd45=_0x35fd45['replace'](_0x43dfdf(0xd0),_0x4650f0[_0x43dfdf(0x16e)]),_0x35fd45=_0x35fd45[_0x43dfdf(0x100)](_0x43dfdf(0x129),_0x4650f0[_0x43dfdf(0x12b)]),_0x35fd45=_0x35fd45[_0x43dfdf(0x100)](_0x43dfdf(0xd8),_0x4650f0['PlanedEndDate']),_0x35fd45=_0x35fd45['replace'](_0x43dfdf(0x190),_spPageContextInfo[_0x43dfdf(0x113)]+'/Pages/ViewProjectDetails.aspx?WebAppId='+companyID+_0x43dfdf(0xb8)+_0x4650f0['ID']+_0x43dfdf(0xf8)+_0x4650f0[_0x43dfdf(0xca)]+'');});var _0x26b028=_spPageContextInfo[_0x22f105(0xbf)],_0xe98a11;_0xe98a11={'properties':{'__metadata':{'type':_0x22f105(0x126)},'From':_0x26b028,'To':{'results':alluser},'Body':_0x35fd45,'Subject':_0x5bff85}};var _0x4e5e5b=_spPageContextInfo[_0x22f105(0x9f)]+'/_api/SP.Utilities.Utility.SendEmail';$[_0x22f105(0x162)]({'contentType':'application/json','url':_0x4e5e5b,'type':'POST','data':JSON[_0x22f105(0x95)](_0xe98a11),'async':![],'headers':{'Accept':'application/json;odata=verbose','content-type':_0x22f105(0x89),'X-RequestDigest':$(_0x22f105(0x160))['val']()},'success':function(_0x31245a){var _0x5e50cf=_0x22f105;console[_0x5e50cf(0x102)](_0x5e50cf(0xdc));},'error':function(_0x68998f){var _0x787a3d=_0x22f105;waitingDialog[_0x787a3d(0x8d)](),console['log'](_0x787a3d(0xee)+JSON[_0x787a3d(0x95)](_0x68998f));}});}function TaskMetadata(_0x39f8a0,_0x5e2917,_0x5fba66,_0x39b5de){var _0x379d1d=a0_0x17d305,_0x267123={};return _0x267123[_0x379d1d(0xca)]=_0x39f8a0['ProjectName']==null?'':_0x39f8a0[_0x379d1d(0xca)],_0x267123['ClientName']=_0x39f8a0[_0x379d1d(0x123)]==null?'':_0x39f8a0[_0x379d1d(0x123)],_0x267123['DepartmentName']=_0x39f8a0[_0x379d1d(0x121)]==null?'':_0x39f8a0[_0x379d1d(0x121)],_0x267123[_0x379d1d(0xba)]=_0x39f8a0[_0x379d1d(0xba)]==null?'':_0x39f8a0[_0x379d1d(0xba)],_0x267123[_0x379d1d(0x16e)]=_0x39f8a0[_0x379d1d(0x16e)]==null?'':_0x39f8a0[_0x379d1d(0x16e)],_0x267123['ID']=_0x39f8a0[_0x379d1d(0x16e)]==null?'':_0x39f8a0['ID'],_0x267123[_0x379d1d(0x134)]=_0x39f8a0['ProjectSiteURL'],_0x267123[_0x379d1d(0xf3)]=_0x5e2917,_0x267123['stackToUsers']=_0x5fba66,_0x267123[_0x379d1d(0xa7)]=_0x39b5de,_0x267123[_0x379d1d(0x12b)]=_0x39f8a0[_0x379d1d(0x12b)],_0x267123[_0x379d1d(0x12b)]=new Date(_0x267123[_0x379d1d(0x12b)]),_0x267123['PlanedStartDate']=$[_0x379d1d(0x11d)][_0x379d1d(0x16d)](_0x379d1d(0xce),_0x267123[_0x379d1d(0x12b)]),_0x267123[_0x379d1d(0xd1)]=_0x39f8a0['PlanedEndDate'],_0x267123['PlanedEndDate']=new Date(_0x267123[_0x379d1d(0xd1)]),_0x267123[_0x379d1d(0xd1)]=$[_0x379d1d(0x11d)][_0x379d1d(0x16d)](_0x379d1d(0xce),_0x267123[_0x379d1d(0xd1)]),_0x267123;}function getProjectRights(){var _0x151447=a0_0x17d305,_0x510f96=$[_0x151447(0x185)](),_0x2552b1,_0x1db6df=_0x151447(0x120),_0x1bf0ab=titanForWork[_0x151447(0x112)](_0x151447(0xfd)),_0x6b1267=_spPageContextInfo[_0x151447(0x113)]+_0x151447(0x130)+_0x1db6df+_0x151447(0x169)+_0x1bf0ab+_0x151447(0xb1)+_spPageContextInfo[_0x151447(0x12a)]+'\x27\x20and\x20WebPartName\x20eq\x20\x27Project\x20Admin\x27';return $[_0x151447(0x162)]({'url':_0x6b1267,'headers':{'Accept':_0x151447(0x89)},'async':!![],'success':function(_0x5a37a3){var _0x18141f=_0x151447,_0x209c0b=_0x5a37a3['d']['results'];_0x209c0b[_0x18141f(0x186)]>0x0?(_0x510f96[_0x18141f(0xb4)](!![]),IsProjectAdmin=!![]):(_0x510f96[_0x18141f(0xb4)](![]),IsProjectAdmin=![]);},'eror':function(_0x46469b){var _0x242248=_0x151447;console[_0x242248(0x102)]($(_0x242248(0x17d))[_0x242248(0x173)]());}}),_0x510f96['promise']();}function IsMangerActive(_0xf98dbf){var _0x219203=a0_0x17d305,_0x5a960e=titanForWork[_0x219203(0x112)](_0x219203(0xfd)),_0x31f0af='';return RestQuery=_0x219203(0x187)+_0x5a960e+_0x219203(0x8b)+_0xf98dbf+'',$[_0x219203(0xf9)](CommonFunction[_0x219203(0xc8)]('Employees',RestQuery))[_0x219203(0xe1)](function(_0xa10baf){var _0x34777f=_0x219203;try{_0xa10baf[_0x34777f(0x10d)][_0x34777f(0x186)]>0x0?_0x31f0af=_0xa10baf[_0x34777f(0x10d)][0x0]['ID']:_0x31f0af=![];}catch(_0x467833){alert(_0x467833);}}),_0x31f0af;}function BreakInheritePermissionDMSLibrary(_0x19e175,_0xcd3be3,_0x890063){var _0x5cc0c1=a0_0x17d305,_0x45cbdf=titanForWork['getQueryStringParameter'](_0x5cc0c1(0x138))+_0x5cc0c1(0x8f)+_0x890063,_0x307796={'Accept':_0x5cc0c1(0x89),'content-Type':_0x5cc0c1(0x89),'X-RequestDigest':jQuery(_0x5cc0c1(0x160))[_0x5cc0c1(0x173)]()},_0x255b0b=_0x45cbdf+_0x5cc0c1(0x192);$['ajax']({'url':_0x255b0b,'type':_0x5cc0c1(0x8a),'headers':_0x307796,'async':![],'dataType':_0x5cc0c1(0xff),'success':function(_0x3d5f64){var _0x44da4d=_0x5cc0c1;console['log'](_0x44da4d(0x17f)),$['when'](AssignPermissiononDMSLibary(_0x19e175,_0xcd3be3,_0x890063))[_0x44da4d(0xe1)](function(_0x43fb8e){var _0x51d939=_0x44da4d;console[_0x51d939(0x102)](_0x51d939(0x191));});},'error':function(_0x103292){var _0x53f1be=_0x5cc0c1;console[_0x53f1be(0x102)](JSON[_0x53f1be(0x95)](_0x103292));}});}function AssignPermissiononDMSLibary(_0x1e69db,_0x345632,_0x39d855){var _0x44a336=a0_0x17d305,_0x4232bd=titanForWork[_0x44a336(0x112)](_0x44a336(0x138))+_0x44a336(0x8f)+_0x39d855,_0x3b872b={'Accept':'application/json;odata=verbose','content-Type':_0x44a336(0x89),'X-RequestDigest':jQuery(_0x44a336(0x160))[_0x44a336(0x173)]()},_0x37ecb9=_0x4232bd+_0x44a336(0x188)+_0x1e69db+_0x44a336(0xeb)+_0x345632+')';$['ajax']({'url':_0x37ecb9,'type':_0x44a336(0x8a),'headers':_0x3b872b,'dataType':'json','async':![],'success':function(_0x4e8b9e){console['log']('User\x20has\x20been\x20assigned\x20permission\x20.');},'error':function(_0x2a18f2){console['log'](JSON['stringify'](_0x2a18f2));}});}function AddUserToOwnerGroup(_0x189d63){var _0x597db1=a0_0x17d305;debugger;var _0x59e7d8={'__metadata':{'type':_0x597db1(0x11e)},'LoginName':_0x189d63},_0x204c0c=_spPageContextInfo[_0x597db1(0x113)]+_0x597db1(0xe5);$[_0x597db1(0x162)]({'url':_0x204c0c,'type':_0x597db1(0x8a),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x597db1(0x160))['val'](),'content-Type':_0x597db1(0x89)},'data':JSON['stringify'](_0x59e7d8),'success':function(_0x1a755b){debugger;},'error':function(_0x1ee717){}});}function IsDepartmentAdmin(){var _0x1ed347=a0_0x17d305,_0x283e27=titanForWork[_0x1ed347(0x112)](_0x1ed347(0xfd)),_0x36e4b5=Logged_DepartmentId,_0x120ee6=_0x1ed347(0x120),_0x1f4b1c=_spPageContextInfo[_0x1ed347(0x113)]+'/_api/web/lists/getbytitle(\x27'+_0x120ee6+_0x1ed347(0xab)+_0x283e27+'\x27\x20and\x20ContributorsId\x20eq\x20\x27'+_spPageContextInfo[_0x1ed347(0x12a)]+'\x27\x20and\x20Department/ID\x20eq\x20\x27'+_0x36e4b5+_0x1ed347(0x12d);return $[_0x1ed347(0x162)]({'url':_0x1f4b1c,'type':_0x1ed347(0x16a),'headers':{'Accept':_0x1ed347(0x89)},'async':![],'success':function(_0x357d88){var _0x4a429d=_0x1ed347,_0x1263ee=_0x357d88['d'][_0x4a429d(0x10d)];_0x1263ee[_0x4a429d(0x186)]>0x0?IsdeptAdmin=!![]:IsdeptAdmin=![];},'error':function(_0xb4095a){var _0x51ffe1=_0x1ed347;console[_0x51ffe1(0x102)](_0xb4095a[_0x51ffe1(0xe6)]);}}),IsdeptAdmin;}function bindProjectType(){var _0x5baaaa=a0_0x17d305;$(_0x5baaaa(0xf6))[_0x5baaaa(0x166)]();var _0x24adde=_spPageContextInfo[_0x5baaaa(0x113)]+_0x5baaaa(0xc6);$[_0x5baaaa(0x162)]({'url':_0x24adde,'headers':{'Accept':'application/json;odata=verbose'},'async':!![],'success':function(_0x5e74f6){var _0x11b007=_0x5baaaa;$(_0x11b007(0xa4))[_0x11b007(0xc4)](_0x11b007(0xf6));for(var _0x5d6f44=0x0;_0x5d6f44<_0x5e74f6['d'][_0x11b007(0x10d)][_0x11b007(0x186)];_0x5d6f44++){$(_0x11b007(0xf6))[_0x11b007(0x93)](_0x11b007(0x13f)+_0x5e74f6['d'][_0x11b007(0x10d)][_0x5d6f44][_0x11b007(0x14e)]+'\x22>'+_0x5e74f6['d']['results'][_0x5d6f44][_0x11b007(0x14e)]+_0x11b007(0x189));}},'myError':function(_0x2267a7){}});}