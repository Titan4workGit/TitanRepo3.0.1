const a0_0x1c4e58=a0_0x5938;function a0_0x18a3(){const _0x34d289=['1290934HqEKsj','execute','get','18XZqCgU','statusCode','createResponse','length','client-request-id','Strict-Transport-Security','responseBody','getOptions','setStatusCode','3108895YYJLgt','toString','getRelativeURL','createResponseHeaders','request-id','test','exec','2966502tUUwNN','Cache-Control','7243568RBzErq','assign','chaosStrategy','8466990KGGljW','append','sendRequest','1800822CHGapi','headers','manualMap','forEach','method','4isHFaz','getRandomStatusCode','setNext','2010608fEuYtV','undefined','string','getMiddlewareOptions','middlewareControl','createResponseBody','options','floor','request','response','nextMiddleware','Date'];a0_0x18a3=function(){return _0x34d289;};return a0_0x18a3();}(function(_0x287452,_0x6ada30){const _0x44f0b5=a0_0x5938,_0x213a1e=_0x287452();while(!![]){try{const _0x58cd53=-parseInt(_0x44f0b5(0xb1))/0x1+-parseInt(_0x44f0b5(0xa5))/0x2+-parseInt(_0x44f0b5(0x95))/0x3+parseInt(_0x44f0b5(0xa2))/0x4*(parseInt(_0x44f0b5(0x8e))/0x5)+parseInt(_0x44f0b5(0x9d))/0x6+parseInt(_0x44f0b5(0x9a))/0x7+-parseInt(_0x44f0b5(0x97))/0x8*(-parseInt(_0x44f0b5(0xb4))/0x9);if(_0x58cd53===_0x6ada30)break;else _0x213a1e['push'](_0x213a1e['shift']());}catch(_0x3dbb48){_0x213a1e['push'](_0x213a1e['shift']());}}}(a0_0x18a3,0xa079a));import{__awaiter}from'tslib';import{MiddlewareControl}from'./MiddlewareControl';function a0_0x5938(_0x346f82,_0x366b03){const _0x18a354=a0_0x18a3();return a0_0x5938=function(_0x593806,_0x4ba012){_0x593806=_0x593806-0x8d;let _0x2ec8c8=_0x18a354[_0x593806];return _0x2ec8c8;},a0_0x5938(_0x346f82,_0x366b03);}import{generateUUID}from'./MiddlewareUtil';import{httpStatusCode,methodStatusCode}from'./options/ChaosHandlerData';import{ChaosHandlerOptions}from'./options/ChaosHandlerOptions';import{ChaosStrategy}from'./options/ChaosStrategy';export class ChaosHandler{constructor(_0x11bd70=new ChaosHandlerOptions(),_0x24011d){const _0x4bc68e=a0_0x5938;this[_0x4bc68e(0xab)]=_0x11bd70,this[_0x4bc68e(0x9f)]=_0x24011d;}[a0_0x1c4e58(0x91)](_0x353ec0,_0x81c30d,_0x47a5a0){const _0xe41adc=a0_0x1c4e58,_0x178a94=_0x353ec0[_0xe41adc(0x9e)]?new Headers(_0x353ec0['headers']):new Headers();return _0x178a94[_0xe41adc(0x9b)](_0xe41adc(0x96),'no-store'),_0x178a94[_0xe41adc(0x9b)](_0xe41adc(0x92),_0x81c30d),_0x178a94[_0xe41adc(0x9b)](_0xe41adc(0xb8),_0x81c30d),_0x178a94[_0xe41adc(0x9b)]('x-ms-ags-diagnostic',''),_0x178a94[_0xe41adc(0x9b)](_0xe41adc(0xb0),_0x47a5a0),_0x178a94['append'](_0xe41adc(0xb9),''),_0x353ec0[_0xe41adc(0xb5)]===0x1ad&&_0x178a94[_0xe41adc(0x9b)]('retry-after','3'),_0x178a94;}[a0_0x1c4e58(0xaa)](_0x7931bf,_0x306260,_0x12d510){const _0x216649=a0_0x1c4e58;if(_0x7931bf[_0x216649(0xba)])return _0x7931bf[_0x216649(0xba)];let _0x2945a1;if(_0x7931bf[_0x216649(0xb5)]>=0x190){const _0x331cb3=httpStatusCode[_0x7931bf[_0x216649(0xb5)]],_0x52607e=_0x7931bf['statusMessage'];_0x2945a1={'error':{'code':_0x331cb3,'message':_0x52607e,'innerError':{'request-id':_0x306260,'date':_0x12d510}}};}else _0x2945a1={};return _0x2945a1;}[a0_0x1c4e58(0xb6)](_0x3e46fd,_0x2a8809){const _0x50a602=a0_0x1c4e58,_0x86598e=_0x2a8809[_0x50a602(0xad)],_0x438502=generateUUID(),_0x88dde3=new Date(),_0x276f00=this[_0x50a602(0x91)](_0x3e46fd,_0x438502,_0x88dde3[_0x50a602(0x8f)]()),_0x3579fa=this['createResponseBody'](_0x3e46fd,_0x438502,_0x88dde3[_0x50a602(0x8f)]()),_0x18a93a={'url':_0x86598e,'status':_0x3e46fd[_0x50a602(0xb5)],'statusText':_0x3e46fd['statusMessage'],'headers':_0x276f00};_0x2a8809[_0x50a602(0xae)]=new Response(typeof _0x3579fa===_0x50a602(0xa7)?_0x3579fa:JSON['stringify'](_0x3579fa),_0x18a93a);}[a0_0x1c4e58(0x9c)](_0x4b9101,_0x1090d6){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3d6baa=a0_0x5938;this[_0x3d6baa(0x8d)](_0x4b9101,_0x1090d6[_0x3d6baa(0xad)],_0x1090d6[_0x3d6baa(0xab)][_0x3d6baa(0xa1)]);if(_0x4b9101[_0x3d6baa(0x99)]===ChaosStrategy['MANUAL']&&!this[_0x3d6baa(0xaf)]||Math[_0x3d6baa(0xac)](Math['random']()*0x64)<_0x4b9101['chaosPercentage'])this['createResponse'](_0x4b9101,_0x1090d6);else this[_0x3d6baa(0xaf)]&&(yield this[_0x3d6baa(0xaf)][_0x3d6baa(0xb2)](_0x1090d6));});}[a0_0x1c4e58(0xa3)](_0x5ebf3d){const _0x450217=a0_0x1c4e58,_0x19da46=methodStatusCode[_0x5ebf3d];return _0x19da46[Math[_0x450217(0xac)](Math['random']()*_0x19da46[_0x450217(0xb7)])];}[a0_0x1c4e58(0x90)](_0x356bf4){const _0x4d21c8=a0_0x1c4e58,_0x22719b=/https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;let _0x3a82f0;return _0x22719b['exec'](_0x356bf4)!==null&&(_0x3a82f0=_0x22719b[_0x4d21c8(0x94)](_0x356bf4)[0x1]),_0x3a82f0;}[a0_0x1c4e58(0x8d)](_0xa620c7,_0x124536,_0x558b13){const _0x41aa24=a0_0x1c4e58;if(_0xa620c7[_0x41aa24(0x99)]===ChaosStrategy['MANUAL']){if(_0xa620c7[_0x41aa24(0xb5)]===undefined){const _0x38668e=this[_0x41aa24(0x90)](_0x124536);this[_0x41aa24(0x9f)]['get'](_0x38668e)!==undefined?this[_0x41aa24(0x9f)][_0x41aa24(0xb3)](_0x38668e)[_0x41aa24(0xb3)](_0x558b13)!==undefined&&(_0xa620c7[_0x41aa24(0xb5)]=this[_0x41aa24(0x9f)][_0x41aa24(0xb3)](_0x38668e)['get'](_0x558b13)):this[_0x41aa24(0x9f)][_0x41aa24(0xa0)]((_0x3212c6,_0x2755cf)=>{const _0x1bbcce=_0x41aa24,_0x374575=new RegExp(_0x2755cf+'$');_0x374575[_0x1bbcce(0x93)](_0x38668e)&&(this[_0x1bbcce(0x9f)][_0x1bbcce(0xb3)](_0x2755cf)[_0x1bbcce(0xb3)](_0x558b13)!==undefined&&(_0xa620c7[_0x1bbcce(0xb5)]=this[_0x1bbcce(0x9f)][_0x1bbcce(0xb3)](_0x2755cf)[_0x1bbcce(0xb3)](_0x558b13)));});}}else _0xa620c7[_0x41aa24(0xb5)]=this[_0x41aa24(0xa3)](_0x558b13);}[a0_0x1c4e58(0xbb)](_0x4c1241){const _0x2ba2c5=a0_0x1c4e58;let _0x139414;return _0x4c1241[_0x2ba2c5(0xa9)]instanceof MiddlewareControl&&(_0x139414=_0x4c1241[_0x2ba2c5(0xa9)][_0x2ba2c5(0xa8)](ChaosHandlerOptions)),typeof _0x139414===_0x2ba2c5(0xa6)&&(_0x139414=Object[_0x2ba2c5(0x98)](new ChaosHandlerOptions(),this[_0x2ba2c5(0xab)])),_0x139414;}[a0_0x1c4e58(0xb2)](_0x42c0b5){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2a641c=a0_0x5938,_0x5da758=this[_0x2a641c(0xbb)](_0x42c0b5);return yield this[_0x2a641c(0x9c)](_0x5da758,_0x42c0b5);});}[a0_0x1c4e58(0xa4)](_0x1fd788){const _0x57a41d=a0_0x1c4e58;this[_0x57a41d(0xaf)]=_0x1fd788;}}