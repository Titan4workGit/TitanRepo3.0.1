'use strict';var a0_0x370689=a0_0x3c15;(function(_0x57b2f3,_0x582b90){var _0x126017=a0_0x3c15,_0x442f2f=_0x57b2f3();while(!![]){try{var _0x170fb5=-parseInt(_0x126017(0x164))/0x1+parseInt(_0x126017(0x183))/0x2+parseInt(_0x126017(0x1a1))/0x3+-parseInt(_0x126017(0x15e))/0x4*(-parseInt(_0x126017(0x1a7))/0x5)+parseInt(_0x126017(0x1aa))/0x6+-parseInt(_0x126017(0x16d))/0x7+-parseInt(_0x126017(0x160))/0x8;if(_0x170fb5===_0x582b90)break;else _0x442f2f['push'](_0x442f2f['shift']());}catch(_0x4585c8){_0x442f2f['push'](_0x442f2f['shift']());}}}(a0_0x3bdc,0x386df));function a0_0x3c15(_0x11fffd,_0x5209a6){var _0x3bdcbd=a0_0x3bdc();return a0_0x3c15=function(_0x3c1537,_0x3d0832){_0x3c1537=_0x3c1537-0x15d;var _0x56fa8c=_0x3bdcbd[_0x3c1537];return _0x56fa8c;},a0_0x3c15(_0x11fffd,_0x5209a6);}Object['defineProperty'](exports,a0_0x370689(0x17d),{'value':!![]}),exports['LargeFileUploadTask']=void 0x0;var tslib_1=require(a0_0x370689(0x18b)),GraphClientError_1=require(a0_0x370689(0x17a)),GraphResponseHandler_1=require(a0_0x370689(0x16c)),ResponseType_1=require(a0_0x370689(0x175)),Range_1=require(a0_0x370689(0x196)),UploadResult_1=require(a0_0x370689(0x1ab)),LargeFileUploadTask=(function(){var _0x24bbbd=a0_0x370689;function _0x53d04f(_0xcba61c,_0x3a999b,_0x9037f2,_0x2335f1){var _0x3e9379=a0_0x3c15;_0x2335f1===void 0x0&&(_0x2335f1={});this[_0x3e9379(0x19e)]=0x5*0x400*0x400,this[_0x3e9379(0x1a8)]=_0xcba61c;if(!_0x3a999b[_0x3e9379(0x165)])throw new GraphClientError_1['GraphClientError'](_0x3e9379(0x19c));else this[_0x3e9379(0x198)]=_0x3a999b;this['file']=_0x3a999b,!_0x2335f1['rangeSize']&&(_0x2335f1[_0x3e9379(0x184)]=this[_0x3e9379(0x19e)]),this[_0x3e9379(0x19b)]=_0x2335f1,this['uploadSession']=_0x9037f2,this[_0x3e9379(0x162)]=new Range_1[(_0x3e9379(0x19d))](0x0,this['options']['rangeSize']-0x1);}return _0x53d04f[_0x24bbbd(0x18e)]=function(_0x35bc1c,_0x276313,_0x1a74f3,_0x50d19a){var _0x2fb56e=_0x24bbbd;return _0x50d19a===void 0x0&&(_0x50d19a={}),tslib_1[_0x2fb56e(0x18f)](this,void 0x0,void 0x0,function(){var _0x561733=_0x2fb56e,_0x2ad6a1,_0xc94f0d;return tslib_1[_0x561733(0x15d)](this,function(_0x206830){var _0x10f721=_0x561733;switch(_0x206830[_0x10f721(0x173)]){case 0x0:return[0x4,_0x35bc1c[_0x10f721(0x190)](_0x276313)[_0x10f721(0x16a)](_0x50d19a)[_0x10f721(0x181)](_0x1a74f3)];case 0x1:_0x2ad6a1=_0x206830[_0x10f721(0x185)](),_0xc94f0d={'url':_0x2ad6a1['uploadUrl'],'expiry':new Date(_0x2ad6a1[_0x10f721(0x18d)]),'isCancelled':![]};return[0x2,_0xc94f0d];}});});},_0x53d04f[_0x24bbbd(0x195)][_0x24bbbd(0x188)]=function(_0x4f18ef){var _0x13df7b=_0x24bbbd,_0x1c689a=_0x4f18ef[0x0];if(typeof _0x1c689a===_0x13df7b(0x197)||_0x1c689a==='')return new Range_1[(_0x13df7b(0x19d))]();var _0x2925aa=_0x1c689a[_0x13df7b(0x193)]('-'),_0x539b4a=parseInt(_0x2925aa[0x0],0xa),_0x490b6e=parseInt(_0x2925aa[0x1],0xa);return Number[_0x13df7b(0x199)](_0x490b6e)&&(_0x490b6e=this['file'][_0x13df7b(0x172)]-0x1),new Range_1[(_0x13df7b(0x19d))](_0x539b4a,_0x490b6e);},_0x53d04f['prototype'][_0x24bbbd(0x170)]=function(_0x204050){var _0x174ea2=_0x24bbbd;this[_0x174ea2(0x18a)][_0x174ea2(0x1a5)]=new Date(_0x204050['expirationDateTime']),this[_0x174ea2(0x162)]=this[_0x174ea2(0x188)](_0x204050[_0x174ea2(0x19f)]);},_0x53d04f['prototype']['getNextRange']=function(){var _0x4ade47=_0x24bbbd;if(this['nextRange'][_0x4ade47(0x1a3)]===-0x1)return this[_0x4ade47(0x162)];var _0x438386=this[_0x4ade47(0x162)][_0x4ade47(0x1a3)],_0x39ad86=_0x438386+this[_0x4ade47(0x19b)][_0x4ade47(0x184)]-0x1;return _0x39ad86>=this[_0x4ade47(0x198)][_0x4ade47(0x172)]&&(_0x39ad86=this['file'][_0x4ade47(0x172)]-0x1),new Range_1[(_0x4ade47(0x19d))](_0x438386,_0x39ad86);},_0x53d04f[_0x24bbbd(0x195)][_0x24bbbd(0x165)]=function(_0x29a5b6){var _0x95b958=_0x24bbbd;console[_0x95b958(0x1a2)](_0x95b958(0x191));if(this[_0x95b958(0x198)]['content']instanceof ArrayBuffer||this['file'][_0x95b958(0x182)]instanceof Blob||this['file'][_0x95b958(0x182)]instanceof Uint8Array)return this[_0x95b958(0x198)][_0x95b958(0x182)][_0x95b958(0x17c)](_0x29a5b6[_0x95b958(0x1a3)],_0x29a5b6[_0x95b958(0x168)]+0x1);throw new GraphClientError_1[(_0x95b958(0x16f))](_0x95b958(0x18c));},_0x53d04f[_0x24bbbd(0x195)][_0x24bbbd(0x19a)]=function(){var _0x3e20fc=_0x24bbbd;return tslib_1[_0x3e20fc(0x18f)](this,void 0x0,void 0x0,function(){var _0x2c653b=_0x3e20fc,_0x5489fe,_0x2df7c2,_0x395ca0,_0x59d210,_0x2725db,_0x230198,_0x3ee7a9;return tslib_1[_0x2c653b(0x15d)](this,function(_0x5eb1ff){var _0xf08cfa=_0x2c653b;switch(_0x5eb1ff['label']){case 0x0:_0x5489fe=this['options']&&this[_0xf08cfa(0x19b)][_0xf08cfa(0x178)],_0x5eb1ff['label']=0x1;case 0x1:if(!!this['uploadSession']['isCancelled'])return[0x3,0x5];_0x2df7c2=this[_0xf08cfa(0x15f)]();if(_0x2df7c2[_0xf08cfa(0x168)]===-0x1){_0x395ca0=new Error('Task\x20with\x20which\x20you\x20are\x20trying\x20to\x20upload\x20is\x20already\x20completed,\x20Please\x20check\x20for\x20your\x20uploaded\x20file'),_0x395ca0[_0xf08cfa(0x186)]=_0xf08cfa(0x1a6);throw _0x395ca0;}return[0x4,this[_0xf08cfa(0x198)][_0xf08cfa(0x165)](_0x2df7c2)];case 0x2:_0x59d210=_0x5eb1ff[_0xf08cfa(0x185)]();return[0x4,this[_0xf08cfa(0x166)](_0x59d210,_0x2df7c2,this[_0xf08cfa(0x198)][_0xf08cfa(0x172)])];case 0x3:_0x2725db=_0x5eb1ff[_0xf08cfa(0x185)]();if(!_0x2725db)throw new GraphClientError_1[(_0xf08cfa(0x16f))](_0xf08cfa(0x1a4));return[0x4,GraphResponseHandler_1[_0xf08cfa(0x176)][_0xf08cfa(0x187)](_0x2725db)];case 0x4:_0x230198=_0x5eb1ff[_0xf08cfa(0x185)]();if(_0x2725db[_0xf08cfa(0x179)]===0xc9||_0x2725db[_0xf08cfa(0x179)]===0xc8&&_0x230198['id'])return this[_0xf08cfa(0x1ac)](_0x5489fe,_0x2df7c2),[0x2,UploadResult_1['UploadResult'][_0xf08cfa(0x16e)](_0x230198,_0x2725db[_0xf08cfa(0x16a)])];_0x3ee7a9={'expirationDateTime':_0x230198['expirationDateTime']||_0x230198[_0xf08cfa(0x16b)],'nextExpectedRanges':_0x230198[_0xf08cfa(0x171)]||_0x230198[_0xf08cfa(0x19f)]},this['updateTaskStatus'](_0x3ee7a9),this[_0xf08cfa(0x1ac)](_0x5489fe,_0x2df7c2);return[0x3,0x1];case 0x5:return[0x2];}});});},_0x53d04f[_0x24bbbd(0x195)]['reportProgress']=function(_0x265e2e,_0x1f6cf2){var _0x4f9460=_0x24bbbd;_0x265e2e&&_0x265e2e[_0x4f9460(0x1a0)]&&_0x265e2e['progress'](_0x1f6cf2,_0x265e2e[_0x4f9460(0x177)]);},_0x53d04f[_0x24bbbd(0x195)]['uploadSlice']=function(_0x23f48b,_0x463a0e,_0x322baa){var _0x48045f=_0x24bbbd;return tslib_1[_0x48045f(0x18f)](this,void 0x0,void 0x0,function(){return tslib_1['__generator'](this,function(_0x59dde2){var _0x51a656=a0_0x3c15;switch(_0x59dde2[_0x51a656(0x173)]){case 0x0:return[0x4,this[_0x51a656(0x1a8)][_0x51a656(0x190)](this[_0x51a656(0x18a)]['url'])[_0x51a656(0x16a)]({'Content-Length':''['concat'](_0x463a0e['maxValue']-_0x463a0e['minValue']+0x1),'Content-Range':_0x51a656(0x174)['concat'](_0x463a0e[_0x51a656(0x1a3)],'-')['concat'](_0x463a0e[_0x51a656(0x168)],'/')[_0x51a656(0x1a9)](_0x322baa),'Content-Type':_0x51a656(0x17f)})[_0x51a656(0x17b)](_0x23f48b)];case 0x1:return[0x2,_0x59dde2[_0x51a656(0x185)]()];}});});},_0x53d04f['prototype']['uploadSliceGetRawResponse']=function(_0x4f015d,_0x2ad5d4,_0x5b9913){return tslib_1['__awaiter'](this,void 0x0,void 0x0,function(){return tslib_1['__generator'](this,function(_0xd1d022){var _0xa56bfe=a0_0x3c15;switch(_0xd1d022['label']){case 0x0:return[0x4,this[_0xa56bfe(0x1a8)][_0xa56bfe(0x190)](this['uploadSession']['url'])[_0xa56bfe(0x16a)]({'Content-Length':''['concat'](_0x2ad5d4['maxValue']-_0x2ad5d4[_0xa56bfe(0x1a3)]+0x1),'Content-Range':_0xa56bfe(0x174)[_0xa56bfe(0x1a9)](_0x2ad5d4['minValue'],'-')[_0xa56bfe(0x1a9)](_0x2ad5d4['maxValue'],'/')[_0xa56bfe(0x1a9)](_0x5b9913),'Content-Type':_0xa56bfe(0x17f)})[_0xa56bfe(0x189)](ResponseType_1[_0xa56bfe(0x180)]['RAW'])[_0xa56bfe(0x17b)](_0x4f015d)];case 0x1:return[0x2,_0xd1d022[_0xa56bfe(0x185)]()];}});});},_0x53d04f[_0x24bbbd(0x195)][_0x24bbbd(0x192)]=function(){return tslib_1['__awaiter'](this,void 0x0,void 0x0,function(){var _0x43fbb8=a0_0x3c15,_0x57838e;return tslib_1[_0x43fbb8(0x15d)](this,function(_0x3e258d){var _0xbe219=_0x43fbb8;switch(_0x3e258d[_0xbe219(0x173)]){case 0x0:return[0x4,this[_0xbe219(0x1a8)]['api'](this[_0xbe219(0x18a)][_0xbe219(0x194)])['responseType'](ResponseType_1[_0xbe219(0x180)][_0xbe219(0x161)])[_0xbe219(0x17e)]()];case 0x1:_0x57838e=_0x3e258d[_0xbe219(0x185)]();_0x57838e['status']===0xcc&&(this[_0xbe219(0x18a)]['isCancelled']=!![]);return[0x2,_0x57838e];}});});},_0x53d04f[_0x24bbbd(0x195)][_0x24bbbd(0x167)]=function(){return tslib_1['__awaiter'](this,void 0x0,void 0x0,function(){var _0x4b10c0=a0_0x3c15,_0x4c759d;return tslib_1[_0x4b10c0(0x15d)](this,function(_0x5b83a0){var _0x73813f=_0x4b10c0;switch(_0x5b83a0[_0x73813f(0x173)]){case 0x0:return[0x4,this[_0x73813f(0x1a8)][_0x73813f(0x190)](this['uploadSession']['url'])['get']()];case 0x1:_0x4c759d=_0x5b83a0[_0x73813f(0x185)](),this[_0x73813f(0x170)](_0x4c759d);return[0x2,_0x4c759d];}});});},_0x53d04f[_0x24bbbd(0x195)]['resume']=function(){return tslib_1['__awaiter'](this,void 0x0,void 0x0,function(){var _0x2e4f63=a0_0x3c15;return tslib_1[_0x2e4f63(0x15d)](this,function(_0x1e53bc){var _0x135afd=_0x2e4f63;switch(_0x1e53bc[_0x135afd(0x173)]){case 0x0:return[0x4,this[_0x135afd(0x167)]()];case 0x1:_0x1e53bc[_0x135afd(0x185)]();return[0x4,this[_0x135afd(0x19a)]()];case 0x2:return[0x2,_0x1e53bc[_0x135afd(0x185)]()];}});});},_0x53d04f[_0x24bbbd(0x195)][_0x24bbbd(0x163)]=function(){return this['uploadSession'];},_0x53d04f;}());function a0_0x3bdc(){var _0x290038=['progress','786528WDDYlK','warn','minValue','Something\x20went\x20wrong!\x20Large\x20file\x20upload\x20slice\x20response\x20is\x20null.','expiry','Invalid\x20Session','5QPhBCT','client','concat','1623018yxQkUE','./FileUploadTask/UploadResult','reportProgress','__generator','149932qWVNly','getNextRange','2338928FxvhoN','RAW','nextRange','getUploadSession','122887hWcnJT','sliceFile','uploadSliceGetRawResponse','getStatus','maxValue','LargeFileUploadTask','headers','ExpirationDateTime','../GraphResponseHandler','200627mZMCoM','CreateUploadResult','GraphClientError','updateTaskStatus','NextExpectedRanges','size','label','bytes\x20','../ResponseType','GraphResponseHandler','extraCallbackParam','uploadEventHandlers','status','../GraphClientError','put','slice','__esModule','delete','application/octet-stream','ResponseType','post','content','209774lkVvds','rangeSize','sent','name','getResponse','parseRange','responseType','uploadSession','tslib','The\x20LargeFileUploadTask.sliceFile()\x20function\x20expects\x20only\x20Blob,\x20ArrayBuffer\x20or\x20Uint8Array\x20file\x20content.\x20Please\x20note\x20that\x20the\x20sliceFile()\x20function\x20is\x20deprecated.','expirationDateTime','createUploadSession','__awaiter','api','The\x20LargeFileUploadTask.sliceFile()\x20function\x20has\x20been\x20deprecated\x20and\x20moved\x20into\x20the\x20FileObject\x20interface.','cancel','split','url','prototype','./FileUploadTask/Range','undefined','file','isNaN','upload','options','Please\x20pass\x20the\x20FileUpload\x20object,\x20StreamUpload\x20object\x20or\x20any\x20custom\x20implementation\x20of\x20the\x20FileObject\x20interface','Range','DEFAULT_FILE_SIZE','nextExpectedRanges'];a0_0x3bdc=function(){return _0x290038;};return a0_0x3bdc();}exports[a0_0x370689(0x169)]=LargeFileUploadTask;