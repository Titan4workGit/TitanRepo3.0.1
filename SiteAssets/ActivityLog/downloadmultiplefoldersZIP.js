function a0_0x29d7(){const _0x3d6acd=['value','blob','Files','7367272xFunYb','push','generateAsync','getElementsByName','Folders','#fileList','\x27)?$expand=Folders,Files','/_api/web/GetFolderByServerRelativeUrl(\x27','Name','download','2457279hQxRTQ','checkbox','5362389HRFMUu','createObjectURL','json','6289520LhgdoH','folders.zip','createElement','ServerRelativeUrl','removeChild','log','FormDigestValue','4096224CiZGtp','results','</td></tr>','FileRef','</table>','167355FsgYwD','<tr><td>','files','substring','40qgstGc','href','folder','6TlabBn','name','10eUlmgI','click','</td><td>','appendChild','ajax','body','<table>','GET','lastIndexOf','checked','forEach','application/json;odata=verbose','file','3208499YwvtDt','14JnbGwa','POST','val'];a0_0x29d7=function(){return _0x3d6acd;};return a0_0x29d7();}(function(_0x194730,_0x3ad0ee){const _0x2ba95d=a0_0x27f8,_0x920ba1=_0x194730();while(!![]){try{const _0x2715d2=-parseInt(_0x2ba95d(0x13f))/0x1*(parseInt(_0x2ba95d(0x156))/0x2)+-parseInt(_0x2ba95d(0x130))/0x3+parseInt(_0x2ba95d(0x13a))/0x4+parseInt(_0x2ba95d(0x133))/0x5+parseInt(_0x2ba95d(0x146))/0x6*(-parseInt(_0x2ba95d(0x155))/0x7)+-parseInt(_0x2ba95d(0x143))/0x8*(-parseInt(_0x2ba95d(0x12e))/0x9)+parseInt(_0x2ba95d(0x148))/0xa*(parseInt(_0x2ba95d(0x124))/0xb);if(_0x2715d2===_0x3ad0ee)break;else _0x920ba1['push'](_0x920ba1['shift']());}catch(_0x3fa857){_0x920ba1['push'](_0x920ba1['shift']());}}}(a0_0x29d7,0xdb9ea));const siteUrl=_spPageContextInfo['webAbsoluteUrl'],selectedFolders=[];function downloadSelectedFilesAsZip(){const _0x5e2be5=a0_0x27f8;var _0x32b5ae=document[_0x5e2be5(0x127)](_0x5e2be5(0x141)),_0xc91292=[];_0x32b5ae['forEach'](function(_0x27130c){const _0x669a12=_0x5e2be5;_0x27130c[_0x669a12(0x151)]&&(_0xc91292[_0x669a12(0x125)](_0x27130c['value']),selectedFolders[_0x669a12(0x125)](_0x27130c['value']));}),downloadFolders();}async function getFolderContents(_0x24e468,_0x2cffc0,_0x38a4fb){const _0x3f834c=a0_0x27f8;try{const _0x3f5cd7=await fetch(_0x24e468+_0x3f834c(0x12b)+_0x38a4fb+_0x3f834c(0x12a)),_0x5422a5=await _0x3f5cd7[_0x3f834c(0x132)](),_0x687dc0=_0x5422a5['Files'],_0x4da00c=_0x5422a5[_0x3f834c(0x128)];for(const _0x1aa418 of _0x687dc0){const _0x3b70a8=_0x24e468+'/'+_0x1aa418[_0x3f834c(0x136)],_0x1885db=await fetch(_0x3b70a8),_0x4144db=await _0x1885db[_0x3f834c(0x122)](),_0x41a2a5=_0x38a4fb+'/'+_0x1aa418[_0x3f834c(0x12c)];_0x2cffc0['file'](_0x41a2a5,_0x4144db);}for(const _0x43b3ca of _0x4da00c){const _0x3fffdd=_0x43b3ca[_0x3f834c(0x12c)],_0x575253=_0x575253+'/'+_0x3fffdd,_0xb4a9d9=_0x24e468+_0x3f834c(0x12b)+_0x575253+'\x27)';await getFolderContents(_0x24e468,_0x2cffc0,_0x575253);}return _0x2cffc0;}catch(_0x3fd0c9){console['log'](_0x3fd0c9);}}async function downloadFolders(){const _0x51f58f=a0_0x27f8;try{const _0x303209=new JSZip(),_0x88b689=siteUrl+'/_api/contextinfo',_0x1b9827=await fetch(_0x88b689,{'method':_0x51f58f(0x157),'headers':{'Accept':_0x51f58f(0x153),'Content-Type':_0x51f58f(0x153),'odata-version':'','X-RequestDigest':$('#__REQUESTDIGEST')[_0x51f58f(0x120)]()}}),_0x22751f=await _0x1b9827[_0x51f58f(0x132)](),_0x26e2b3=_0x22751f['d']['GetContextWebInformation'][_0x51f58f(0x139)];for(const _0x57e4d5 of selectedFolders){const _0x5360d4=siteUrl,_0xe7b47=_0x57e4d5;await getFolderContents(_0x5360d4,_0x303209,_0xe7b47);}const _0x2783e3=await _0x303209[_0x51f58f(0x126)]({'type':_0x51f58f(0x122)}),_0x38c320=URL['createObjectURL'](_0x2783e3),_0x4cd901=document[_0x51f58f(0x135)]('a');_0x4cd901[_0x51f58f(0x144)]=_0x38c320,_0x4cd901[_0x51f58f(0x12d)]=_0x51f58f(0x134),document[_0x51f58f(0x14d)][_0x51f58f(0x14b)](_0x4cd901),_0x4cd901[_0x51f58f(0x149)](),document[_0x51f58f(0x14d)][_0x51f58f(0x137)](_0x4cd901);}catch(_0x29d9f3){console[_0x51f58f(0x138)](_0x29d9f3);}}function a0_0x27f8(_0x2b4a81,_0x1a529c){const _0x29d70a=a0_0x29d7();return a0_0x27f8=function(_0x27f844,_0x39d7c8){_0x27f844=_0x27f844-0x120;let _0x51e218=_0x29d70a[_0x27f844];return _0x51e218;},a0_0x27f8(_0x2b4a81,_0x1a529c);}const zip=new JSZip();async function addFolderToZip(_0x48cf80,_0x1da2dc){const _0xe7acba=a0_0x27f8,_0x12f0aa=await retrieveFolderInfo(_0x48cf80),_0x11f146=_0x12f0aa[_0xe7acba(0x12c)],_0x1f13d6=_0x1da2dc[_0xe7acba(0x145)](_0x11f146);for(const _0x45e7a4 of _0x12f0aa[_0xe7acba(0x123)]){const _0x3e5e2c=_0x45e7a4[_0xe7acba(0x12c)],_0x3fba3e=await retrieveFileContents(_0x45e7a4['ServerRelativeUrl']);_0x1f13d6[_0xe7acba(0x154)](_0x3e5e2c,_0x3fba3e);}for(const _0x3f519f of _0x12f0aa[_0xe7acba(0x128)]){const _0x5bde17=_0x48cf80+'/'+_0x3f519f[_0xe7acba(0x12c)];await addFolderToZip(_0x5bde17,_0x1f13d6);}}async function downloadSelectedFolders(){const _0x12f1d9=a0_0x27f8,_0x5d5b26=[],_0x221436=document[_0x12f1d9(0x127)](_0x12f1d9(0x141));for(const _0x242f5e of _0x221436){_0x242f5e[_0x12f1d9(0x151)]&&_0x5d5b26[_0x12f1d9(0x125)](_0x242f5e[_0x12f1d9(0x121)]);}for(const _0x13442b of _0x5d5b26){await addFolderToZip(_0x13442b,zip);}const _0x38c388=await zip[_0x12f1d9(0x126)]({'type':_0x12f1d9(0x122)}),_0x12e8c8=document['createElement']('a');_0x12e8c8[_0x12f1d9(0x144)]=URL[_0x12f1d9(0x131)](_0x38c388),_0x12e8c8[_0x12f1d9(0x12d)]='folders.zip',document[_0x12f1d9(0x14d)]['appendChild'](_0x12e8c8),_0x12e8c8['click']();}function getFilesFromLibrary(_0x10fd44){const _0x48c286=a0_0x27f8;var _0x4bd346=_0x10fd44+'/_api/web/lists/getByTitle(\x27DemoLibrary\x27)/items?$select=FileRef&$orderby=FileLeafRef&$filter=FSObjType\x20eq\x201';$[_0x48c286(0x14c)]({'url':_0x4bd346,'type':_0x48c286(0x14f),'headers':{'Accept':_0x48c286(0x153)},'success':function(_0x1ce63a){const _0x5bc37d=_0x48c286;var _0xb69967=_0x1ce63a['d'][_0x5bc37d(0x13b)],_0x155381=[];_0xb69967[_0x5bc37d(0x152)](function(_0x1b3656){const _0x3ccc6b=_0x5bc37d;var _0x48fe06=_0x1b3656[_0x3ccc6b(0x13d)][_0x3ccc6b(0x142)](_0x1b3656[_0x3ccc6b(0x13d)][_0x3ccc6b(0x150)]('/')+0x1),_0x1b5b3c={'name':_0x48fe06,'url':_0x1b3656[_0x3ccc6b(0x13d)],'checkbox':'<input\x20type=\x27checkbox\x27\x20name=\x27files\x27\x20value=\x27'+_0x1b3656['FileRef']+'\x27>'};_0x155381['push'](_0x1b5b3c);});var _0x5c3c87=_0x5bc37d(0x14e);_0x5c3c87+='<tr><th>Select</th><th>Name</th></tr>',_0x155381[_0x5bc37d(0x152)](function(_0x24a090){const _0x5a5c94=_0x5bc37d;_0x5c3c87+=_0x5a5c94(0x140)+_0x24a090[_0x5a5c94(0x12f)]+_0x5a5c94(0x14a)+_0x24a090[_0x5a5c94(0x147)]+_0x5a5c94(0x13c);}),_0x5c3c87+=_0x5bc37d(0x13e),$(_0x5bc37d(0x129))['html'](_0x5c3c87);},'error':function(_0x1092cf){console['log'](_0x1092cf);}});}getFilesFromLibrary(siteUrl);